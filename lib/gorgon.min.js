require("source-map-support").install(),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("moment"),require("lodash"),require("net"),require("http"),require("socket.io"),require("compression"),require("express"),require("fs"),require("os"),require("sanitize-filename"),require("colog")):"function"==typeof define&&define.amd?define("gorgon",["moment","lodash","net","http","socket.io","compression","express","fs","os","sanitize-filename","colog"],t):"object"==typeof exports?exports.gorgon=t(require("moment"),require("lodash"),require("net"),require("http"),require("socket.io"),require("compression"),require("express"),require("fs"),require("os"),require("sanitize-filename"),require("colog")):e.gorgon=t(e.moment,e.lodash,e.net,e.http,e["socket.io"],e.compression,e.express,e.fs,e.os,e["sanitize-filename"],e.colog)}(this,function(e,t,n,o,r,i,s,a,l,c,u){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(1),a=n(2),l=n(5),c=n(16),u=n(8),d=o(u),p=n(20),f=o(p);global.Logger=new c.Logger,global.Console=f["default"],global.Console.status=function(e,t){switch(e){default:case"info":global.Console.log("["+global.Console.color("I","yellow")+"] "+t);break;case"notice":global.Console.log("["+global.Console.color("N","cyan")+"] "+t);break;case"error":global.Console.log("["+global.Console.color("E","red")+"] "+t)}};var h=function(){function e(){r(this,e),this.GorgonConfig=new s.GorgonConfig,this.Logger=global.Logger,this.Logger.log("Gorgon:initServer",200,"The Gorgon has been summoned - GORGON SERVER STARTING..."),this.GorgonEnv=new a.GorgonEnv,this.GorgonContainerService=new l.GorgonContainerService,this.separator1="================================================",this.separator2="------------------------------------------------"}return i(e,[{key:"initServer",value:function(){this._bootstrap(),global.Console.log(this.separator2),global.Console.question("Loading Services"),global.Console.log(this.separator2),this.Logger.log("Gorgon:initServer",200,"The server was started successfully"),this.GorgonEnv.service.forEach(function(e){var t=48,n=this.GorgonContainerService.add(e.service);if(n){var o=6,r=t-o-e.namespace.length-2,i=d["default"].repeat(".",r);this.Logger.log("Gorgon:initServer",200,"Loaded service namespace: "+e.namespace),global.Console.log(e.namespace+" "+i+" [ "+global.Console.color("OK","green")+" ]")}else{var s=10,a=t-s-e.namespace.length-2,l=d["default"].repeat(".",a);this.Logger.log("Gorgon:initServer",400,"Failed to load service with namespace: "+e.namespace),global.Console.log(e.namespace+" "+l+" [ "+global.Console.color("FAILED","red")+" ]")}},this),this.Logger.log("Gorgon:initServer",200,"Service Loading Completed"),global.Console.log(this.separator2),global.Console.question("Loading Complete - Server Online"),global.Console.log(this.separator1)}},{key:"_bootstrap",value:function(){global.Console.log(global.Console.color("Gorgon Server - v"+this.GorgonConfig.data.version,"green")),global.Console.log("Author: Ryan Rentfro <rrentfro at gmail dot com>"),global.Console.log("Project: https://github.com/manufacturing-industry/gorgon"),this._motd(),global.Console.log("Press "+global.Console.color("cntrl+c","yellow")+" to exit the server")}},{key:"_motd",value:function(){global.Console.log(this.separator1),global.Console.log(global.Console.color(this.GorgonConfig.data.motd,"yellow")),global.Console.log(this.separator1)}}]),e}(),v=new h;v.initServer()},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});/**
	 * Gorgon the scripting capable network server for Node JS
	 *
	 * @package Gorgon
	 * @author Ryan Rentfro
	 * @license MIT
	 * @url https://github.com/manufacturing-industry
	 */
t.GorgonConfig=function r(){o(this,r),this.data={name:"gorgon",version:"0.0.2 Build: 55 - Pre-Alpha",motd:"This is the message of the day."},this.storage={logs:"logs/"},this.load={server:!0,cli:!0,services:!0},this.debug={enable:!0}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.GorgonEnv=void 0;var i=n(3),s=o(i);t.GorgonEnv=function a(){r(this,a),this.service=new s["default"],this.service=[{sid:0,name:"Status",namespace:"StatusService",enable:!0,service:this.service}]}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(4),l=n(5),c=n(1),u=n(7),d=new u.Network,p=function(e){function t(){o(this,t);var e=r(this,Object.getPrototypeOf(t).call(this));return e.config=c.StatusServiceConfig,e.name="Status Service",e.namespace="StatusService",e.description="Provides service status",e.type="Service",e.https=!0,e.inboundTypes=["rest","socket","http","webSocket","api"],e.ports=[2600,null,2680,2688,null],e.router=new a.Routes(e.namepsace),e.permissions=["internal"],e.serviceBind(),e}return i(t,e),s(t,[{key:"routes",value:function(){return{ServiceRequest:{inboundTypes:this.inboundTypes,method:"/StatusServiceRequest",callback:this.serviceRequest()}}}},{key:"serviceRequest",value:function(e,t,n){}},{key:"apiRequest",value:function(e){}},{key:"setWebSocketEvents",value:function(e){}},{key:"serviceBind",value:function(){return this.router.importRoutes(this.routes()),this._setNetworking(),d.addService(this),!0}},{key:"serviceUnbind",value:function(){d.removeService(this.namespace)}}]),t}(l.GorgonService);t["default"]=p,e.exports=t["default"]},function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.Routes=function(){function e(t){o(this,e),this.service=t,this.inboundTypes=["rest","socket","http","https","webSocket","api"],this.routes=[],this.routeCallbacks=[],this.permissionMap=[]}return r(e,[{key:"add",value:function(e,t,n){this.routes.push(t),this.routeCallbacks(n);var o=this.routeCallbacks.length-1;e.forEach(function(e){this.inboundTypes.indexOf(e)>-1?this.permissionMap[e].push(o):console.log("ERROR - Invalid Permission Encountered in Service: ["+this.service+"] Method: ["+t+"]")})}},{key:"remove",value:function(e){var t=this.routes.indexOf(e);return t>-1&&(this.routeCallbacks[t]=null,this.routes[t]=null,this.inboundTypes.forEach(function(e){if(void 0!=this.permissionMap[e]&&this.permissionMap[e]instanceof Array){var n=this.permissionMap[e].indexOf(t);n>-1&&this.permissionMap[e].splice(n,1)}}),!0)}},{key:"importRoutes",value:function(e){if(e instanceof Array)for(var t in e)e.hasOwnProperty(t)&&this.add(e[t].inboundTypes,e[t].method,e[t].callback);return!1}},{key:"route",value:function(e,t,o){var r=this.routes.indexOf(t);if(r>-1&&void 0!=this.permissionMap[e]&&this.permissionMap[e].length>0&&this.permissionMap[e].indexOf(r)>-1){var i;return(i=this.routeCallbacks)[r].apply(i,[t,e].concat(n(o)))}return!1}}]),e}()},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.GorgonService=t.GorgonContainerService=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(6),a=o(s);t.GorgonContainerService=function(){function e(){r(this,e),this.containers=[],this.containerMap=[],this.name="Gorgon Container Service",this.type="Service"}return i(e,[{key:"add",value:function(e){return null!=e.namespace&&""!=e.namespace&&this.containerMap.indexOf(e.namespace)==-1&&(this.containers.push(e),this.containerMap.push(e.namespace),!0)}},{key:"remove",value:function(e){if(this.containerMap.indexOf(e)>-1){var t=this.containerMap.indexOf(e);return this.containers.splice(t,1),this.containerMap.splice(t,1),!0}return!1}},{key:"get",value:function(e){return this.containerMap.indexOf(e)>-1&&this.containers[this.containerMap.indexOf(e)]}}]),e}(),t.GorgonService=function(){function e(){r(this,e),this.serviceId=null,this.name=null,this.description=null,this.type="Service",this.router=null,this.inboundTypes=[],this.ports=[],this.permissions=[],this.networking=[]}return i(e,[{key:"_setNetworking",value:function(){if(this.inboundTypes instanceof Array&&this.ports instanceof Array&&this.inboundTypes.length==this.ports.length)for(var e=0;e<this.inboundTypes.length;e++)this.networking.push({name:this.inboundTypes[e],port:this.ports[e]});else console.warn("GorgonService:_setNetworking - Missing or invalid networking for service "+this.name)}},{key:"setServiceId",value:function(e){return this.serviceId=e,!0}},{key:"serviceRequest",value:function(e,t,n){return null}},{key:"apiRequest",value:function(e){return e.error=!0,e.errors,push("API call handler not defined"),e.returned=(0,a["default"])(),e}},{key:"setWebSocketEvents",value:function(e){return null}}]),e}()},function(e,t){e.exports=require("moment")},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Network=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(8),a=o(s),l=n(9),c=o(l),u=n(10),d=n(11),p=o(d),f=n(12),h=o(f),v=n(13),g=o(v),m=n(14),b=o(m),y=n(15),w=o(y),k=null,C=t.Network=function(){function e(){return r(this,e),k?k:(this.middleware=new c["default"],this.services=[],this.serviceMap=[],this.components=[],this.componentMap=[],this.componentTypeMap={rest:[],socket:[],webSocket:[],http:[],api:[]},this.api=new u.Api,this.portReservations=[],this.portReservationNamespace=[],this.activeServices=[],k=this,void 0)}return i(e,[{key:"addService",value:function(e){if(this.activeServices.indexOf(e.namespace)==-1){this.services.push(e),this.serviceMap.push(e.namespace);var t=this.serviceMap.length-1;if(e.setServiceId(e),e.networking instanceof Array){for(var n=0;n<e.networking.length;n++)this.add(t,e.namespace,e.networking[n].name,"label",e.networking[n].port);return global.Logger.log("Network:addService",200,"Added services components: "+e.name+" for Service: "+e.namespace+" - ServiceId: "+t),!0}}return!1}},{key:"removeService",value:function(e){}},{key:"add",value:function(e,t,n,o,r,i){var s=!1;if(this.portReservations.indexOf(r)==-1||null==r||void 0==r){switch(void 0!=r&&null!=r||(r=0),n){default:return global.Logger.log("Network:add",400,"Unable to load component type of: "+n+" for Service: "+t+" - ServiceId: "+e),!1;case"rest":s=this._createRestComponent(e,t,r,i);break;case"http":s=this._createHttpComponent(e,t,r,i);break;case"socket":s=this._createSocketComponent(e,t,r);break;case"webSocket":s=this._createWebSocketComponent(e,t,r,i);break;case"api":s=this._createApiComponent(e,t)}return s!==!1&&(this.components.push(s),this.componentMap.push(t+"-"+n+"-"+o+"-"+r),this.componentTypeMap[n].push(t+"-"+n+"-"+r),global.Logger.log("Network:add",200,"Added network component: "+n+" for Service: "+t+" - ServiceId: "+e),!0)}return!1}},{key:"_createRestComponent",value:function(e,t,n,o){return this._createHttpComponent(e,t,n,o,!0)}},{key:"_createHttpComponent",value:function(e,t,n,o,r){var i=!0;void 0==r&&(r=!1);var s=(0,w["default"])();s.use((0,b["default"])({}));var l=s.all("/",function(t,n){this.middleware.callChannel("PRE_REQUEST",t),this.middleware.callChannel("PRE_RESPONSE",n),this.services[e].serviceRequest(t,n,r===!1?"http":"rest")});if(this.isPortReserved(n)){i=!1;var c=this.portReservations.indexOf(n),u=this.portReservationNamespace[c];if(u!=t)return global.Logger.log("Network:_createHttpComponent",400,"Unable to create new http component - Port Reserved by another service. Attempted to mount: "+t+" / ServiceId: "+e+" - Existing service assigned to port: "+u,{type:r===!1?"http":"rest"}),!1}if(a["default"].isFunction(o)&&l.use(o),i)var d=l.listen(n,function(){S.addPortReservation(t,d.address().port),global.Console.status("info","Http Bound Type: "+(r===!1?"http":"rest")+" - Service: "+t+" - "+(0==n?"Random ":"")+"Port: "+d.address().port),global.Logger.log("Network:_createHttpComponent",200,"Created new http component - Mounted: "+t+" / ServiceId: "+e+" - listening on "+(0==n?"Random ":"")+"Port: "+d.address().port,{type:r===!1?"http":"rest"})});return l}},{key:"_createWebSocketComponent",value:function(e,t,n,o){var r=this,i=!0;if(this.isPortReserved(n)){i=!1;var s=this.portReservations.indexOf(n),a=this.portReservationNamespace[s];if(a!=t)return global.Logger.log("Network:_createRestComponent",400,"Unable to create component - Port Reserved by another service. Attempted to mount: "+t+" / ServiceId: "+e+" - Existing service assigned to port: "+a),!1}var l=(0,w["default"])();l.use((0,b["default"])({}));var c=h["default"].Server(l),u=new g["default"](c),d=[],p={};u.use((0,b["default"])({})),u.on("connection",function(t){var n=t.handshake.query.userId,o={id:t.id,userId:n};findIndex(d,o.id)>-1?(console.log("[INFO] User ID is already connected, kicking."),t.disconnect()):(console.log("[INFO] User ID: "+o.userId+" connected!"),p[o.id]=t,d.push(o),u.emit("User Join",{userId:o.userId}),console.log("[INFO] Total users: "+d.length)),t.on("ding",function(){t.emit("dong")}),t.on("disconnect",function(){findIndex(d,o.id)>-1&&d.splice(findIndex(d,o.id),1),console.log("[INFO] User "+o.userId+" disconnected!"),t.broadcast.emit("userDisconnect",{userId:o.userId})}),r.services[e].setWebSocketEvents(t)});var f=c.listen(n,function(){S.addPortReservation(t,f.address().port),global.Console.status("info","Web Socket Bound - Service: "+t+" - "+(0==n?"Random ":"")+"Port: "+f.address().port),global.Logger.log("Network:_createWebSocketComponent",200,"Created new web socket component - Mounted: "+t+" / ServiceId: "+e+" - listening on "+(0==n?"Random ":"")+"Port: "+f.address().port)});return u}},{key:"_createSocketComponent",value:function(e,t,n){var o=!0;if(this.isPortReserved(n)){o=!1;var r=this.portReservations.indexOf(n),i=this.portReservationNamespace[r];if(i!=t)return global.Logger.log("Network:_createSocketComponent",400,"Unable to create new socket component - Port Reserved by another service. Attempted to mount: "+t+" / ServiceId: "+e+" - Existing service assigned to port: "+i,{type:isRest===!1?"http":"rest"}),!1}var s=p["default"].createServer(function(e){console.log("client connected"),e.on("end",function(){console.log("client disconnected")}),e.write("hello\r\n"),e.pipe(e)});if(s.on("error",function(t){console.log("A socket error has occurred"),global.Logger.log("Network:_createSocketComponent",400,"A socket error has occurred in Service: "+namepsace+" - Service Id: "+e)}),o)var a=s.listen(n,function(){S.addPortReservation(t,a.address().port),global.Console.status("info","TCP/IP Socket Bound - Service: "+t+" - "+(0==n?"Random ":"")+"Port: "+a.address().port),global.Logger.log("Network:_createSocketComponent",200,"Created new TCP/IP socket component - Mounted: "+t+" / ServiceId: "+e+" - listening on "+(0==n?"Random ":"")+"Port: "+a.address().port)});return s}},{key:"_createApiComponent",value:function(e,t){return this.api.addApiNode(e,t,this.services[e].apiRequest)}},{key:"remove",value:function(e,t,n){}},{key:"isPortReserved",value:function(e){return this.portReservations.indexOf(e)>-1}},{key:"addPortReservation",value:function(e,t){return this.portReservations.push(t),this.portReservationNamespace.push(e),!0}}]),e}(),S=new C;t["default"]=S},function(e,t){e.exports=require("lodash")},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Middleware=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(8),a=o(s),l=t.Middleware=function(){function e(){r(this,e),this.data=[],this.serviceRegister=[],this.dataMap=[],this.channels=["PRE_REQUEST","PRE_RESPONSE","PRE_API_CALL","POST_API_CALL"],this.channels.forEach(function(e){this.data.push([]),this.dataMap.push(e)},this)}return i(e,[{key:"addMiddleware",value:function(e,t,n,o){var r=this._getChannelId(e);if(r>-1){var i=this._getExistingMiddleware(e[r],t,i,o);if(i===!1)return this.channels[r].push({service:t,middleware:i,method:o}),global.Logger.log("Middleware:addMiddleware",200,"A new middleware was added for Service Namespace: "+t+" on Channel: "+e),!0;global.Logger.log("Middleware:addMiddleware",300,"Attempted to add duplicate middleware for Service Namespace: "+t+" on Channel: "+e+" for middleware: "+i+" with method: "+o)}global.Logger.log("Middleware:addMiddleware",400,"Attempted to add a middleware for non-existent channel: "+e+" - for Service Namespace: "+t)}},{key:"removeMiddleware",value:function(e,t,n){this._getChannelId(e)}},{key:"callChannel",value:function(e,t){var n=this._getChannelId(e);if(n>-1){var o=this.channels[n];o instanceof Array&&o.foreach(function(e){t=e.method(t)})}else global.Logger.log("Middleware:callChannel",400,"Attempted to call a non-existent channel: "+e+" - for Service Namespace: "+serviceNamespace);return t}},{key:"_getExistingMiddleware",value:function(e,t,n){var o=a["default"].find(e,{serviceNamespace:t,middleware:n});return void 0==o&&o}},{key:"_getChannelId",value:function(e){return this.channels.indexOf(e.toUpper)}}]),e}();t["default"]=l},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Api=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(8),a=(o(s),n(6)),l=o(a),c=n(9),u=o(c),d=null,p=(t.Api=function(){function e(){return r(this,e),d?d:(this.middleware=new u["default"],this.api=[],this.apiMap=[],this.serviceIdMap=[],this.reserved=["instance","middleware","api","apiMap","serviceIdMap","reserved","addApiNode","getApiNode","_getNodePos","callApiNode","ApiCall"],d=this,void 0)}return i(e,[{key:"addApiNode",value:function(e,t,n){if(this._getNodePos(t)===!1&&this._isReservedNamespace(t)===!1){this.api.push(n),this.apiMap.push(t),this.serviceIdMap.push(e);var o=this.api.length-1;return this[t]=this.api[o],global.Logger.log("Api:addApiNode",200,"Added a new API node for Service Namespace: "+t),!0}return this._getNodePos(t)!==!1?global.Logger.log("Api:addApiNode",400,"Unable to create new api node. A node by for this service namespace already exists - Service Namespace: "+t):global.Logger.log("Api:addApiNode",400,"Unable to create new api node. This namespace is reserved - Service Namespace: "+t),!1}},{key:"getApiNode",value:function(e){var t=this._getNodePos(e);return t>-1&&this.api[t]}},{key:"callApiNode",value:function(e,t,n){if(node=this.getApiNode(e),node!==!1){var o=new p(t,n);return this.middleware.callChannel("PRE_API_CALL",o),n=o.callApi(node,mehod),this.middleware.callChannel("POST_API_CALL",n),n.returned=(0,l["default"])(),n}return this.Logger.log("Api:callApiNode",400,"Failed to call node service with namespace: "+e+" - no api node exists for this namespace."),!1}},{key:"_getNodePos",value:function(e){var t=this.apiMap.indexOf(e);return t!=-1&&this.apiMap[t]}},{key:"_isReservedNamespace",value:function(e){return this.reserved.indexOf(e)>-1}}]),e}(),function(){function e(t,n){r(this,e),this.method=t,this.error=!1,this.errors=[],this.data=n,this.created=(0,l["default"])(),this.updated=null,this.returned=null}return i(e,[{key:"callApi",value:function(e){return e(this),this.updated=(0,l["default"])(),this}}]),e}())},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("socket.io")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("express")},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(17),l=r(a),c=n(6),u=o(c),d=n(18),p=r(d),f=n(1),h=n(19),v=o(h),g=(t.Logger=function(){function e(){i(this,e),this.fs=l,this.GorgonConfig=new f.GorgonConfig,this.sanitize=v["default"],this.topicMap=[],this.subscribers=[],this.subscriberMap=[],this.level=["Debug","Info","Warn","Error","Critical","Fatal"],this.levelKey=[100,200,300,400,500,600]}return s(e,[{key:"log",value:function(e,t,n,o,r){var i=new g(e,t,n,o,r),s=null==i.values||void 0==i.values?null:JSON.stringify(i.values),a=i.created.format("YYYYMMDD")+".log";switch(i.type){default:a=this.sanitize(i.type)+"-"+a;break;case void 0:case!0:case"sys":a="sys-"+a;break;case"error":a="error-"+a}var c=i.created.format()+" "+i.level+" "+i.location+" [message="+i.message+"] [values="+s+"]"+p.EOL;return this.fs.existsSync(this.GorgonConfig.storage.logs)||l.mkdirSync(this.GorgonConfig.storage.logs),this.fs.appendFile(this.GorgonConfig.storage.logs+a,c,"utf8",function(e){if(e)return console.error(e),!1}),!0}}]),e}(),function m(e,t,n,o,r){i(this,m),this.location=e,this.level=null==t||void 0==t?100:t,this.message=n,this.type=null==r||void 0==r?"sys":r,this.values=null==o||void 0==o?null:o,this.created=(0,u["default"])()})},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("sanitize-filename")},function(e,t){e.exports=require("colog")}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZ29yZ29uLm1pbi5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA2NGU2NDNjMDBmYjNmZjhhNDEyNSIsIndlYnBhY2s6Ly8vLi9zcmMvZ29yZ29uLmpzIiwid2VicGFjazovLy8uL3NyYy9jb25maWcvY29uZmlnLmpzIiwid2VicGFjazovLy8uL3NyYy9jb25maWcvZW52LmpzIiwid2VicGFjazovLy8uL3NyYy9zZXJ2aWNlL3N0YXR1cy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50L3JvdXRlcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvc2VydmljZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJtb21lbnRcIiIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50L25ldHdvcmsuanMiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwibG9kYXNoXCIiLCJ3ZWJwYWNrOi8vLy4vc3JjL2NvbXBvbmVudC9taWRkbGV3YXJlLmpzIiwid2VicGFjazovLy8uL3NyYy9jb21wb25lbnQvYXBpLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcIm5ldFwiIiwid2VicGFjazovLy9leHRlcm5hbCBcImh0dHBcIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJzb2NrZXQuaW9cIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjb21wcmVzc2lvblwiIiwid2VicGFjazovLy9leHRlcm5hbCBcImV4cHJlc3NcIiIsIndlYnBhY2s6Ly8vLi9zcmMvY29tcG9uZW50L2xvZy5qcyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJmc1wiIiwid2VicGFjazovLy9leHRlcm5hbCBcIm9zXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwic2FuaXRpemUtZmlsZW5hbWVcIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjb2xvZ1wiIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJpbnN0YWxsIiwicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwidGhpcyIsIl9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNl9fIiwiX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV84X18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzExX18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzEyX18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzEzX18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzE0X18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzE1X18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzE3X18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzE4X18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzE5X18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzIwX18iLCJtb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaW5zdGFsbGVkTW9kdWxlcyIsImlkIiwibG9hZGVkIiwiY2FsbCIsIm0iLCJjIiwicCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwicHJvdG90eXBlIiwiX2NvbmZpZyIsIl9lbnYiLCJfaW5kZXgiLCJfbG9nIiwiX2xvZGFzaCIsIl9sb2Rhc2gyIiwiX2NvbG9nIiwiX2NvbG9nMiIsImdsb2JhbCIsIkxvZ2dlciIsIkNvbnNvbGUiLCJzdGF0dXMiLCJ0eXBlIiwibWVzc2FnZSIsImxvZyIsImNvbG9yIiwiR29yZ29uIiwiR29yZ29uQ29uZmlnIiwiR29yZ29uRW52IiwiR29yZ29uQ29udGFpbmVyU2VydmljZSIsInNlcGFyYXRvcjEiLCJzZXBhcmF0b3IyIiwidmFsdWUiLCJfYm9vdHN0cmFwIiwicXVlc3Rpb24iLCJzZXJ2aWNlIiwiZm9yRWFjaCIsImNvbnNvbGVXaWR0aCIsImFkZCIsImxvZ0V4dExlbiIsInNwYWNlTGVuZ3RoIiwibmFtZXNwYWNlIiwic3BhY2VDaGFyIiwicmVwZWF0IiwiX2xvZ0V4dExlbiIsIl9zcGFjZUxlbmd0aCIsIl9zcGFjZUNoYXIiLCJkYXRhIiwidmVyc2lvbiIsIl9tb3RkIiwibW90ZCIsIkdvcmdvblNlcnZlciIsImluaXRTZXJ2ZXIiLCJuYW1lIiwic3RvcmFnZSIsImxvZ3MiLCJsb2FkIiwic2VydmVyIiwiY2xpIiwic2VydmljZXMiLCJkZWJ1ZyIsImVuYWJsZSIsInVuZGVmaW5lZCIsIl9pbmRleDIiLCJzaWQiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsInNlbGYiLCJSZWZlcmVuY2VFcnJvciIsIl9pbmhlcml0cyIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsImNyZWF0ZSIsImNvbnN0cnVjdG9yIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJfcm91dGVzIiwiX25ldHdvcmsiLCJOZXR3b3JrU3RhY2siLCJOZXR3b3JrIiwiU3RhdHVzU2VydmljZSIsIl9Hb3Jnb25TZXJ2aWNlIiwiX3RoaXMiLCJnZXRQcm90b3R5cGVPZiIsImNvbmZpZyIsIlN0YXR1c1NlcnZpY2VDb25maWciLCJkZXNjcmlwdGlvbiIsImh0dHBzIiwiaW5ib3VuZFR5cGVzIiwicG9ydHMiLCJyb3V0ZXIiLCJSb3V0ZXMiLCJuYW1lcHNhY2UiLCJwZXJtaXNzaW9ucyIsInNlcnZpY2VCaW5kIiwiU2VydmljZVJlcXVlc3QiLCJtZXRob2QiLCJjYWxsYmFjayIsInNlcnZpY2VSZXF1ZXN0IiwicmVxIiwicmVzIiwibW9kZSIsInNvY2tldCIsImltcG9ydFJvdXRlcyIsInJvdXRlcyIsIl9zZXROZXR3b3JraW5nIiwiYWRkU2VydmljZSIsInJlbW92ZVNlcnZpY2UiLCJHb3Jnb25TZXJ2aWNlIiwiX3RvQ29uc3VtYWJsZUFycmF5IiwiYXJyIiwiQXJyYXkiLCJpc0FycmF5IiwiYXJyMiIsImZyb20iLCJzZXJ2aWNlTmFtZXNwYWNlIiwicm91dGVDYWxsYmFja3MiLCJwZXJtaXNzaW9uTWFwIiwicHVzaCIsInBvcyIsImluZGV4T2YiLCJjb25zb2xlIiwia2V5UG9zIiwic3BsaWNlIiwiaGFzT3duUHJvcGVydHkiLCJpbmJvdW5kVHlwZSIsInBheWxvYWQiLCJfcm91dGVDYWxsYmFja3MiLCJhcHBseSIsImNvbmNhdCIsIl9tb21lbnQiLCJfbW9tZW50MiIsImNvbnRhaW5lcnMiLCJjb250YWluZXJNYXAiLCJzZXJ2aWNlSWQiLCJuZXR3b3JraW5nIiwicG9ydCIsIndhcm4iLCJhcGlDYWxsIiwiZXJyb3IiLCJlcnJvcnMiLCJyZXR1cm5lZCIsIl9taWRkbGV3YXJlIiwiX21pZGRsZXdhcmUyIiwiX2FwaSIsIl9uZXQiLCJfbmV0MiIsIl9odHRwIiwiX2h0dHAyIiwiX3NvY2tldCIsIl9zb2NrZXQyIiwiX2NvbXByZXNzaW9uIiwiX2NvbXByZXNzaW9uMiIsIl9leHByZXNzIiwiX2V4cHJlc3MyIiwibWlkZGxld2FyZSIsInNlcnZpY2VNYXAiLCJjb21wb25lbnRzIiwiY29tcG9uZW50TWFwIiwiY29tcG9uZW50VHlwZU1hcCIsInJlc3QiLCJ3ZWJTb2NrZXQiLCJodHRwIiwiYXBpIiwiQXBpIiwicG9ydFJlc2VydmF0aW9ucyIsInBvcnRSZXNlcnZhdGlvbk5hbWVzcGFjZSIsImFjdGl2ZVNlcnZpY2VzIiwic2V0U2VydmljZUlkIiwibGFiZWwiLCJjcmVhdGVkIiwiX2NyZWF0ZVJlc3RDb21wb25lbnQiLCJfY3JlYXRlSHR0cENvbXBvbmVudCIsIl9jcmVhdGVTb2NrZXRDb21wb25lbnQiLCJfY3JlYXRlV2ViU29ja2V0Q29tcG9uZW50IiwiX2NyZWF0ZUFwaUNvbXBvbmVudCIsImlzUmVzdCIsInNldExpc3RlbmVyIiwidXNlIiwiY29tcG9uZW50IiwiYWxsIiwiY2FsbENoYW5uZWwiLCJpc1BvcnRSZXNlcnZlZCIsImlzRnVuY3Rpb24iLCJsaXN0ZW5lciIsImxpc3RlbiIsImFkZFBvcnRSZXNlcnZhdGlvbiIsImFkZHJlc3MiLCJodHRwU2VydmVyIiwiU2VydmVyIiwidXNlcnMiLCJzb2NrZXRzIiwib24iLCJ1c2VySWQiLCJoYW5kc2hha2UiLCJxdWVyeSIsImN1cnJlbnRVc2VyIiwiZmluZEluZGV4IiwiZGlzY29ubmVjdCIsImVtaXQiLCJicm9hZGNhc3QiLCJzZXRXZWJTb2NrZXRFdmVudHMiLCJjcmVhdGVTZXJ2ZXIiLCJ3cml0ZSIsInBpcGUiLCJlcnIiLCJhZGRBcGlOb2RlIiwiYXBpUmVxdWVzdCIsIk1pZGRsZXdhcmUiLCJzZXJ2aWNlUmVnaXN0ZXIiLCJkYXRhTWFwIiwiY2hhbm5lbHMiLCJjaGFubmVsIiwiX2dldENoYW5uZWxJZCIsIl9nZXRFeGlzdGluZ01pZGRsZXdhcmUiLCJtaWRkbGV3YXJlTGlzdCIsImZvcmVhY2giLCJjaGFubmVsT2JqZWN0IiwiZXhpc3RpbmciLCJmaW5kIiwidG9VcHBlciIsIkFwaUNhbGwiLCJhcGlNYXAiLCJzZXJ2aWNlSWRNYXAiLCJyZXNlcnZlZCIsIm5vZGUiLCJfZ2V0Tm9kZVBvcyIsIl9pc1Jlc2VydmVkTmFtZXNwYWNlIiwiZ2V0QXBpTm9kZSIsImNhbGxBcGkiLCJtZWhvZCIsInVwZGF0ZWQiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIm5ld09iaiIsIl9mcyIsImZzIiwiX29zIiwib3MiLCJfc2FuaXRpemVGaWxlbmFtZSIsIl9zYW5pdGl6ZUZpbGVuYW1lMiIsIkxvZyIsInNhbml0aXplIiwidG9waWNNYXAiLCJzdWJzY3JpYmVycyIsInN1YnNjcmliZXJNYXAiLCJsZXZlbCIsImxldmVsS2V5IiwibG9jYXRpb24iLCJ2YWx1ZXMiLCJsb2dJdGVtIiwibG9nVmFsdWVzIiwiSlNPTiIsInN0cmluZ2lmeSIsImZpbGVuYW1lIiwiZm9ybWF0IiwibG9nRW50cnkiLCJFT0wiLCJleGlzdHNTeW5jIiwibWtkaXJTeW5jIiwiYXBwZW5kRmlsZSJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQVEsc0JBQXNCQyxVQ0E5QixTQUFBQyxFQUFBQyxHQUNBLGdCQUFBQyxVQUFBLGdCQUFBQyxRQUNBQSxPQUFBRCxRQUFBRCxFQUFBSCxRQUFBLFVBQUFBLFFBQUEsVUFBQUEsUUFBQSxPQUFBQSxRQUFBLFFBQUFBLFFBQUEsYUFBQUEsUUFBQSxlQUFBQSxRQUFBLFdBQUFBLFFBQUEsTUFBQUEsUUFBQSxNQUFBQSxRQUFBLHFCQUFBQSxRQUFBLFVBQ0Esa0JBQUFNLGdCQUFBQyxJQUNBRCxPQUFBLG9IQUFBSCxHQUNBLGdCQUFBQyxTQUNBQSxRQUFBLE9BQUFELEVBQUFILFFBQUEsVUFBQUEsUUFBQSxVQUFBQSxRQUFBLE9BQUFBLFFBQUEsUUFBQUEsUUFBQSxhQUFBQSxRQUFBLGVBQUFBLFFBQUEsV0FBQUEsUUFBQSxNQUFBQSxRQUFBLE1BQUFBLFFBQUEscUJBQUFBLFFBQUEsVUFFQUUsRUFBQSxPQUFBQyxFQUFBRCxFQUFBLE9BQUFBLEVBQUEsT0FBQUEsRUFBQSxJQUFBQSxFQUFBLEtBQUFBLEVBQUEsYUFBQUEsRUFBQSxZQUFBQSxFQUFBLFFBQUFBLEVBQUEsR0FBQUEsRUFBQSxHQUFBQSxFQUFBLHFCQUFBQSxFQUFBLFFBQ0NNLEtBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDRCxNRENnQixVQUFVQyxHRVAxQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQWxCLE9BR0EsSUFBQUMsR0FBQWtCLEVBQUFELElBQ0FsQixXQUNBb0IsR0FBQUYsRUFDQUcsUUFBQSxFQVVB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QUFLMEQsS0FBZSxNQUFSQSxHQUF3QndDLFFBQVJ4QyxFQUFvQixNQUFRQSxFQUN4RDFELEtBQUsyUixPQUFtQixNQUFWQSxHQUE0QnpMLFFBQVZ5TCxFQUFzQixLQUFPQSxFQUM3RDNSLEtBQUs2TSxTQUFVLEVBQUF2QyxtQm5CMDlEakIsU0FBU3pLLEVBQVFELEdvQm5rRXZCQyxFQUFBRCxRQUFBSixRQUFBLE9wQnlrRU0sU0FBU0ssRUFBUUQsR3FCemtFdkJDLEVBQUFELFFBQUFKLFFBQUEsT3JCK2tFTSxTQUFTSyxFQUFRRCxHc0Iva0V2QkMsRUFBQUQsUUFBQUosUUFBQSxzQnRCcWxFTSxTQUFTSyxFQUFRRCxHdUJybEV2QkMsRUFBQUQsUUFBQUosUUFBQSIsImZpbGUiOiJnb3Jnb24ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZShcInNvdXJjZS1tYXAtc3VwcG9ydFwiKS5pbnN0YWxsKCk7XG4oZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KHJlcXVpcmUoXCJtb21lbnRcIiksIHJlcXVpcmUoXCJsb2Rhc2hcIiksIHJlcXVpcmUoXCJuZXRcIiksIHJlcXVpcmUoXCJodHRwXCIpLCByZXF1aXJlKFwic29ja2V0LmlvXCIpLCByZXF1aXJlKFwiY29tcHJlc3Npb25cIiksIHJlcXVpcmUoXCJleHByZXNzXCIpLCByZXF1aXJlKFwiZnNcIiksIHJlcXVpcmUoXCJvc1wiKSwgcmVxdWlyZShcInNhbml0aXplLWZpbGVuYW1lXCIpLCByZXF1aXJlKFwiY29sb2dcIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJnb3Jnb25cIiwgW1wibW9tZW50XCIsIFwibG9kYXNoXCIsIFwibmV0XCIsIFwiaHR0cFwiLCBcInNvY2tldC5pb1wiLCBcImNvbXByZXNzaW9uXCIsIFwiZXhwcmVzc1wiLCBcImZzXCIsIFwib3NcIiwgXCJzYW5pdGl6ZS1maWxlbmFtZVwiLCBcImNvbG9nXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcImdvcmdvblwiXSA9IGZhY3RvcnkocmVxdWlyZShcIm1vbWVudFwiKSwgcmVxdWlyZShcImxvZGFzaFwiKSwgcmVxdWlyZShcIm5ldFwiKSwgcmVxdWlyZShcImh0dHBcIiksIHJlcXVpcmUoXCJzb2NrZXQuaW9cIiksIHJlcXVpcmUoXCJjb21wcmVzc2lvblwiKSwgcmVxdWlyZShcImV4cHJlc3NcIiksIHJlcXVpcmUoXCJmc1wiKSwgcmVxdWlyZShcIm9zXCIpLCByZXF1aXJlKFwic2FuaXRpemUtZmlsZW5hbWVcIiksIHJlcXVpcmUoXCJjb2xvZ1wiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wiZ29yZ29uXCJdID0gZmFjdG9yeShyb290W1wibW9tZW50XCJdLCByb290W1wibG9kYXNoXCJdLCByb290W1wibmV0XCJdLCByb290W1wiaHR0cFwiXSwgcm9vdFtcInNvY2tldC5pb1wiXSwgcm9vdFtcImNvbXByZXNzaW9uXCJdLCByb290W1wiZXhwcmVzc1wiXSwgcm9vdFtcImZzXCJdLCByb290W1wib3NcIl0sIHJvb3RbXCJzYW5pdGl6ZS1maWxlbmFtZVwiXSwgcm9vdFtcImNvbG9nXCJdKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfNl9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzhfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xMV9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzEyX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMTNfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xNF9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzE1X18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMTdfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xOF9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzE5X18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMjBfXykge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKipcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogR29yZ29uIHRoZSBzY3JpcHRpbmcgY2FwYWJsZSBuZXR3b3JrIHNlcnZlciBmb3IgTm9kZSBKU1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFja2FnZSBHb3Jnb25cclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciBSeWFuIFJlbnRmcm9cclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGxpY2Vuc2UgTUlUXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL21hbnVmYWN0dXJpbmctaW5kdXN0cnlcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cdFxuXHQvKlxyXG5cdCAqIEltcG9ydHNcclxuXHQgKi9cblx0XG5cdFxuXHR2YXIgX2NvbmZpZyA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdFxuXHR2YXIgX2VudiA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG5cdFxuXHR2YXIgX2luZGV4ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KTtcblx0XG5cdHZhciBfbG9nID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNik7XG5cdFxuXHR2YXIgX2xvZGFzaCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdFxuXHR2YXIgX2xvZGFzaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2Rhc2gpO1xuXHRcblx0dmFyIF9jb2xvZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjApO1xuXHRcblx0dmFyIF9jb2xvZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9jb2xvZyk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdC8qXHJcblx0ICogQ29uZmlndXJlIGdsb2JhbHNcclxuXHQgKi9cblx0XG5cdC8qKlxyXG5cdCAqIFRoZSBnbG9iYWwgbG9nZ2VyIGNsYXNzXHJcblx0ICpcclxuXHQgKiBAdHlwZSB7TG9nZ2VyfVxyXG5cdCAqL1xuXHRnbG9iYWwuTG9nZ2VyID0gbmV3IF9sb2cuTG9nZ2VyKCk7XG5cdFxuXHQvKipcclxuXHQgKiBUaGUgZ2xvYmFsIGNvbnNvbGUgY2xhc3NcclxuXHQgKlxyXG5cdCAqIEB0eXBlIHtvYmplY3R9IFRoZSBjb2xvZyBpbnN0YW5jZVxyXG5cdCAqL1xuXHRnbG9iYWwuQ29uc29sZSA9IF9jb2xvZzIuZGVmYXVsdDtcblx0XG5cdGdsb2JhbC5Db25zb2xlLnN0YXR1cyA9IGZ1bmN0aW9uICh0eXBlLCBtZXNzYWdlKSB7XG5cdCAgc3dpdGNoICh0eXBlKSB7XG5cdCAgICBkZWZhdWx0OlxuXHQgICAgY2FzZSAnaW5mbyc6XG5cdCAgICAgIGdsb2JhbC5Db25zb2xlLmxvZygnWycgKyBnbG9iYWwuQ29uc29sZS5jb2xvcignSScsICd5ZWxsb3cnKSArICddICcgKyBtZXNzYWdlKTtcblx0ICAgICAgYnJlYWs7XG5cdCAgICBjYXNlICdub3RpY2UnOlxuXHQgICAgICBnbG9iYWwuQ29uc29sZS5sb2coJ1snICsgZ2xvYmFsLkNvbnNvbGUuY29sb3IoJ04nLCAnY3lhbicpICsgJ10gJyArIG1lc3NhZ2UpO1xuXHQgICAgICBicmVhaztcblx0ICAgIGNhc2UgJ2Vycm9yJzpcblx0ICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKCdbJyArIGdsb2JhbC5Db25zb2xlLmNvbG9yKCdFJywgJ3JlZCcpICsgJ10gJyArIG1lc3NhZ2UpO1xuXHQgICAgICBicmVhaztcblx0ICB9XG5cdH07XG5cdFxuXHQvKipcclxuXHQgKiBUaGUgR29yZ29uIGNsYXNzXHJcblx0ICovXG5cdFxuXHR2YXIgR29yZ29uID0gZnVuY3Rpb24gKCkge1xuXHQgIC8qKlxyXG5cdCAgICogQ29uc3RydWN0cyB0aGUgY2xhc3NcclxuXHQgICAqL1xuXHQgIGZ1bmN0aW9uIEdvcmdvbigpIHtcblx0ICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBHb3Jnb24pO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgZ29yZ29uIGNvbmZpZyBmb3IgdGhlIHNlcnZlclxyXG5cdCAgICAgKiBAdHlwZSB7R29yZ29uQ29uZmlnfVxyXG5cdCAgICAgKi9cblx0ICAgIHRoaXMuR29yZ29uQ29uZmlnID0gbmV3IF9jb25maWcuR29yZ29uQ29uZmlnKCk7XG5cdFxuXHQgICAgLyoqXHJcblx0ICAgICAqIFRoZSBnb3Jnb24gc2VydmVyIGxvZ2dlclxyXG5cdCAgICAgKiBAdHlwZSB7TG9nZ2VyfVxyXG5cdCAgICAgKi9cblx0ICAgIHRoaXMuTG9nZ2VyID0gZ2xvYmFsLkxvZ2dlcjtcblx0ICAgIHRoaXMuTG9nZ2VyLmxvZygnR29yZ29uOmluaXRTZXJ2ZXInLCAyMDAsICdUaGUgR29yZ29uIGhhcyBiZWVuIHN1bW1vbmVkIC0gR09SR09OIFNFUlZFUiBTVEFSVElORy4uLicpO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgZ29yZ29uIGVudmlyb25tZW50IGZvciB0aGUgc2VydmVyXHJcblx0ICAgICAqIEB0eXBlIHtHb3Jnb25FbnZ9XHJcblx0ICAgICAqL1xuXHQgICAgdGhpcy5Hb3Jnb25FbnYgPSBuZXcgX2Vudi5Hb3Jnb25FbnYoKTtcblx0XG5cdCAgICAvKipcclxuXHQgICAgICogVGhlIGNvbnRhaW5lciBzZXJ2aWNlXHJcblx0ICAgICAqIEB0eXBlIHtHb3Jnb25Db250YWluZXJTZXJ2aWNlfVxyXG5cdCAgICAgKi9cblx0ICAgIHRoaXMuR29yZ29uQ29udGFpbmVyU2VydmljZSA9IG5ldyBfaW5kZXguR29yZ29uQ29udGFpbmVyU2VydmljZSgpO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgZmlyc3Qgc3R5bGUgb2YgQ0xJIHNlcGFyYXRvclxyXG5cdCAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG5cdCAgICAgKi9cblx0ICAgIHRoaXMuc2VwYXJhdG9yMSA9ICc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgc2Vjb25kIHN0eWxlIG9mIENMSSBzZXBhcmF0b3JcclxuXHQgICAgICogQHR5cGUge3N0cmluZ31cclxuXHQgICAgICovXG5cdCAgICB0aGlzLnNlcGFyYXRvcjIgPSAnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJztcblx0ICB9XG5cdFxuXHQgIC8qKlxyXG5cdCAgICogSW5pdGlhbGl6ZXMgdGhlIHNlcnZlciBhbmQgbG9hZHMgdGhlIGNvbmZpZ3VyZWQgc2VydmljZXMgZnJvbSB0aGUgZW52aXJvbm1lbnRcclxuXHQgICAqL1xuXHRcblx0XG5cdCAgX2NyZWF0ZUNsYXNzKEdvcmdvbiwgW3tcblx0ICAgIGtleTogXCJpbml0U2VydmVyXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFNlcnZlcigpIHtcblx0ICAgICAgdGhpcy5fYm9vdHN0cmFwKCk7XG5cdCAgICAgIGdsb2JhbC5Db25zb2xlLmxvZyh0aGlzLnNlcGFyYXRvcjIpO1xuXHQgICAgICBnbG9iYWwuQ29uc29sZS5xdWVzdGlvbignTG9hZGluZyBTZXJ2aWNlcycpO1xuXHQgICAgICBnbG9iYWwuQ29uc29sZS5sb2codGhpcy5zZXBhcmF0b3IyKTtcblx0ICAgICAgdGhpcy5Mb2dnZXIubG9nKCdHb3Jnb246aW5pdFNlcnZlcicsIDIwMCwgJ1RoZSBzZXJ2ZXIgd2FzIHN0YXJ0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG5cdFxuXHQgICAgICB0aGlzLkdvcmdvbkVudi5zZXJ2aWNlLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgdmFyIGNvbnNvbGVXaWR0aCA9IDQ4O1xuXHQgICAgICAgIHZhciBsb2FkZWQgPSB0aGlzLkdvcmdvbkNvbnRhaW5lclNlcnZpY2UuYWRkKHZhbHVlLnNlcnZpY2UpO1xuXHQgICAgICAgIGlmIChsb2FkZWQpIHtcblx0ICAgICAgICAgIHZhciBsb2dFeHRMZW4gPSA2O1xuXHQgICAgICAgICAgdmFyIHNwYWNlTGVuZ3RoID0gY29uc29sZVdpZHRoIC0gbG9nRXh0TGVuIC0gdmFsdWUubmFtZXNwYWNlLmxlbmd0aCAtIDI7XG5cdCAgICAgICAgICB2YXIgc3BhY2VDaGFyID0gX2xvZGFzaDIuZGVmYXVsdC5yZXBlYXQoJy4nLCBzcGFjZUxlbmd0aCk7XG5cdCAgICAgICAgICB0aGlzLkxvZ2dlci5sb2coJ0dvcmdvbjppbml0U2VydmVyJywgMjAwLCAnTG9hZGVkIHNlcnZpY2UgbmFtZXNwYWNlOiAnICsgdmFsdWUubmFtZXNwYWNlKTtcblx0ICAgICAgICAgIGdsb2JhbC5Db25zb2xlLmxvZyh2YWx1ZS5uYW1lc3BhY2UgKyAnICcgKyBzcGFjZUNoYXIgKyAnIFsgJyArIGdsb2JhbC5Db25zb2xlLmNvbG9yKCdPSycsICdncmVlbicpICsgJyBdJyk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHZhciBfbG9nRXh0TGVuID0gMTA7XG5cdCAgICAgICAgICB2YXIgX3NwYWNlTGVuZ3RoID0gY29uc29sZVdpZHRoIC0gX2xvZ0V4dExlbiAtIHZhbHVlLm5hbWVzcGFjZS5sZW5ndGggLSAyO1xuXHQgICAgICAgICAgdmFyIF9zcGFjZUNoYXIgPSBfbG9kYXNoMi5kZWZhdWx0LnJlcGVhdCgnLicsIF9zcGFjZUxlbmd0aCk7XG5cdCAgICAgICAgICB0aGlzLkxvZ2dlci5sb2coJ0dvcmdvbjppbml0U2VydmVyJywgNDAwLCAnRmFpbGVkIHRvIGxvYWQgc2VydmljZSB3aXRoIG5hbWVzcGFjZTogJyArIHZhbHVlLm5hbWVzcGFjZSk7XG5cdCAgICAgICAgICBnbG9iYWwuQ29uc29sZS5sb2codmFsdWUubmFtZXNwYWNlICsgJyAnICsgX3NwYWNlQ2hhciArICcgWyAnICsgZ2xvYmFsLkNvbnNvbGUuY29sb3IoJ0ZBSUxFRCcsICdyZWQnKSArICcgXScpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgdGhpcyk7XG5cdFxuXHQgICAgICB0aGlzLkxvZ2dlci5sb2coJ0dvcmdvbjppbml0U2VydmVyJywgMjAwLCAnU2VydmljZSBMb2FkaW5nIENvbXBsZXRlZCcpO1xuXHQgICAgICBnbG9iYWwuQ29uc29sZS5sb2codGhpcy5zZXBhcmF0b3IyKTtcblx0ICAgICAgZ2xvYmFsLkNvbnNvbGUucXVlc3Rpb24oJ0xvYWRpbmcgQ29tcGxldGUgLSBTZXJ2ZXIgT25saW5lJyk7XG5cdCAgICAgIGdsb2JhbC5Db25zb2xlLmxvZyh0aGlzLnNlcGFyYXRvcjEpO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgQ0xJIHNlcnZlciBib290c3RyYXBcclxuXHQgICAgICpcclxuXHQgICAgICogQHByaXZhdGVcclxuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJfYm9vdHN0cmFwXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gX2Jvb3RzdHJhcCgpIHtcblx0ICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKGdsb2JhbC5Db25zb2xlLmNvbG9yKChcIkdvcmdvbiBTZXJ2ZXJcIikgKyAnIC0gdicgKyB0aGlzLkdvcmdvbkNvbmZpZy5kYXRhLnZlcnNpb24sICdncmVlbicpKTtcblx0ICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKCdBdXRob3I6IFJ5YW4gUmVudGZybyA8cnJlbnRmcm8gYXQgZ21haWwgZG90IGNvbT4nKTtcblx0ICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKCdQcm9qZWN0OiBodHRwczovL2dpdGh1Yi5jb20vbWFudWZhY3R1cmluZy1pbmR1c3RyeS9nb3Jnb24nKTtcblx0ICAgICAgdGhpcy5fbW90ZCgpO1xuXHQgICAgICBnbG9iYWwuQ29uc29sZS5sb2coJ1ByZXNzICcgKyBnbG9iYWwuQ29uc29sZS5jb2xvcignY250cmwrYycsICd5ZWxsb3cnKSArICcgdG8gZXhpdCB0aGUgc2VydmVyJyk7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXHJcblx0ICAgICAqIFRoZSBzZXJ2ZXIgbWVzc2FnZSBvZiB0aGUgZGF5IGRpc3BsYXlcclxuXHQgICAgICpcclxuXHQgICAgICogQHByaXZhdGVcclxuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJfbW90ZFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIF9tb3RkKCkge1xuXHQgICAgICBnbG9iYWwuQ29uc29sZS5sb2codGhpcy5zZXBhcmF0b3IxKTtcblx0ICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKGdsb2JhbC5Db25zb2xlLmNvbG9yKHRoaXMuR29yZ29uQ29uZmlnLmRhdGEubW90ZCwgJ3llbGxvdycpKTtcblx0ICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKHRoaXMuc2VwYXJhdG9yMSk7XG5cdCAgICB9XG5cdCAgfV0pO1xuXHRcblx0ICByZXR1cm4gR29yZ29uO1xuXHR9KCk7XG5cdFxuXHQvKlxyXG5cdCAqIFJ1biB0aGUgR29yZ29uIFNlcnZlclxyXG5cdCAqL1xuXHRcblx0XG5cdHZhciBHb3Jnb25TZXJ2ZXIgPSBuZXcgR29yZ29uKCk7XG5cdEdvcmdvblNlcnZlci5pbml0U2VydmVyKCk7XG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHQvKipcclxuXHQgKiBHb3Jnb24gdGhlIHNjcmlwdGluZyBjYXBhYmxlIG5ldHdvcmsgc2VydmVyIGZvciBOb2RlIEpTXHJcblx0ICpcclxuXHQgKiBAcGFja2FnZSBHb3Jnb25cclxuXHQgKiBAYXV0aG9yIFJ5YW4gUmVudGZyb1xyXG5cdCAqIEBsaWNlbnNlIE1JVFxyXG5cdCAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL21hbnVmYWN0dXJpbmctaW5kdXN0cnlcclxuXHQgKi9cblx0XG5cdC8qKlxyXG5cdCAqIFRoZSBHb3Jnb24gY29uZmlnIGNsYXNzXHJcblx0ICovXG5cdHZhciBHb3Jnb25Db25maWcgPVxuXHQvKipcclxuXHQgKiBDb25zdHJ1Y3RzIHRoZSBjbGFzc1xyXG5cdCAqL1xuXHRleHBvcnRzLkdvcmdvbkNvbmZpZyA9IGZ1bmN0aW9uIEdvcmdvbkNvbmZpZygpIHtcblx0ICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR29yZ29uQ29uZmlnKTtcblx0XG5cdCAgLyoqXHJcblx0ICAgKiBUaGUgc2VydmVycyBkZWZhdWx0IGNvbmZpZyBkYXRhXHJcblx0ICAgKiBAdHlwZSB7e25hbWU6IHN0cmluZywgdmVyc2lvbjogc3RyaW5nfX1cclxuXHQgICAqL1xuXHQgIHRoaXMuZGF0YSA9IHtcblx0ICAgIG5hbWU6IChcImdvcmdvblwiKSxcblx0ICAgIHZlcnNpb246IChcIjAuMC4yIEJ1aWxkOiA1NSAtIFByZS1BbHBoYVwiKSxcblx0ICAgIG1vdGQ6IChcIlRoaXMgaXMgdGhlIG1lc3NhZ2Ugb2YgdGhlIGRheS5cIilcblx0ICB9O1xuXHRcblx0ICAvKipcclxuXHQgICAqIFRoZSBzZXJ2ZXJzIGRlZmF1bHQgc3RvcmFnZSBjb25maWdcclxuXHQgICAqXHJcblx0ICAgKiBAbm90ZSBDb250YWlucyB0aGUgcGF0aCBwb2ludGVycyBmb3IgYmFzZSBzdG9yYWdlIGNvbXBvbmVudHNcclxuXHQgICAqXHJcblx0ICAgKiBAdHlwZSB7e2xvZ3M6IHN0cmluZ319XHJcblx0ICAgKi9cblx0ICB0aGlzLnN0b3JhZ2UgPSB7XG5cdCAgICBsb2dzOiAnbG9ncy8nXG5cdCAgfTtcblx0XG5cdCAgLyoqXHJcblx0ICAgKiBUaGUgc2VydmVycyBkZWZhdWx0IGxheWVycyBjb250cm9sc1xyXG5cdCAgICogQHR5cGUge3tzZXJ2ZXI6IGJvb2xlYW4sIGNsaTogYm9vbGVhbiwgc2VydmljZXM6IGJvb2xlYW59fVxyXG5cdCAgICovXG5cdCAgdGhpcy5sb2FkID0ge1xuXHQgICAgc2VydmVyOiB0cnVlLFxuXHQgICAgY2xpOiB0cnVlLFxuXHQgICAgc2VydmljZXM6IHRydWVcblx0ICB9O1xuXHRcblx0ICAvKipcclxuXHQgICAqIENvbnRyb2xzIGRlYnVnZ2luZ1xyXG5cdCAgICogQHR5cGUge3tlbmFibGU6IGJvb2xlYW59fVxyXG5cdCAgICovXG5cdCAgdGhpcy5kZWJ1ZyA9IHtcblx0ICAgIGVuYWJsZTogdHJ1ZVxuXHQgIH07XG5cdH07XG5cbi8qKiovIH0sXG4vKiAyICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLkdvcmdvbkVudiA9IHVuZGVmaW5lZDtcblx0XG5cdHZhciBfaW5kZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuXHRcblx0dmFyIF9pbmRleDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pbmRleCk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH0gLyoqXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEdvcmdvbiB0aGUgc2NyaXB0aW5nIGNhcGFibGUgbmV0d29yayBzZXJ2ZXIgZm9yIE5vZGUgSlNcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhY2thZ2UgR29yZ29uXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgUnlhbiBSZW50ZnJvXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBsaWNlbnNlIE1JVFxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAdXJsIGh0dHBzOi8vZ2l0aHViLmNvbS9tYW51ZmFjdHVyaW5nLWluZHVzdHJ5XHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXHRcblx0LyoqXHJcblx0ICogVGhlIEdvcmdvbiBlbnYgY2xhc3NcclxuXHQgKi9cblx0dmFyIEdvcmdvbkVudiA9IGV4cG9ydHMuR29yZ29uRW52ID0gZnVuY3Rpb24gR29yZ29uRW52KCkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdvcmdvbkVudik7XG5cdFxuXHQgICAgdGhpcy5zZXJ2aWNlID0gbmV3IF9pbmRleDIuZGVmYXVsdCgpO1xuXHQgICAgdGhpcy5zZXJ2aWNlID0gW3tcblx0ICAgICAgICBzaWQ6IDAsXG5cdCAgICAgICAgbmFtZTogJ1N0YXR1cycsXG5cdCAgICAgICAgbmFtZXNwYWNlOiAnU3RhdHVzU2VydmljZScsXG5cdCAgICAgICAgZW5hYmxlOiB0cnVlLFxuXHQgICAgICAgIHNlcnZpY2U6IHRoaXMuc2VydmljZSB9XTtcblx0fTtcblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfcm91dGVzID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTtcblx0XG5cdHZhciBfaW5kZXggPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpO1xuXHRcblx0dmFyIF9jb25maWcgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuXHRcblx0dmFyIF9uZXR3b3JrID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblx0XG5cdGZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKipcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBHb3Jnb24gdGhlIHNjcmlwdGluZyBjYXBhYmxlIG5ldHdvcmsgc2VydmVyIGZvciBOb2RlIEpTXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFja2FnZSBHb3Jnb25cclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIFJ5YW4gUmVudGZyb1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBsaWNlbnNlIE1JVFxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL21hbnVmYWN0dXJpbmctaW5kdXN0cnlcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblx0XG5cdC8qXHJcblx0ICogSW1wb3J0c1xyXG5cdCAqL1xuXHRcblx0XG5cdHZhciBOZXR3b3JrU3RhY2sgPSBuZXcgX25ldHdvcmsuTmV0d29yaygpO1xuXHRcblx0LyoqXHJcblx0ICogVGhlIHN0YXR1cyBzZXJ2aWNlXHJcblx0ICpcclxuXHQgKiBAbm90ZSBQcm92aWRlcyBzdGF0dXMgb24gc2VydmVyIGNvbmZpZ3VyYXRpb25cclxuXHQgKi9cblx0XG5cdHZhciBTdGF0dXNTZXJ2aWNlID0gZnVuY3Rpb24gKF9Hb3Jnb25TZXJ2aWNlKSB7XG5cdCAgX2luaGVyaXRzKFN0YXR1c1NlcnZpY2UsIF9Hb3Jnb25TZXJ2aWNlKTtcblx0XG5cdCAgLyoqXHJcblx0ICAgKiBDb25zdHJ1Y3RzIHRoZSBjbGFzc1xyXG5cdCAgICovXG5cdCAgZnVuY3Rpb24gU3RhdHVzU2VydmljZSgpIHtcblx0ICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdGF0dXNTZXJ2aWNlKTtcblx0XG5cdCAgICAvKipcclxuXHQgICAgICogVGhlIHN0YXR1cyBzZXJ2aWNlIGNvbmZpZ3VyYXRpb25cclxuXHQgICAgICogQHR5cGUge1N0YXR1c1NlcnZpY2VDb25maWd9XHJcblx0ICAgICAqL1xuXHQgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKFN0YXR1c1NlcnZpY2UpLmNhbGwodGhpcykpO1xuXHRcblx0ICAgIF90aGlzLmNvbmZpZyA9IF9jb25maWcuU3RhdHVzU2VydmljZUNvbmZpZztcblx0XG5cdCAgICAvKipcclxuXHQgICAgICogVGhlIHNlcnZpY2UgbmFtZVxyXG5cdCAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG5cdCAgICAgKi9cblx0ICAgIF90aGlzLm5hbWUgPSAnU3RhdHVzIFNlcnZpY2UnO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgc2VydmljZSBuYW1lc3BhY2VcclxuXHQgICAgICogQHR5cGUge3N0cmluZ31cclxuXHQgICAgICovXG5cdCAgICBfdGhpcy5uYW1lc3BhY2UgPSAnU3RhdHVzU2VydmljZSc7XG5cdFxuXHQgICAgLyoqXHJcblx0ICAgICAqIFRoZSBzZXJ2aWNlIGRlc2NyaXB0aW9uXHJcblx0ICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcblx0ICAgICAqL1xuXHQgICAgX3RoaXMuZGVzY3JpcHRpb24gPSAnUHJvdmlkZXMgc2VydmljZSBzdGF0dXMnO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgc2VydmljZSB0eXBlXHJcblx0ICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcblx0ICAgICAqL1xuXHQgICAgX3RoaXMudHlwZSA9ICdTZXJ2aWNlJztcblx0XG5cdCAgICAvKipcclxuXHQgICAgICogVGhlIHNlcnZpY2UgaHR0cHMgY29udHJvbCAtIGNvbnRyb2xzIGhvdyBodHRwcyB3b3JrcyBmb3IgdGhlIHNlcnZpY2VzIGV4cG9zZWQgaHR0cCBlbmRwb2ludHNcclxuXHQgICAgICogQHR5cGUge3N0cmluZ3xib29sZWFufSBDYW4gYmUgZW5hYmxlLCBkaXNhYmxlLCB0cnVlLCBmYWxzZSwgb3IgZW5mb3JjZVxyXG5cdCAgICAgKi9cblx0ICAgIF90aGlzLmh0dHBzID0gdHJ1ZTtcblx0XG5cdCAgICAvKipcclxuXHQgICAgICogVGhlIGluYm91bmQgdHlwZXMgc3VwcG9ydGVkIGJ5IHRoZSBzZXJ2aWNlXHJcblx0ICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cclxuXHQgICAgICovXG5cdCAgICBfdGhpcy5pbmJvdW5kVHlwZXMgPSBbJ3Jlc3QnLCAnc29ja2V0JywgJ2h0dHAnLCAnd2ViU29ja2V0JywgJ2FwaSddO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgcG9ydHMgdGhhdCBtYXAgdG8gdGhlIGluYm91bmQgdHlwZXMgMToxXHJcblx0ICAgICAqIEB0eXBlIHtudW1iZXJ8bnVsbFtdfVxyXG5cdCAgICAgKi9cblx0ICAgIF90aGlzLnBvcnRzID0gWzI2MDAsIG51bGwsIDI2ODAsIDI2ODgsIG51bGxdO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgcm91dGVyIGZvciB0aGUgc2VydmljZVxyXG5cdCAgICAgKiBAdHlwZSB7Um91dGVzfVxyXG5cdCAgICAgKi9cblx0ICAgIF90aGlzLnJvdXRlciA9IG5ldyBfcm91dGVzLlJvdXRlcyhfdGhpcy5uYW1lcHNhY2UpO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgcGVybWlzc2lvbnMgZm9yIHRoZSBzZXJ2aWNlXHJcblx0ICAgICAqIEB0eXBlIHtzdHJpbmdbXX0gQ2FuIGJlIGludGVybmFsIGFuZC9vciBleHRlcm5hbFxyXG5cdCAgICAgKi9cblx0ICAgIF90aGlzLnBlcm1pc3Npb25zID0gWydpbnRlcm5hbCddO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBCaW5kcyB0aGUgc2VydmljZXMgcm91dGVzIGFuZCBuZXR3b3JraW5nXHJcblx0ICAgICAqL1xuXHQgICAgX3RoaXMuc2VydmljZUJpbmQoKTtcblx0ICAgIHJldHVybiBfdGhpcztcblx0ICB9XG5cdFxuXHQgIC8qKlxyXG5cdCAgICogVGhlIHJvdXRlcyBjb25maWd1cmF0aW9uIGZvciB0aGUgc2VydmljZVxyXG5cdCAgICpcclxuXHQgICAqIEBub3RlIFRoaXMgaXMgbG9hZGVkIGludG8gdGhlIGNsYXNzZXMgcm91dGVyIGFuZCB0aGUgbmV0d29yayBzdGFja1xyXG5cdCAgICovXG5cdFxuXHRcblx0ICBfY3JlYXRlQ2xhc3MoU3RhdHVzU2VydmljZSwgW3tcblx0ICAgIGtleTogJ3JvdXRlcycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcm91dGVzKCkge1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgICdTZXJ2aWNlUmVxdWVzdCc6IHtcblx0ICAgICAgICAgIGluYm91bmRUeXBlczogdGhpcy5pbmJvdW5kVHlwZXMsXG5cdCAgICAgICAgICBtZXRob2Q6ICcvU3RhdHVzU2VydmljZVJlcXVlc3QnLFxuXHQgICAgICAgICAgY2FsbGJhY2s6IHRoaXMuc2VydmljZVJlcXVlc3QoKVxuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcclxuXHQgICAgICogVGhlIHNlcnZpY2UgcmVxdWVzdCBtZXRob2QgZm9yIGh0dHAgYW5kIHJlc3Qgc2VydmljZXNcclxuXHQgICAgICpcclxuXHQgICAgICogQG5vdGUgUHJvdmlkZXMgdGhlIHNlcnZpY2UgcmVxdWVzdCBmb3IgdGhlIHNlcnZlclxyXG5cdCAgICAgKlxyXG5cdCAgICAgKiBAcGFyYW0ge1JlcXVlc3R9IHJlcSBBIHJlcXVlc3Qgb2JqZWN0XHJcblx0ICAgICAqIEBwYXJhbSB7T2JqZWN0fSByZXMgQSByZXNwb25zZSBvYmplY3RcclxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IG1vZGUgQ29udHJvbHMgaWYgdGhlIGNhbGwgaXMgaHR0cCBvciByZXN0XHJcblx0ICAgICAqIEB0b2RvIEFkZCByb3V0aW5nIGZvciBoYW5kbGluZyBpbmJvdW5kIHJlcXVlc3RzXHJcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdzZXJ2aWNlUmVxdWVzdCcsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc2VydmljZVJlcXVlc3QocmVxLCByZXMsIG1vZGUpIHt9XG5cdFxuXHQgICAgLyoqXHJcblx0ICAgICAqIFRoZSBzZXJ2aWNlIGFwaSBjYWxsIG1ldGhvZFxyXG5cdCAgICAgKlxyXG5cdCAgICAgKlxyXG5cdCAgICAgKiBAcGFyYW0gZGF0YVxyXG5cdCAgICAgKiBAdG9kbyBBZGQgcm91dGluZyBmb3IgaGFuZGxpbmcgaW5ib3VuZCByZXF1ZXN0c1xyXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnYXBpUmVxdWVzdCcsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gYXBpUmVxdWVzdChkYXRhKSB7fVxuXHQgIH0sIHtcblx0ICAgIGtleTogJ3NldFdlYlNvY2tldEV2ZW50cycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc2V0V2ViU29ja2V0RXZlbnRzKHNvY2tldCkge31cblx0XG5cdCAgICAvKipcclxuXHQgICAgICogQmluZHMgdGhlIHNlcnZpY2VzIHJvdXRlcyBhbmQgbmV0d29ya2luZyBjb21wb25lbnRzXHJcblx0ICAgICAqXHJcblx0ICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uXHJcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdzZXJ2aWNlQmluZCcsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc2VydmljZUJpbmQoKSB7XG5cdCAgICAgIC8qXHJcblx0ICAgICAgICogSW1wb3J0cyB0aGUgcm91dGVycyByb3V0ZXMgZnJvbSB0aGUgY2xhc3NcclxuXHQgICAgICAgKi9cblx0ICAgICAgdGhpcy5yb3V0ZXIuaW1wb3J0Um91dGVzKHRoaXMucm91dGVzKCkpO1xuXHRcblx0ICAgICAgLypcclxuXHQgICAgICAgKiBTZXQgdGhlIG5ldHdvcmtpbmcgY29uZmlndXJhdGlvbiBmb3IgdGhlIGNsYXNzXHJcblx0ICAgICAgICovXG5cdCAgICAgIHRoaXMuX3NldE5ldHdvcmtpbmcoKTtcblx0XG5cdCAgICAgIC8qXHJcblx0ICAgICAgICogQWRkIHRoZSBzZXJ2aWNlIHRvIHRoZSBuZXR3b3JrXHJcblx0ICAgICAgICovXG5cdCAgICAgIE5ldHdvcmtTdGFjay5hZGRTZXJ2aWNlKHRoaXMpO1xuXHRcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiAnc2VydmljZVVuYmluZCcsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc2VydmljZVVuYmluZCgpIHtcblx0ICAgICAgTmV0d29ya1N0YWNrLnJlbW92ZVNlcnZpY2UodGhpcy5uYW1lc3BhY2UpO1xuXHQgICAgfVxuXHQgIH1dKTtcblx0XG5cdCAgcmV0dXJuIFN0YXR1c1NlcnZpY2U7XG5cdH0oX2luZGV4LkdvcmdvblNlcnZpY2UpO1xuXHRcblx0LypcclxuXHQgKiBFeHBvcnRzXHJcblx0ICovXG5cdFxuXHRcblx0ZXhwb3J0cy5kZWZhdWx0ID0gU3RhdHVzU2VydmljZTtcblx0bW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG5cbi8qKiovIH0sXG4vKiA0ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgeyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0gZWxzZSB7IHJldHVybiBBcnJheS5mcm9tKGFycik7IH0gfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdC8qKlxyXG5cdCAqIEdvcmdvbiB0aGUgc2NyaXB0aW5nIGNhcGFibGUgbmV0d29yayBzZXJ2ZXIgZm9yIE5vZGUgSlNcclxuXHQgKlxyXG5cdCAqIEBwYWNrYWdlIEdvcmdvblxyXG5cdCAqIEBhdXRob3IgUnlhbiBSZW50ZnJvXHJcblx0ICogQGxpY2Vuc2UgTUlUXHJcblx0ICogQHVybCBodHRwczovL2dpdGh1Yi5jb20vbWFudWZhY3R1cmluZy1pbmR1c3RyeVxyXG5cdCAqL1xuXHRcblx0dmFyIFJvdXRlcyA9IGV4cG9ydHMuUm91dGVzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gUm91dGVzKHNlcnZpY2VOYW1lc3BhY2UpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUm91dGVzKTtcblx0XG5cdCAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZU5hbWVzcGFjZTtcblx0ICAgICAgICB0aGlzLmluYm91bmRUeXBlcyA9IFsncmVzdCcsICdzb2NrZXQnLCAnaHR0cCcsICdodHRwcycsICd3ZWJTb2NrZXQnLCAnYXBpJ107XG5cdCAgICAgICAgdGhpcy5yb3V0ZXMgPSBbXTtcblx0ICAgICAgICB0aGlzLnJvdXRlQ2FsbGJhY2tzID0gW107XG5cdCAgICAgICAgdGhpcy5wZXJtaXNzaW9uTWFwID0gW107XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFJvdXRlcywgW3tcblx0ICAgICAgICBrZXk6ICdhZGQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGQoaW5ib3VuZFR5cGVzLCBtZXRob2QsIGNhbGxiYWNrKSB7XG5cdCAgICAgICAgICAgIHRoaXMucm91dGVzLnB1c2gobWV0aG9kKTtcblx0ICAgICAgICAgICAgdGhpcy5yb3V0ZUNhbGxiYWNrcyhjYWxsYmFjayk7XG5cdCAgICAgICAgICAgIHZhciBwb3MgPSB0aGlzLnJvdXRlQ2FsbGJhY2tzLmxlbmd0aCAtIDE7XG5cdFxuXHQgICAgICAgICAgICBpbmJvdW5kVHlwZXMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICAgICAgICAgIGlmICh0aGlzLmluYm91bmRUeXBlcy5pbmRleE9mKHZhbHVlKSA+IC0xKSB0aGlzLnBlcm1pc3Npb25NYXBbdmFsdWVdLnB1c2gocG9zKTtlbHNlIGNvbnNvbGUubG9nKCdFUlJPUiAtIEludmFsaWQgUGVybWlzc2lvbiBFbmNvdW50ZXJlZCBpbiBTZXJ2aWNlOiBbJyArIHRoaXMuc2VydmljZSArICddIE1ldGhvZDogWycgKyBtZXRob2QgKyAnXScpO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVtb3ZlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKG1ldGhvZCkge1xuXHQgICAgICAgICAgICB2YXIgcG9zID0gdGhpcy5yb3V0ZXMuaW5kZXhPZihtZXRob2QpO1xuXHQgICAgICAgICAgICBpZiAocG9zID4gLTEpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMucm91dGVDYWxsYmFja3NbcG9zXSA9IG51bGw7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnJvdXRlc1twb3NdID0gbnVsbDtcblx0XG5cdCAgICAgICAgICAgICAgICB0aGlzLmluYm91bmRUeXBlcy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnBlcm1pc3Npb25NYXBbdmFsdWVdICE9IHVuZGVmaW5lZCAmJiB0aGlzLnBlcm1pc3Npb25NYXBbdmFsdWVdIGluc3RhbmNlb2YgQXJyYXkpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGtleVBvcyA9IHRoaXMucGVybWlzc2lvbk1hcFt2YWx1ZV0uaW5kZXhPZihwb3MpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAoa2V5UG9zID4gLTEpIHRoaXMucGVybWlzc2lvbk1hcFt2YWx1ZV0uc3BsaWNlKGtleVBvcywgMSk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2ltcG9ydFJvdXRlcycsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGltcG9ydFJvdXRlcyhyb3V0ZXMpIHtcblx0ICAgICAgICAgICAgaWYgKHJvdXRlcyBpbnN0YW5jZW9mIEFycmF5KSB7XG5cdCAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gcm91dGVzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKHJvdXRlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkKHJvdXRlc1trZXldWydpbmJvdW5kVHlwZXMnXSwgcm91dGVzW2tleV1bJ21ldGhvZCddLCByb3V0ZXNba2V5XVsnY2FsbGJhY2snXSk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncm91dGUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByb3V0ZShpbmJvdW5kVHlwZSwgbWV0aG9kLCBwYXlsb2FkKSB7XG5cdCAgICAgICAgICAgIHZhciBwb3MgPSB0aGlzLnJvdXRlcy5pbmRleE9mKG1ldGhvZCk7XG5cdCAgICAgICAgICAgIGlmIChwb3MgPiAtMSkge1xuXHQgICAgICAgICAgICAgICAgaWYgKHRoaXMucGVybWlzc2lvbk1hcFtpbmJvdW5kVHlwZV0gIT0gdW5kZWZpbmVkICYmIHRoaXMucGVybWlzc2lvbk1hcFtpbmJvdW5kVHlwZV0ubGVuZ3RoID4gMCAmJiB0aGlzLnBlcm1pc3Npb25NYXBbaW5ib3VuZFR5cGVdLmluZGV4T2YocG9zKSA+IC0xKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIF9yb3V0ZUNhbGxiYWNrcztcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgLy9jYWxsYmFjayBleGlzdHMgZm9yIG1ldGhvZFxuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybiAoX3JvdXRlQ2FsbGJhY2tzID0gdGhpcy5yb3V0ZUNhbGxiYWNrcylbcG9zXS5hcHBseShfcm91dGVDYWxsYmFja3MsIFttZXRob2QsIGluYm91bmRUeXBlXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHBheWxvYWQpKSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblxuXHQgICAgcmV0dXJuIFJvdXRlcztcblx0fSgpO1xuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLkdvcmdvblNlcnZpY2UgPSBleHBvcnRzLkdvcmdvbkNvbnRhaW5lclNlcnZpY2UgPSB1bmRlZmluZWQ7XG5cdFxuXHR2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKipcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogR29yZ29uIHRoZSBzY3JpcHRpbmcgY2FwYWJsZSBuZXR3b3JrIHNlcnZlciBmb3IgTm9kZSBKU1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFja2FnZSBHb3Jnb25cclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciBSeWFuIFJlbnRmcm9cclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGxpY2Vuc2UgTUlUXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL21hbnVmYWN0dXJpbmctaW5kdXN0cnlcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cdFxuXHQvKlxyXG5cdCAqIEltcG9ydHNcclxuXHQgKi9cblx0XG5cdFxuXHR2YXIgX21vbWVudCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdFxuXHR2YXIgX21vbWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tb21lbnQpO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHQvKipcclxuXHQgKiBUaGUgR29yZ29uIENvbnRhaW5lciBTZXJ2aWNlIENsYXNzXHJcblx0ICpcclxuXHQgKiBAbm90ZSBUaGlzIGNsYXNzIHByb3ZpZGVzIGNvbnRhaW5lcnMgZm9yIHNlcnZpY2VzXHJcblx0ICovXG5cdHZhciBHb3Jnb25Db250YWluZXJTZXJ2aWNlID0gZXhwb3J0cy5Hb3Jnb25Db250YWluZXJTZXJ2aWNlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgLyoqXHJcblx0ICAgICAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gR29yZ29uQ29udGFpbmVyU2VydmljZSgpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR29yZ29uQ29udGFpbmVyU2VydmljZSk7XG5cdFxuXHQgICAgICAgIHRoaXMuY29udGFpbmVycyA9IFtdO1xuXHQgICAgICAgIHRoaXMuY29udGFpbmVyTWFwID0gW107XG5cdCAgICAgICAgdGhpcy5uYW1lID0gXCJHb3Jnb24gQ29udGFpbmVyIFNlcnZpY2VcIjtcblx0ICAgICAgICB0aGlzLnR5cGUgPSBcIlNlcnZpY2VcIjtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcclxuXHQgICAgICogQWRkcyBhIG5ldyBzZXJ2aWNlIGJ5IGNyZWF0aW5nIGEgY29udGFpbmVyIGFuZCBpbmplY3RpbmcgdGhlIHNlcnZpY2UgYW5kIGl0cyBsb2NhdGlvbiB0byB0aGUgc2VydmljZSBtYXBcclxuXHQgICAgICpcclxuXHQgICAgICogQHBhcmFtIHtvYmplY3R9IHNlcnZpY2UgVGhlIHNlcnZpY2UgdG8gdGJlIGFkZGVkXHJcblx0ICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRydWUgb24gY29tcGxldGlvbiBhbmQgZmFsc2Ugb24gZmFpbHVyZVxyXG5cdCAgICAgKi9cblx0XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKEdvcmdvbkNvbnRhaW5lclNlcnZpY2UsIFt7XG5cdCAgICAgICAga2V5OiBcImFkZFwiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGQoc2VydmljZSkge1xuXHQgICAgICAgICAgICBpZiAoc2VydmljZS5uYW1lc3BhY2UgIT0gbnVsbCAmJiBzZXJ2aWNlLm5hbWVzcGFjZSAhPSAnJyAmJiB0aGlzLmNvbnRhaW5lck1hcC5pbmRleE9mKHNlcnZpY2UubmFtZXNwYWNlKSA9PSAtMSkge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJzLnB1c2goc2VydmljZSk7XG5cdCAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lck1hcC5wdXNoKHNlcnZpY2UubmFtZXNwYWNlKTtcblx0ICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogUmVtb3ZlcyBhIHNlcnZpY2UgY29udGFpbmVyIGJ5IHRoZSBzZXJ2aWNlIG5hbWVzcGFjZVxyXG5cdCAgICAgICAgICpcclxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlTmFtZXNwYWNlIFRoZSBzZXJ2aWNlIG5hbWVzcGFjZSB0byBiZSByZW1vdmVkXHJcblx0ICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIG9uIGNvbXBsZXRpb24gYW5kIGZhbHNlIG9uIGZhaWx1cmVcclxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6IFwicmVtb3ZlXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZShzZXJ2aWNlTmFtZXNwYWNlKSB7XG5cdCAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5lck1hcC5pbmRleE9mKHNlcnZpY2VOYW1lc3BhY2UpID4gLTEpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBwb3MgPSB0aGlzLmNvbnRhaW5lck1hcC5pbmRleE9mKHNlcnZpY2VOYW1lc3BhY2UpO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJzLnNwbGljZShwb3MsIDEpO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXJNYXAuc3BsaWNlKHBvcywgMSk7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcclxuXHQgICAgICAgICAqIFJldHJpZXZlcyBhIHNlcnZpY2UgY29udGFpbmVyIGJ5IGl0cyBuYW1lc3BhY2VcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZU5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2VcclxuXHQgICAgICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBzZXJ2aWNlIHdoZW4gbG9jYXRlZCBvciBmYWxzZSB3aGVuIG5vdCBsb2NhdGVkXHJcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiBcImdldFwiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXQoc2VydmljZU5hbWVzcGFjZSkge1xuXHQgICAgICAgICAgICBpZiAodGhpcy5jb250YWluZXJNYXAuaW5kZXhPZihzZXJ2aWNlTmFtZXNwYWNlKSA+IC0xKSByZXR1cm4gdGhpcy5jb250YWluZXJzW3RoaXMuY29udGFpbmVyTWFwLmluZGV4T2Yoc2VydmljZU5hbWVzcGFjZSldO1xuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBHb3Jnb25Db250YWluZXJTZXJ2aWNlO1xuXHR9KCk7XG5cdFxuXHQvKipcclxuXHQgKiBUaGUgZ29yZ29uIHNlcnZpY2Ugb2JqZWN0XHJcblx0ICpcclxuXHQgKiBAbm90ZSBQcm92aWRlcyB0aGUgc2VydmljZSwgZGVmYXVsdCBwcm9wZXJ0aWVzL21ldGhvZHMgdXNlZCBmb3IgY29uc3RydWN0aW5nIGNvbnRhaW5lcnNcclxuXHQgKi9cblx0XG5cdFxuXHR2YXIgR29yZ29uU2VydmljZSA9IGV4cG9ydHMuR29yZ29uU2VydmljZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBDb25zdHJ1Y3RzIHRoZSBjbGFzc1xyXG5cdCAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIEdvcmdvblNlcnZpY2UoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEdvcmdvblNlcnZpY2UpO1xuXHRcblx0ICAgICAgICAvKipcclxuXHQgICAgICAgICAqIFRoZSBzZXJ2aWNlIGlkIGZvciB0aGUgc2VydmljZVxyXG5cdCAgICAgICAgICpcclxuXHQgICAgICAgICAqIEBub3RlIFRoZSBzZXJ2aWNlIElkIGlzIHNldCB3aGVuIGEgc2VydmljZSBpcyBhZGRlZCB0byB0aGUgbmV0d29yayBsYXllciBhbmQgaXRzIHNlcnZpY2UgaWQgaXMgcmV0dXJuZWRcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAdHlwZSB7bnVsbHxudW1iZXJ9XHJcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLnNlcnZpY2VJZCA9IG51bGw7XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogVGhlIHNlcnZpY2UgbmFtZVxyXG5cdCAgICAgICAgICogQHR5cGUge251bGx8c3RyaW5nfVxyXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5uYW1lID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBUaGUgc2VydmljZSBkZXNjcmlwdGlvblxyXG5cdCAgICAgICAgICogQHR5cGUge251bGx8c3RyaW5nfVxyXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IG51bGw7XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogVGhlIHNlcnZpY2UgdHlwZVxyXG5cdCAgICAgICAgICogQHR5cGUge3N0cmluZ31cclxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMudHlwZSA9ICdTZXJ2aWNlJztcblx0XG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBUaGUgc2VydmljZSByb3V0ZXJcclxuXHQgICAgICAgICAqIEB0eXBlIHtudWxsfFJvdXRlcn1cclxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMucm91dGVyID0gbnVsbDtcblx0XG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBUaGUgbGlzdCBvZiBpbmJvdW5kIHNlcnZpY2UgdHlwZXMgdG8gY29ubmVjdFxyXG5cdCAgICAgICAgICpcclxuXHQgICAgICAgICAqIEBub3RlIFRoZXNlIG1hcCAxOjEgd2l0aCB0aGlzLnBvcnRzXHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5pbmJvdW5kVHlwZXMgPSBbXTtcblx0XG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBUaGUgbGlzdCBvZiBpbmJvdW5kIHBvcnRzIHR5cGVzIHRvXHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQG5vdGUgVGhlc2UgbWFwIDE6MSB3aXRoIHRoaXMuaW5ib3VuZFR5cGVzXHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG5cdCAgICAgICAgICovXG5cdCAgICAgICAgdGhpcy5wb3J0cyA9IFtdO1xuXHRcblx0ICAgICAgICAvKipcclxuXHQgICAgICAgICAqIFRoZSBzZXJ2aWNlIHBlcm1pc3Npb25zIGxpc3RcclxuXHQgICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuXHQgICAgICAgICAqL1xuXHQgICAgICAgIHRoaXMucGVybWlzc2lvbnMgPSBbXTtcblx0XG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBUaGUgc2VydmljZSBuZXR3b3JraW5nIGNvbmZpZ3VyYXRpb25cclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAbm90ZSBNb3N0IG9iamVjdCB3aWxsIGJ1aWxkIHRoaXMgdmlhIHRoaXMuX3NldE5ldHdvcmtpbmdcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAdHlwZSB7QXJyYXl9XHJcblx0ICAgICAgICAgKi9cblx0ICAgICAgICB0aGlzLm5ldHdvcmtpbmcgPSBbXTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcclxuXHQgICAgICogU2V0cyB0aGUgbmV0d29ya2luZyBwcm9wZXJ0eSB2aWEgdGhlIGluYm91bmRUeXBlcyBhbmQgcG9ydHMgcHJvcGVydGllc1xyXG5cdCAgICAgKiBAcHJpdmF0ZVxyXG5cdCAgICAgKi9cblx0XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKEdvcmdvblNlcnZpY2UsIFt7XG5cdCAgICAgICAga2V5OiBcIl9zZXROZXR3b3JraW5nXCIsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZXROZXR3b3JraW5nKCkge1xuXHQgICAgICAgICAgICBpZiAodGhpcy5pbmJvdW5kVHlwZXMgaW5zdGFuY2VvZiBBcnJheSAmJiB0aGlzLnBvcnRzIGluc3RhbmNlb2YgQXJyYXkgJiYgdGhpcy5pbmJvdW5kVHlwZXMubGVuZ3RoID09IHRoaXMucG9ydHMubGVuZ3RoKSB7XG5cdCAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaW5ib3VuZFR5cGVzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXR3b3JraW5nLnB1c2goeyBuYW1lOiB0aGlzLmluYm91bmRUeXBlc1tpXSwgcG9ydDogdGhpcy5wb3J0c1tpXSB9KTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignR29yZ29uU2VydmljZTpfc2V0TmV0d29ya2luZyAtIE1pc3Npbmcgb3IgaW52YWxpZCBuZXR3b3JraW5nIGZvciBzZXJ2aWNlICcgKyB0aGlzLm5hbWUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcclxuXHQgICAgICAgICAqIFNldHMgdGhlIHNlcnZpY2VJZCBmb3IgdGhlIHNlcnZpY2VcclxuXHQgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzZXJ2aWNlSWRcclxuXHQgICAgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uXHJcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiBcInNldFNlcnZpY2VJZFwiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTZXJ2aWNlSWQoc2VydmljZUlkKSB7XG5cdCAgICAgICAgICAgIHRoaXMuc2VydmljZUlkID0gc2VydmljZUlkO1xuXHQgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogSW50ZXJmYWNlOiBUaGUgZGVmYXVsdCBzZXJ2aWNlUmVxdWVzdCBtZXRob2RcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge3JlcX0gcmVxIFRoZSByZXF1ZXN0IG9iamVjdFxyXG5cdCAgICAgICAgICogQHBhcmFtIHtyZXN9IHJlcyBUaGUgcmVzcG9uc2Ugb2JqZWN0XHJcblx0ICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBmb3IgdGhlIHNlcnZpY2UgcmVxdWVzdCAoaHR0cCBvciByZXN0KVxyXG5cdCAgICAgICAgICogQHJldHVybnMge251bGx9IFJldHVybnMgbnVsbCB3aGVuIG5vdCBpbXBsZW1lbnRlZFxyXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogXCJzZXJ2aWNlUmVxdWVzdFwiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXJ2aWNlUmVxdWVzdChyZXEsIHJlcywgdHlwZSkge1xuXHQgICAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogSW50ZXJmYWNlOiBUaGUgZGVmYXVsdCBhcGlSZXF1ZXN0IG1ldGhvZFxyXG5cdCAgICAgICAgICpcclxuXHQgICAgICAgICAqIEBwYXJhbSB7QXBpQ2FsbH0gYXBpQ2FsbCBUaGUgQXBpQ2FsbCBvYmplY3RcclxuXHQgICAgICAgICAqIEByZXR1cm5zIHtBcGlDYWxsfSBSZXR1cm5zIHRoZSBhcGkgY2FsbCBhZnRlciBzZXR0aW5nIGVycm9yIHN0YXRlIGFuZCB1cGRhdGluZyB0aGUgcmV0dXJuZWQgdGltZXN0YW1wXHJcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiBcImFwaVJlcXVlc3RcIixcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBpUmVxdWVzdChhcGlDYWxsKSB7XG5cdCAgICAgICAgICAgIGFwaUNhbGwuZXJyb3IgPSB0cnVlO1xuXHQgICAgICAgICAgICBhcGlDYWxsLmVycm9ycywgcHVzaCgnQVBJIGNhbGwgaGFuZGxlciBub3QgZGVmaW5lZCcpO1xuXHQgICAgICAgICAgICBhcGlDYWxsLnJldHVybmVkID0gKDAsIF9tb21lbnQyLmRlZmF1bHQpKCk7XG5cdCAgICAgICAgICAgIHJldHVybiBhcGlDYWxsO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBJbnRlcmZhY2U6IFRoZSBkZWZhdWx0IGFwaVJlcXVlc3QgbWV0aG9kXHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHNvY2tldCBUaGUgc29ja2V0IG9iamVjdCB0byBjYWxsXHJcblx0ICAgICAgICAgKiBAcmV0dXJucyB7bnVsbH0gUmV0dXJucyBudWxsIHdoZW4gbm90IGltcGxlbWVudGVkXHJcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiBcInNldFdlYlNvY2tldEV2ZW50c1wiLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRXZWJTb2NrZXRFdmVudHMoc29ja2V0KSB7XG5cdCAgICAgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblxuXHQgICAgcmV0dXJuIEdvcmdvblNlcnZpY2U7XG5cdH0oKTtcblxuLyoqKi8gfSxcbi8qIDYgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1vbWVudFwiKTtcblxuLyoqKi8gfSxcbi8qIDcgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuTmV0d29yayA9IHVuZGVmaW5lZDtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qKlxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBHb3Jnb24gdGhlIHNjcmlwdGluZyBjYXBhYmxlIG5ldHdvcmsgc2VydmVyIGZvciBOb2RlIEpTXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBwYWNrYWdlIEdvcmdvblxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIFJ5YW4gUmVudGZyb1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAbGljZW5zZSBNSVRcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQHVybCBodHRwczovL2dpdGh1Yi5jb20vbWFudWZhY3R1cmluZy1pbmR1c3RyeVxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblx0XG5cdC8qXHJcblx0ICogSW1wb3J0c1xyXG5cdCAqL1xuXHRcblx0XG5cdHZhciBfbG9kYXNoID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblx0XG5cdHZhciBfbG9kYXNoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZGFzaCk7XG5cdFxuXHR2YXIgX21pZGRsZXdhcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpO1xuXHRcblx0dmFyIF9taWRkbGV3YXJlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21pZGRsZXdhcmUpO1xuXHRcblx0dmFyIF9hcGkgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKTtcblx0XG5cdHZhciBfbmV0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMSk7XG5cdFxuXHR2YXIgX25ldDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9uZXQpO1xuXHRcblx0dmFyIF9odHRwID0gX193ZWJwYWNrX3JlcXVpcmVfXygxMik7XG5cdFxuXHR2YXIgX2h0dHAyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaHR0cCk7XG5cdFxuXHR2YXIgX3NvY2tldCA9IF9fd2VicGFja19yZXF1aXJlX18oMTMpO1xuXHRcblx0dmFyIF9zb2NrZXQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc29ja2V0KTtcblx0XG5cdHZhciBfY29tcHJlc3Npb24gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE0KTtcblx0XG5cdHZhciBfY29tcHJlc3Npb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfY29tcHJlc3Npb24pO1xuXHRcblx0dmFyIF9leHByZXNzID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNSk7XG5cdFxuXHR2YXIgX2V4cHJlc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhwcmVzcyk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdC8qXHJcblx0ICogVmFyaWFibGVzXHJcblx0ICovXG5cdFxuXHQvKipcclxuXHQgKiBDb250YWlucyB0aGUgc2luZ2xldG9uIGluc3RhbmNlIGZvciB0aGUgbmV0d29ya1xyXG5cdCAqIEB0eXBlIHtudWxsfE5ldHdvcmt9XHJcblx0ICovXG5cdHZhciBpbnN0YW5jZSA9IG51bGw7XG5cdFxuXHQvKipcclxuXHQgKiBUaGUgbmV0d29yayBjb250cm9scyBzaW5nbGV0b24gY2xhc3NcclxuXHQgKlxyXG5cdCAqIEBub3RlIENyZWF0ZXMgYW5kIG1hcHMgdGhlIG5ldHdvcmsgY29tcG9uZW50cyBmb3Igc2VydmljZXNcclxuXHQgKi9cblx0XG5cdHZhciBOZXR3b3JrID0gZXhwb3J0cy5OZXR3b3JrID0gZnVuY3Rpb24gKCkge1xuXHQgICAgLyoqXHJcblx0ICAgICAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcblx0ICAgICAqL1xuXHQgICAgZnVuY3Rpb24gTmV0d29yaygpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTmV0d29yayk7XG5cdFxuXHQgICAgICAgIGlmICghaW5zdGFuY2UpIHtcblx0ICAgICAgICAgICAgLyoqXHJcblx0ICAgICAgICAgICAgICogVGhlIG1pZGRsZXdhcmUgZm9yIHRoZSBjbGFzc1xyXG5cdCAgICAgICAgICAgICAqIEB0eXBlIHtNaWRkbGV3YXJlfVxyXG5cdCAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICB0aGlzLm1pZGRsZXdhcmUgPSBuZXcgX21pZGRsZXdhcmUyLmRlZmF1bHQoKTtcblx0XG5cdCAgICAgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICAgICAqIFRoZSBzZXJ2aWNlcyBzdGFja1xyXG5cdCAgICAgICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuXHQgICAgICAgICAgICAgKi9cblx0ICAgICAgICAgICAgdGhpcy5zZXJ2aWNlcyA9IFtdO1xuXHRcblx0ICAgICAgICAgICAgLyoqXHJcblx0ICAgICAgICAgICAgICogVGhlIHNlcnZpY2Ugc3RhY2sgbWFwXHJcblx0ICAgICAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG5cdCAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICB0aGlzLnNlcnZpY2VNYXAgPSBbXTtcblx0XG5cdCAgICAgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICAgICAqIFRoZSBjb21wb25lbnQgY29sbGVjdGlvblxyXG5cdCAgICAgICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuXHQgICAgICAgICAgICAgKi9cblx0ICAgICAgICAgICAgdGhpcy5jb21wb25lbnRzID0gW107XG5cdFxuXHQgICAgICAgICAgICAvKipcclxuXHQgICAgICAgICAgICAgKiBUaGUgY29tcG9uZW50IGNvbGxlY3Rpb24gbWFwXHJcblx0ICAgICAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG5cdCAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICB0aGlzLmNvbXBvbmVudE1hcCA9IFtdO1xuXHRcblx0ICAgICAgICAgICAgLyoqXHJcblx0ICAgICAgICAgICAgICogVGhlIGNvbXBvbmVudCBjb2xsZWN0aW9uIHR5cGUgbWFwXHJcblx0ICAgICAgICAgICAgICogQHR5cGUge3tyZXN0OiBBcnJheSwgc29ja2V0OiBBcnJheSwgd2ViU29ja2V0OiBBcnJheSwgaHR0cDogQXJyYXksIGFwaTogQXJyYXl9fVxyXG5cdCAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICB0aGlzLmNvbXBvbmVudFR5cGVNYXAgPSB7XG5cdCAgICAgICAgICAgICAgICByZXN0OiBbXSxcblx0ICAgICAgICAgICAgICAgIHNvY2tldDogW10sXG5cdCAgICAgICAgICAgICAgICB3ZWJTb2NrZXQ6IFtdLFxuXHQgICAgICAgICAgICAgICAgaHR0cDogW10sXG5cdCAgICAgICAgICAgICAgICBhcGk6IFtdXG5cdCAgICAgICAgICAgIH07XG5cdFxuXHQgICAgICAgICAgICAvKipcclxuXHQgICAgICAgICAgICAgKiBUaGUgbmV0d29yayBBUEkgY29udHJvbFxyXG5cdCAgICAgICAgICAgICAqIEB0eXBlIHtBcGl9XHJcblx0ICAgICAgICAgICAgICovXG5cdCAgICAgICAgICAgIHRoaXMuYXBpID0gbmV3IF9hcGkuQXBpKCk7XG5cdFxuXHQgICAgICAgICAgICAvKipcclxuXHQgICAgICAgICAgICAgKiBUaGUgcG9ydCByZXNlcnZhdGlvbiBsaXN0XHJcblx0ICAgICAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG5cdCAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICB0aGlzLnBvcnRSZXNlcnZhdGlvbnMgPSBbXTtcblx0XG5cdCAgICAgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICAgICAqIFRoZSBwb3J0IHJlc2VydmF0aW9uIG5hbWVzcGFjZSBsaXN0XHJcblx0ICAgICAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG5cdCAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICB0aGlzLnBvcnRSZXNlcnZhdGlvbk5hbWVzcGFjZSA9IFtdO1xuXHRcblx0ICAgICAgICAgICAgLyoqXHJcblx0ICAgICAgICAgICAgICogVGhlIGFjdGl2ZSBzZXJ2aWNlIGluIHRoZSBuZXR3b3JrIHN0YWNrXHJcblx0ICAgICAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG5cdCAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICB0aGlzLmFjdGl2ZVNlcnZpY2VzID0gW107XG5cdFxuXHQgICAgICAgICAgICBpbnN0YW5jZSA9IHRoaXM7XG5cdCAgICAgICAgfSBlbHNlIHJldHVybiBpbnN0YW5jZTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcclxuXHQgICAgICogQWRkcyBhIHNlcnZpY2UgdG8gdGhlIG5ldHdvcmsgbGF5ZXJcclxuXHQgICAgICpcclxuXHQgICAgICogQHBhcmFtIHtvYmplY3R9IHNlcnZpY2UgVGhlIHNlcnZpY2UgdG8gYmUgYWRkZWRcclxuXHQgICAgICogQHJldHVybiB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIG9uIGNvbXBsZXRpb24gYW5kIGZhbHNlIG9uIGZhaWx1cmVcclxuXHQgICAgICovXG5cdFxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhOZXR3b3JrLCBbe1xuXHQgICAgICAgIGtleTogJ2FkZFNlcnZpY2UnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRTZXJ2aWNlKHNlcnZpY2UpIHtcblx0ICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlU2VydmljZXMuaW5kZXhPZihzZXJ2aWNlLm5hbWVzcGFjZSkgPT0gLTEpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuc2VydmljZXMucHVzaChzZXJ2aWNlKTtcblx0ICAgICAgICAgICAgICAgIHRoaXMuc2VydmljZU1hcC5wdXNoKHNlcnZpY2UubmFtZXNwYWNlKTtcblx0ICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlSWQgPSB0aGlzLnNlcnZpY2VNYXAubGVuZ3RoIC0gMTtcblx0ICAgICAgICAgICAgICAgIHNlcnZpY2Uuc2V0U2VydmljZUlkKHNlcnZpY2UpO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8qXHJcblx0ICAgICAgICAgICAgICAgICAqIEFkZCBuZXR3b3JraW5nIGNvbXBvbmVudHNcclxuXHQgICAgICAgICAgICAgICAgICovXG5cdCAgICAgICAgICAgICAgICBpZiAoc2VydmljZS5uZXR3b3JraW5nIGluc3RhbmNlb2YgQXJyYXkpIHtcblx0ICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlcnZpY2UubmV0d29ya2luZy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAvKipcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgKiBAdG9kbyBSRVNVTUUgSEVSRVxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZChzZXJ2aWNlSWQsIHNlcnZpY2UubmFtZXNwYWNlLCBzZXJ2aWNlLm5ldHdvcmtpbmdbaV0ubmFtZSwgJ2xhYmVsJywgc2VydmljZS5uZXR3b3JraW5nW2ldLnBvcnQpO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICBnbG9iYWwuTG9nZ2VyLmxvZygnTmV0d29yazphZGRTZXJ2aWNlJywgMjAwLCAnQWRkZWQgc2VydmljZXMgY29tcG9uZW50czogJyArIHNlcnZpY2UubmFtZSArICcgZm9yIFNlcnZpY2U6ICcgKyBzZXJ2aWNlLm5hbWVzcGFjZSArICcgLSBTZXJ2aWNlSWQ6ICcgKyBzZXJ2aWNlSWQpO1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogUmVtb3ZlcyB0aGUgc2VydmljZXMgbmV0d29yayBjb21wb25lbnRzXHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VOYW1lc3BhY2UgVGhlIG5hbWVzcGFjZSBvZiB0aGUgc2VydmljZSB0byBiZSByZW1vdmVkXHJcblx0ICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSBSZXR1cm5zIHRydWUgb24gY29tcGxldGlvbiBhbmQgZmFsc2Ugb24gZmFpbHVyZVxyXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbW92ZVNlcnZpY2UnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVTZXJ2aWNlKHNlcnZpY2VOYW1lc3BhY2UpIHt9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogQWRkcyBhIHNlcnZpY2UgbmV0d29yayBjb21wb25lbnRcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gc2VydmljZUlkIFRoZSBzZXJ2aWNlSWQgZm9yIHRoZSBzZXJ2aWNlXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZU5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2UgZm9yIHRoZSBjb21wb25lbnRcclxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFRoZSBuZXR3b3JrIGNvbXBvbmVudCB0eXBlXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFiZWwgVGhlIGxhYmVsIGZvciB0aGUgY29tcG9uZW50XHJcblx0ICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ3xudWxsfSBwb3J0IFRoZSBvcHRpb25hbCBwb3J0IGZvciB0aGUgbmV0d29yayBjb21wb25lbnRcclxuXHQgICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IG1pZGRsZXdhcmUgVGhlIG1pZGRsZXdhcmUgdG8gY2FsbCBmb3IgdGhpcyBzZXJ2aWNlXHJcblx0ICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSBSZXR1cm5zIHRydWUgb24gY29tcGxldGlvbiBhbmQgZmFsc2Ugb24gZmFpbHVyZVxyXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2FkZCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZChzZXJ2aWNlSWQsIHNlcnZpY2VOYW1lc3BhY2UsIHR5cGUsIGxhYmVsLCBwb3J0LCBtaWRkbGV3YXJlKSB7XG5cdCAgICAgICAgICAgIHZhciBjcmVhdGVkID0gZmFsc2U7XG5cdCAgICAgICAgICAgIHZhciByZXNlcnZlUG9ydCA9IGZhbHNlO1xuXHQgICAgICAgICAgICB2YXIgY3JlYXRlUG9ydCA9IG51bGw7XG5cdCAgICAgICAgICAgIGlmICh0aGlzLnBvcnRSZXNlcnZhdGlvbnMuaW5kZXhPZihwb3J0KSA9PSAtMSB8fCBwb3J0ID09IG51bGwgfHwgcG9ydCA9PSB1bmRlZmluZWQpIHtcblx0ICAgICAgICAgICAgICAgIGlmIChwb3J0ID09IHVuZGVmaW5lZCB8fCBwb3J0ID09IG51bGwpIHBvcnQgPSAwO1xuXHQgICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcblx0ICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ05ldHdvcms6YWRkJywgNDAwLCAnVW5hYmxlIHRvIGxvYWQgY29tcG9uZW50IHR5cGUgb2Y6ICcgKyB0eXBlICsgJyBmb3IgU2VydmljZTogJyArIHNlcnZpY2VOYW1lc3BhY2UgKyAnIC0gU2VydmljZUlkOiAnICsgc2VydmljZUlkKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgICAgICBjYXNlICdyZXN0Jzpcblx0ICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZCA9IHRoaXMuX2NyZWF0ZVJlc3RDb21wb25lbnQoc2VydmljZUlkLCBzZXJ2aWNlTmFtZXNwYWNlLCBwb3J0LCBtaWRkbGV3YXJlKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICAgICAgY2FzZSAnaHR0cCc6XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQgPSB0aGlzLl9jcmVhdGVIdHRwQ29tcG9uZW50KHNlcnZpY2VJZCwgc2VydmljZU5hbWVzcGFjZSwgcG9ydCwgbWlkZGxld2FyZSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NvY2tldCc6XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQgPSB0aGlzLl9jcmVhdGVTb2NrZXRDb21wb25lbnQoc2VydmljZUlkLCBzZXJ2aWNlTmFtZXNwYWNlLCBwb3J0KTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICAgICAgY2FzZSAnd2ViU29ja2V0Jzpcblx0ICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlZCA9IHRoaXMuX2NyZWF0ZVdlYlNvY2tldENvbXBvbmVudChzZXJ2aWNlSWQsIHNlcnZpY2VOYW1lc3BhY2UsIHBvcnQsIG1pZGRsZXdhcmUpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgICAgICBjYXNlICdhcGknOlxuXHQgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkID0gdGhpcy5fY3JlYXRlQXBpQ29tcG9uZW50KHNlcnZpY2VJZCwgc2VydmljZU5hbWVzcGFjZSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgICAgIGlmIChjcmVhdGVkID09PSBmYWxzZSkgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5jb21wb25lbnRzLnB1c2goY3JlYXRlZCk7XG5cdCAgICAgICAgICAgICAgICB0aGlzLmNvbXBvbmVudE1hcC5wdXNoKHNlcnZpY2VOYW1lc3BhY2UgKyAnLScgKyB0eXBlICsgJy0nICsgbGFiZWwgKyAnLScgKyBwb3J0KTtcblx0ICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50VHlwZU1hcFt0eXBlXS5wdXNoKHNlcnZpY2VOYW1lc3BhY2UgKyAnLScgKyB0eXBlICsgJy0nICsgcG9ydCk7XG5cdCAgICAgICAgICAgICAgICBnbG9iYWwuTG9nZ2VyLmxvZygnTmV0d29yazphZGQnLCAyMDAsICdBZGRlZCBuZXR3b3JrIGNvbXBvbmVudDogJyArIHR5cGUgKyAnIGZvciBTZXJ2aWNlOiAnICsgc2VydmljZU5hbWVzcGFjZSArICcgLSBTZXJ2aWNlSWQ6ICcgKyBzZXJ2aWNlSWQpO1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBDcmVhdGVzIGEgUkVTVCBuZXR3b3JrIGNvbXBvbmVudFxyXG5cdCAgICAgICAgICpcclxuXHQgICAgICAgICAqIEBub3RlIEEgUkVTVCBuZXR3b3JrIGNvbXBvbmVudCB1c2VzIHRoZSBodHRwIDEuMSBzdGFjayAoZXhwcmVzcylcclxuXHQgICAgICAgICAqIEBub3RlIFdoZW4gdGhlIHBvcnQgaXMgc2V0IHRvIDAgYSByYW5kb20gYXZhaWxhYmxlIHBvcnQgd2lsbCBiZSBhc3NpZ25lZFxyXG5cdCAgICAgICAgICpcclxuXHQgICAgICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzZXJ2aWNlSWQgVGhlIHNlcnZpY2VzIGlkIGZyb20gdGhlIHNlcnZpY2Ugc3RhY2tcclxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lc3BhY2UgVGhlIG5hbWVzcGFjZSBmb3IgdGhlIHNlcnZpY2VcclxuXHQgICAgICAgICAqIEBwYXJhbSB7bnVsbHxudW1iZXJ9IHBvcnQgVGhlIHBvcnQgZm9yIHRoZSBzZXJ2aWNlIG9yIG51bGwuXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBtaWRkbGV3YXJlIFRoZSBtaWRkbGV3YXJlIHRvIGNhbGwgZm9yIHRoaXMgc2VydmljZVxyXG5cdCAgICAgICAgICogQHJldHVybnMgeyp9IFJldHVybnMgY29tcG9uZW50IGlmIGNyZWF0ZWQgb3IgZmFsc2Ugb24gZmFpbHVyZVxyXG5cdCAgICAgICAgICogQHByaXZhdGVcclxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdfY3JlYXRlUmVzdENvbXBvbmVudCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVSZXN0Q29tcG9uZW50KHNlcnZpY2VJZCwgbmFtZXNwYWNlLCBwb3J0LCBtaWRkbGV3YXJlKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVIdHRwQ29tcG9uZW50KHNlcnZpY2VJZCwgbmFtZXNwYWNlLCBwb3J0LCBtaWRkbGV3YXJlLCB0cnVlKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogQ3JlYXRlcyBhIGh0dHAgbmV0d29yayBjb21wb25lbnRcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAbm90ZSBXaGVuIGEgcG9ydCBpcyBzZXQgZm9yIG51bGwgaWYgdGhlIGNvbXBvbmVudCByZXF1aXJlcyBhIHBvcnQgdG8gYmUgY3JlYXRlZCB0aGUgc2VydmljZSB3aWxsIGFzc2lnbiBhIHJhbmRvbSBwb3J0LiAgVGhlIHNlcnZpY2Ugd2lsbCBuZWVkIHRvIHJldHJpZXZlIHRoaXMgaW5mb3JtYXRpb24gYXMgbmVlZGVkLlxyXG5cdCAgICAgICAgICogQG5vdGUgQSBodHRwIG5ldHdvcmsgY29tcG9uZW50IHVzZXMgdGhlIGh0dHAgMS4xIHN0YWNrIChleHByZXNzKVxyXG5cdCAgICAgICAgICogQG5vdGUgV2hlbiB0aGUgcG9ydCBpcyBzZXQgdG8gMCBhIHJhbmRvbSBhdmFpbGFibGUgcG9ydCB3aWxsIGJlIGFzc2lnbmVkXHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHNlcnZpY2VJZCBUaGUgc2VydmljZXMgaWQgZnJvbSB0aGUgc2VydmljZSBzdGFja1xyXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIGZvciB0aGUgc2VydmljZVxyXG5cdCAgICAgICAgICogQHBhcmFtIHtudWxsfG51bWJlcn0gcG9ydCBUaGUgcG9ydCBmb3IgdGhlIHNlcnZpY2Ugb3IgbnVsbC5cclxuXHQgICAgICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IG1pZGRsZXdhcmUgVGhlIG1pZGRsZXdhcmUgdG8gY2FsbCBmb3IgdGhpcyBzZXJ2aWNlXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW58dW5kZWZpbmVkfSBpc1Jlc3QgQ29udHJvbHMgdGhlIHJlc3QgaW50ZXJmYWNlIGZsYWcgd2hlbiBjcmVhdGluZyB0aGUgaHR0cCBpbnN0YW5jZVxyXG5cdCAgICAgICAgICogQHJldHVybnMgeyp9IFJldHVybnMgY29tcG9uZW50IGlmIGNyZWF0ZWQgb3IgZmFsc2Ugb24gZmFpbHVyZVxyXG5cdCAgICAgICAgICogQHByaXZhdGVcclxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdfY3JlYXRlSHR0cENvbXBvbmVudCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVIdHRwQ29tcG9uZW50KHNlcnZpY2VJZCwgbmFtZXNwYWNlLCBwb3J0LCBtaWRkbGV3YXJlLCBpc1Jlc3QpIHtcblx0ICAgICAgICAgICAgdmFyIHNldExpc3RlbmVyID0gdHJ1ZTtcblx0ICAgICAgICAgICAgaWYgKGlzUmVzdCA9PSB1bmRlZmluZWQpIGlzUmVzdCA9IGZhbHNlO1xuXHRcblx0ICAgICAgICAgICAgdmFyIHNlcnZlciA9ICgwLCBfZXhwcmVzczIuZGVmYXVsdCkoKTtcblx0ICAgICAgICAgICAgc2VydmVyLnVzZSgoMCwgX2NvbXByZXNzaW9uMi5kZWZhdWx0KSh7fSkpO1xuXHRcblx0ICAgICAgICAgICAgdmFyIGNvbXBvbmVudCA9IHNlcnZlci5hbGwoJy8nLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMubWlkZGxld2FyZS5jYWxsQ2hhbm5lbCgnUFJFX1JFUVVFU1QnLCByZXEpO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5taWRkbGV3YXJlLmNhbGxDaGFubmVsKCdQUkVfUkVTUE9OU0UnLCByZXMpO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5zZXJ2aWNlc1tzZXJ2aWNlSWRdLnNlcnZpY2VSZXF1ZXN0KHJlcSwgcmVzLCBpc1Jlc3QgPT09IGZhbHNlID8gJ2h0dHAnIDogJ3Jlc3QnKTtcblx0ICAgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5pc1BvcnRSZXNlcnZlZChwb3J0KSkge1xuXHQgICAgICAgICAgICAgICAgc2V0TGlzdGVuZXIgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICAgIHZhciBwb3MgPSB0aGlzLnBvcnRSZXNlcnZhdGlvbnMuaW5kZXhPZihwb3J0KTtcblx0ICAgICAgICAgICAgICAgIHZhciBzZXJ2aWNlTmFtZXNwYWNlID0gdGhpcy5wb3J0UmVzZXJ2YXRpb25OYW1lc3BhY2VbcG9zXTtcblx0ICAgICAgICAgICAgICAgIGlmIChzZXJ2aWNlTmFtZXNwYWNlICE9IG5hbWVzcGFjZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIGdsb2JhbC5Mb2dnZXIubG9nKCdOZXR3b3JrOl9jcmVhdGVIdHRwQ29tcG9uZW50JywgNDAwLCAnVW5hYmxlIHRvIGNyZWF0ZSBuZXcgaHR0cCBjb21wb25lbnQgLSBQb3J0IFJlc2VydmVkIGJ5IGFub3RoZXIgc2VydmljZS4gQXR0ZW1wdGVkIHRvIG1vdW50OiAnICsgbmFtZXNwYWNlICsgJyAvIFNlcnZpY2VJZDogJyArIHNlcnZpY2VJZCArICcgLSBFeGlzdGluZyBzZXJ2aWNlIGFzc2lnbmVkIHRvIHBvcnQ6ICcgKyBzZXJ2aWNlTmFtZXNwYWNlLCB7IHR5cGU6IGlzUmVzdCA9PT0gZmFsc2UgPyAnaHR0cCcgOiAncmVzdCcgfSk7XG5cdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICBpZiAoX2xvZGFzaDIuZGVmYXVsdC5pc0Z1bmN0aW9uKG1pZGRsZXdhcmUpKSBjb21wb25lbnQudXNlKG1pZGRsZXdhcmUpO1xuXHRcblx0ICAgICAgICAgICAgaWYgKHNldExpc3RlbmVyKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBjb21wb25lbnQubGlzdGVuKHBvcnQsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgICAgICBOZXR3b3JrU3RhY2suYWRkUG9ydFJlc2VydmF0aW9uKG5hbWVzcGFjZSwgbGlzdGVuZXIuYWRkcmVzcygpLnBvcnQpO1xuXHQgICAgICAgICAgICAgICAgICAgIGdsb2JhbC5Db25zb2xlLnN0YXR1cygnaW5mbycsICdIdHRwIEJvdW5kIFR5cGU6ICcgKyAoaXNSZXN0ID09PSBmYWxzZSA/ICdodHRwJyA6ICdyZXN0JykgKyAnIC0gU2VydmljZTogJyArIG5hbWVzcGFjZSArICcgLSAnICsgKHBvcnQgPT0gMCA/ICdSYW5kb20gJyA6ICcnKSArICdQb3J0OiAnICsgbGlzdGVuZXIuYWRkcmVzcygpLnBvcnQpO1xuXHQgICAgICAgICAgICAgICAgICAgIGdsb2JhbC5Mb2dnZXIubG9nKCdOZXR3b3JrOl9jcmVhdGVIdHRwQ29tcG9uZW50JywgMjAwLCAnQ3JlYXRlZCBuZXcgaHR0cCBjb21wb25lbnQgLSBNb3VudGVkOiAnICsgbmFtZXNwYWNlICsgJyAvIFNlcnZpY2VJZDogJyArIHNlcnZpY2VJZCArICcgLSBsaXN0ZW5pbmcgb24gJyArIChwb3J0ID09IDAgPyAnUmFuZG9tICcgOiAnJykgKyAnUG9ydDogJyArIGxpc3RlbmVyLmFkZHJlc3MoKS5wb3J0LCB7IHR5cGU6IGlzUmVzdCA9PT0gZmFsc2UgPyAnaHR0cCcgOiAncmVzdCcgfSk7XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogQ3JlYXRlcyBhIHdlYiBzb2NrZXQgbmV0d29yayBjb21wb25lbnRcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAbm90ZSBVc2VzIHNvY2tldCBpby9leHByZXNzIGZvciB3ZWIgc29ja2V0IHNlcnZlclxyXG5cdCAgICAgICAgICogQG5vdGUgV2hlbiB0aGUgcG9ydCBpcyBzZXQgdG8gMCBhIHJhbmRvbSBhdmFpbGFibGUgcG9ydCB3aWxsIGJlIGFzc2lnbmVkXHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHNlcnZpY2VJZCBUaGUgc2VydmljZXMgaWQgZnJvbSB0aGUgc2VydmljZSBzdGFja1xyXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIGZvciB0aGUgc2VydmljZVxyXG5cdCAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHBvcnQgVGhlIHBvcnQgZm9yIHRoZSB3ZWIgc29ja2V0IGNvbXBvbmVudFxyXG5cdCAgICAgICAgICogQHBhcmFtIHtmdW5jdGlvbn0gbWlkZGxld2FyZSBUaGUgbWlkZGxld2FyZSB0byBjYWxsIGZvciB0aGlzIHNlcnZpY2VcclxuXHQgICAgICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIGNvbXBvbmVudCBpZiBjcmVhdGVkIG9yIGZhbHNlIG9uIGZhaWx1cmVcclxuXHQgICAgICAgICAqIEBwcml2YXRlXHJcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnX2NyZWF0ZVdlYlNvY2tldENvbXBvbmVudCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVXZWJTb2NrZXRDb21wb25lbnQoc2VydmljZUlkLCBuYW1lc3BhY2UsIHBvcnQsIG1pZGRsZXdhcmUpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIHZhciBzZXRMaXN0ZW5lciA9IHRydWU7XG5cdCAgICAgICAgICAgIGlmICh0aGlzLmlzUG9ydFJlc2VydmVkKHBvcnQpKSB7XG5cdCAgICAgICAgICAgICAgICBzZXRMaXN0ZW5lciA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgdmFyIHBvcyA9IHRoaXMucG9ydFJlc2VydmF0aW9ucy5pbmRleE9mKHBvcnQpO1xuXHQgICAgICAgICAgICAgICAgdmFyIHNlcnZpY2VOYW1lc3BhY2UgPSB0aGlzLnBvcnRSZXNlcnZhdGlvbk5hbWVzcGFjZVtwb3NdO1xuXHQgICAgICAgICAgICAgICAgaWYgKHNlcnZpY2VOYW1lc3BhY2UgIT0gbmFtZXNwYWNlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ05ldHdvcms6X2NyZWF0ZVJlc3RDb21wb25lbnQnLCA0MDAsICdVbmFibGUgdG8gY3JlYXRlIGNvbXBvbmVudCAtIFBvcnQgUmVzZXJ2ZWQgYnkgYW5vdGhlciBzZXJ2aWNlLiBBdHRlbXB0ZWQgdG8gbW91bnQ6ICcgKyBuYW1lc3BhY2UgKyAnIC8gU2VydmljZUlkOiAnICsgc2VydmljZUlkICsgJyAtIEV4aXN0aW5nIHNlcnZpY2UgYXNzaWduZWQgdG8gcG9ydDogJyArIHNlcnZpY2VOYW1lc3BhY2UpO1xuXHQgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgLy9jcmVhdGUgd2ViU29ja2V0IGNvbXBvbmVudFxuXHQgICAgICAgICAgICB2YXIgc2VydmVyID0gKDAsIF9leHByZXNzMi5kZWZhdWx0KSgpO1xuXHQgICAgICAgICAgICBzZXJ2ZXIudXNlKCgwLCBfY29tcHJlc3Npb24yLmRlZmF1bHQpKHt9KSk7XG5cdFxuXHQgICAgICAgICAgICB2YXIgaHR0cFNlcnZlciA9IF9odHRwMi5kZWZhdWx0LlNlcnZlcihzZXJ2ZXIpO1xuXHQgICAgICAgICAgICB2YXIgd2ViU29ja2V0ID0gbmV3IF9zb2NrZXQyLmRlZmF1bHQoaHR0cFNlcnZlcik7XG5cdFxuXHQgICAgICAgICAgICB2YXIgdXNlcnMgPSBbXTtcblx0ICAgICAgICAgICAgdmFyIHNvY2tldHMgPSB7fTtcblx0XG5cdCAgICAgICAgICAgIHdlYlNvY2tldC51c2UoKDAsIF9jb21wcmVzc2lvbjIuZGVmYXVsdCkoe30pKTtcblx0ICAgICAgICAgICAgLy9hcHAudXNlKGV4cHJlc3NbJ3N0YXRpYyddKF9fZGlybmFtZSArICcvLi4vLi4vY2xpZW50JykpO1xuXHRcblx0ICAgICAgICAgICAgd2ViU29ja2V0Lm9uKCdjb25uZWN0aW9uJywgZnVuY3Rpb24gKHNvY2tldCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIHVzZXJJZCA9IHNvY2tldC5oYW5kc2hha2UucXVlcnkudXNlcklkO1xuXHQgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRVc2VyID0ge1xuXHQgICAgICAgICAgICAgICAgICAgIGlkOiBzb2NrZXQuaWQsXG5cdCAgICAgICAgICAgICAgICAgICAgdXNlcklkOiB1c2VySWRcblx0ICAgICAgICAgICAgICAgIH07XG5cdFxuXHQgICAgICAgICAgICAgICAgaWYgKGZpbmRJbmRleCh1c2VycywgY3VycmVudFVzZXIuaWQpID4gLTEpIHtcblx0ICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0lORk9dIFVzZXIgSUQgaXMgYWxyZWFkeSBjb25uZWN0ZWQsIGtpY2tpbmcuJyk7XG5cdCAgICAgICAgICAgICAgICAgICAgc29ja2V0LmRpc2Nvbm5lY3QoKTtcblx0ICAgICAgICAgICAgICAgIH0gLyplbHNlIGlmICghdmFsaWROaWNrKGN1cnJlbnRVc2VyLm5pY2spKSB7XHJcblx0ICAgICAgICAgICAgICAgICAgIHNvY2tldC5kaXNjb25uZWN0KCk7XHJcblx0ICAgICAgICAgICAgICAgICAgfSovZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbSU5GT10gVXNlciBJRDogJyArIGN1cnJlbnRVc2VyLnVzZXJJZCArICcgY29ubmVjdGVkIScpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXRzW2N1cnJlbnRVc2VyLmlkXSA9IHNvY2tldDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdXNlcnMucHVzaChjdXJyZW50VXNlcik7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHdlYlNvY2tldC5lbWl0KCdVc2VyIEpvaW4nLCB7IHVzZXJJZDogY3VycmVudFVzZXIudXNlcklkIH0pO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0lORk9dIFRvdGFsIHVzZXJzOiAnICsgdXNlcnMubGVuZ3RoKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgc29ja2V0Lm9uKCdkaW5nJywgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHNvY2tldC5lbWl0KCdkb25nJyk7XG5cdCAgICAgICAgICAgICAgICB9KTtcblx0XG5cdCAgICAgICAgICAgICAgICBzb2NrZXQub24oJ2Rpc2Nvbm5lY3QnLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKGZpbmRJbmRleCh1c2VycywgY3VycmVudFVzZXIuaWQpID4gLTEpIHVzZXJzLnNwbGljZShmaW5kSW5kZXgodXNlcnMsIGN1cnJlbnRVc2VyLmlkKSwgMSk7XG5cdCAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tJTkZPXSBVc2VyICcgKyBjdXJyZW50VXNlci51c2VySWQgKyAnIGRpc2Nvbm5lY3RlZCEnKTtcblx0ICAgICAgICAgICAgICAgICAgICBzb2NrZXQuYnJvYWRjYXN0LmVtaXQoJ3VzZXJEaXNjb25uZWN0JywgeyB1c2VySWQ6IGN1cnJlbnRVc2VyLnVzZXJJZCB9KTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vQmluZCB0aGUgZXZlbnRzIGNvbnRhaW5lZCB3aXRoaW4gdGhlIHNlcnZpY2UgdG8gdGhpcyBzb2NrZXRcblx0ICAgICAgICAgICAgICAgIF90aGlzLnNlcnZpY2VzW3NlcnZpY2VJZF0uc2V0V2ViU29ja2V0RXZlbnRzKHNvY2tldCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgLypcclxuXHQgICAgICAgICAgICAgICAgc29ja2V0Lm9uKCdhY3Rpb24nLCAoZGF0YSkgPT4ge1xyXG5cdCAgICAgICAgICAgICAgICAgICAgbGV0IF9uaWNrID0gc2FuaXRpemVTdHJpbmcoZGF0YS5uaWNrKTtcclxuXHQgICAgICAgICAgICAgICAgICAgIGxldCBfbWVzc2FnZSA9IHNhbml0aXplU3RyaW5nKGRhdGEubWVzc2FnZSk7XHJcblx0ICAgICAgICAgICAgICAgICAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcblx0ICAgICAgICAgICAgICAgICAgICBsZXQgdGltZSA9IChcIjBcIiArIGRhdGUuZ2V0SG91cnMoKSkuc2xpY2UoLTIpICsgKFwiMFwiICsgZGF0ZS5nZXRNaW51dGVzKCkpLnNsaWNlKC0yKTtcclxuXHQgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tDSEFUXSBbJyArIHRpbWUgKyAnXSAnICsgX25pY2sgKyAnOiAnICsgX21lc3NhZ2UpO1xyXG5cdCAgICAgICAgICAgICAgICAgICAgc29ja2V0LmJyb2FkY2FzdC5lbWl0KCdzZXJ2ZXJTZW5kVXNlckNoYXQnLCB7bmljazogX25pY2ssIG1lc3NhZ2U6IF9tZXNzYWdlfSk7XHJcblx0ICAgICAgICAgICAgICAgIH0pOyovXG5cdCAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gaHR0cFNlcnZlci5saXN0ZW4ocG9ydCwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgTmV0d29ya1N0YWNrLmFkZFBvcnRSZXNlcnZhdGlvbihuYW1lc3BhY2UsIGxpc3RlbmVyLmFkZHJlc3MoKS5wb3J0KTtcblx0ICAgICAgICAgICAgICAgIGdsb2JhbC5Db25zb2xlLnN0YXR1cygnaW5mbycsICdXZWIgU29ja2V0IEJvdW5kIC0gU2VydmljZTogJyArIG5hbWVzcGFjZSArICcgLSAnICsgKHBvcnQgPT0gMCA/ICdSYW5kb20gJyA6ICcnKSArICdQb3J0OiAnICsgbGlzdGVuZXIuYWRkcmVzcygpLnBvcnQpO1xuXHQgICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ05ldHdvcms6X2NyZWF0ZVdlYlNvY2tldENvbXBvbmVudCcsIDIwMCwgJ0NyZWF0ZWQgbmV3IHdlYiBzb2NrZXQgY29tcG9uZW50IC0gTW91bnRlZDogJyArIG5hbWVzcGFjZSArICcgLyBTZXJ2aWNlSWQ6ICcgKyBzZXJ2aWNlSWQgKyAnIC0gbGlzdGVuaW5nIG9uICcgKyAocG9ydCA9PSAwID8gJ1JhbmRvbSAnIDogJycpICsgJ1BvcnQ6ICcgKyBsaXN0ZW5lci5hZGRyZXNzKCkucG9ydCk7XG5cdCAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHdlYlNvY2tldDtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogQ3JlYXRlcyBhIFRDUC9JUCBzb2NrZXQgbmV0d29yayBjb21wb25lbnRcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAbm90ZSBXaGVuIHRoZSBwb3J0IGlzIHNldCB0byAwIGEgcmFuZG9tIGF2YWlsYWJsZSBwb3J0IHdpbGwgYmUgYXNzaWduZWRcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge251bWJlcn0gc2VydmljZUlkIFRoZSBzZXJ2aWNlcyBpZCBmcm9tIHRoZSBzZXJ2aWNlIHN0YWNrXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZXNwYWNlIFRoZSBuYW1lc3BhY2UgZm9yIHRoZSBzZXJ2aWNlXHJcblx0ICAgICAgICAgKiBAcGFyYW0gcG9ydCBUaGUgcG9ydCBmb3IgdGhlIFRDUC9JUCBzb2NrZXQgY29tcG9uZW50XHJcblx0ICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIG9uIGNvbXBsZXRpb24gYW5kIGZhbHNlIG9uIGVycm9yXHJcblx0ICAgICAgICAgKiBAcHJpdmF0ZVxyXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ19jcmVhdGVTb2NrZXRDb21wb25lbnQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfY3JlYXRlU29ja2V0Q29tcG9uZW50KHNlcnZpY2VJZCwgbmFtZXNwYWNlLCBwb3J0KSB7XG5cdCAgICAgICAgICAgIHZhciBzZXRMaXN0ZW5lciA9IHRydWU7XG5cdCAgICAgICAgICAgIGlmICh0aGlzLmlzUG9ydFJlc2VydmVkKHBvcnQpKSB7XG5cdCAgICAgICAgICAgICAgICBzZXRMaXN0ZW5lciA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgdmFyIHBvcyA9IHRoaXMucG9ydFJlc2VydmF0aW9ucy5pbmRleE9mKHBvcnQpO1xuXHQgICAgICAgICAgICAgICAgdmFyIHNlcnZpY2VOYW1lc3BhY2UgPSB0aGlzLnBvcnRSZXNlcnZhdGlvbk5hbWVzcGFjZVtwb3NdO1xuXHQgICAgICAgICAgICAgICAgaWYgKHNlcnZpY2VOYW1lc3BhY2UgIT0gbmFtZXNwYWNlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ05ldHdvcms6X2NyZWF0ZVNvY2tldENvbXBvbmVudCcsIDQwMCwgJ1VuYWJsZSB0byBjcmVhdGUgbmV3IHNvY2tldCBjb21wb25lbnQgLSBQb3J0IFJlc2VydmVkIGJ5IGFub3RoZXIgc2VydmljZS4gQXR0ZW1wdGVkIHRvIG1vdW50OiAnICsgbmFtZXNwYWNlICsgJyAvIFNlcnZpY2VJZDogJyArIHNlcnZpY2VJZCArICcgLSBFeGlzdGluZyBzZXJ2aWNlIGFzc2lnbmVkIHRvIHBvcnQ6ICcgKyBzZXJ2aWNlTmFtZXNwYWNlLCB7IHR5cGU6IGlzUmVzdCA9PT0gZmFsc2UgPyAnaHR0cCcgOiAncmVzdCcgfSk7XG5cdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICB2YXIgc2VydmVyID0gX25ldDIuZGVmYXVsdC5jcmVhdGVTZXJ2ZXIoZnVuY3Rpb24gKHNvY2tldCkge1xuXHQgICAgICAgICAgICAgICAgLy8gJ2Nvbm5lY3Rpb24nIGxpc3RlbmVyXG5cdCAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2xpZW50IGNvbm5lY3RlZCcpO1xuXHQgICAgICAgICAgICAgICAgc29ja2V0Lm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NsaWVudCBkaXNjb25uZWN0ZWQnKTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgc29ja2V0LndyaXRlKCdoZWxsb1xcclxcbicpO1xuXHQgICAgICAgICAgICAgICAgc29ja2V0LnBpcGUoc29ja2V0KTtcblx0ICAgICAgICAgICAgfSk7XG5cdFxuXHQgICAgICAgICAgICBzZXJ2ZXIub24oJ2Vycm9yJywgZnVuY3Rpb24gKGVycikge1xuXHQgICAgICAgICAgICAgICAgLy90aHJvdyBlcnI7XG5cdCAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQSBzb2NrZXQgZXJyb3IgaGFzIG9jY3VycmVkJyk7XG5cdCAgICAgICAgICAgICAgICBnbG9iYWwuTG9nZ2VyLmxvZygnTmV0d29yazpfY3JlYXRlU29ja2V0Q29tcG9uZW50JywgNDAwLCAnQSBzb2NrZXQgZXJyb3IgaGFzIG9jY3VycmVkIGluIFNlcnZpY2U6ICcgKyBuYW1lcHNhY2UgKyAnIC0gU2VydmljZSBJZDogJyArIHNlcnZpY2VJZCk7XG5cdCAgICAgICAgICAgIH0pO1xuXHRcblx0ICAgICAgICAgICAgaWYgKHNldExpc3RlbmVyKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgbGlzdGVuZXIgPSBzZXJ2ZXIubGlzdGVuKHBvcnQsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgICAgICBOZXR3b3JrU3RhY2suYWRkUG9ydFJlc2VydmF0aW9uKG5hbWVzcGFjZSwgbGlzdGVuZXIuYWRkcmVzcygpLnBvcnQpO1xuXHQgICAgICAgICAgICAgICAgICAgIGdsb2JhbC5Db25zb2xlLnN0YXR1cygnaW5mbycsICdUQ1AvSVAgU29ja2V0IEJvdW5kIC0gU2VydmljZTogJyArIG5hbWVzcGFjZSArICcgLSAnICsgKHBvcnQgPT0gMCA/ICdSYW5kb20gJyA6ICcnKSArICdQb3J0OiAnICsgbGlzdGVuZXIuYWRkcmVzcygpLnBvcnQpO1xuXHQgICAgICAgICAgICAgICAgICAgIGdsb2JhbC5Mb2dnZXIubG9nKCdOZXR3b3JrOl9jcmVhdGVTb2NrZXRDb21wb25lbnQnLCAyMDAsICdDcmVhdGVkIG5ldyBUQ1AvSVAgc29ja2V0IGNvbXBvbmVudCAtIE1vdW50ZWQ6ICcgKyBuYW1lc3BhY2UgKyAnIC8gU2VydmljZUlkOiAnICsgc2VydmljZUlkICsgJyAtIGxpc3RlbmluZyBvbiAnICsgKHBvcnQgPT0gMCA/ICdSYW5kb20gJyA6ICcnKSArICdQb3J0OiAnICsgbGlzdGVuZXIuYWRkcmVzcygpLnBvcnQpO1xuXHQgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgcmV0dXJuIHNlcnZlcjtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogQ3JlYXRlIGFuIEFQSSBleHRlbnNpb24gY29tcG9uZW50XHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHNlcnZpY2VJZCBUaGUgc2VydmljZXMgaWQgZnJvbSB0aGUgc2VydmljZSBzdGFja1xyXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIGZvciB0aGUgc2VydmljZVxyXG5cdCAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uIGFuZCBmYWxzZSBvbiBlcnJvclxyXG5cdCAgICAgICAgICogQHByaXZhdGVcclxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdfY3JlYXRlQXBpQ29tcG9uZW50Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZUFwaUNvbXBvbmVudChzZXJ2aWNlSWQsIG5hbWVzcGFjZSkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy5hcGkuYWRkQXBpTm9kZShzZXJ2aWNlSWQsIG5hbWVzcGFjZSwgdGhpcy5zZXJ2aWNlc1tzZXJ2aWNlSWRdLmFwaVJlcXVlc3QpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBSZW1vdmVzIGEgc2VydmljZSBuZXR3b3JrIGNvbXBvbmVudFxyXG5cdCAgICAgICAgICpcclxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlTmFtZXNwYWNlIFRoZSBzZXJ2aWNlIG5hbWVzcGFjZSBmb3IgdGhlIGNvbXBvbmVudFxyXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVGhlIG5ldHdvcmsgY29tcG9uZW50IHR5cGVcclxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYWJlbCBUaGUgbGFiZWwgZm9yIHRoZSBjb21wb25lbnRcclxuXHQgICAgICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uIGFuZCBmYWxzZSBvbiBmYWlsdXJlXHJcblx0ICAgICAgICAgKiBAdG9kbyBOZWVkIHRvIGNvbXBsZXRlIHRoaXNcclxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZW1vdmUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoc2VydmljZU5hbWVzcGFjZSwgdHlwZSwgbGFiZWwpIHt9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogQ2hlY2tzIGlmIHRoZSBwb3J0IGlzIHJlc2VydmVkXHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHBvcnQgVGhlIHBvcnQgbnVtYmVyXHJcblx0ICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIGlmIHRoZSBwb3J0IGlzIHJlc2VydmVkIGZhbHNlIGlmIGl0IGlzIG5vdFxyXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2lzUG9ydFJlc2VydmVkJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNQb3J0UmVzZXJ2ZWQocG9ydCkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy5wb3J0UmVzZXJ2YXRpb25zLmluZGV4T2YocG9ydCkgPiAtMTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogQWRkcyBhIHBvcnQgcmVzZXJ2YXRpb24gdG8gdGhlIG5ldHdvcmsgc3RhY2tcclxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lc3BhY2UgVGhlIHNlcnZpY2UgbmFtZXNwYWNlIGZvciB0aGUgcmVzZXJ2ZWQgcG9ydFxyXG5cdCAgICAgICAgICogQHBhcmFtIHtudW1iZXJ9IHBvcnQgVGhlIHBvcnQgbnVtYmVyXHJcblx0ICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIG9uIGNvbXBsZXRpb25cclxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdhZGRQb3J0UmVzZXJ2YXRpb24nLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRQb3J0UmVzZXJ2YXRpb24obmFtZXNwYWNlLCBwb3J0KSB7XG5cdCAgICAgICAgICAgIHRoaXMucG9ydFJlc2VydmF0aW9ucy5wdXNoKHBvcnQpO1xuXHQgICAgICAgICAgICB0aGlzLnBvcnRSZXNlcnZhdGlvbk5hbWVzcGFjZS5wdXNoKG5hbWVzcGFjZSk7XG5cdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gTmV0d29yaztcblx0fSgpO1xuXHRcblx0LypcclxuXHQgKiBFeHBvcnRzXHJcblx0ICovXG5cdFxuXHQvKipcclxuXHQgKiBUaGUgbmV0d29yayBzdGFjayBzaW5nbGV0b24gaW5zdGFuY2VcclxuXHQgKiBAdHlwZSB7TmV0d29ya31cclxuXHQgKi9cblx0XG5cdFxuXHR2YXIgTmV0d29ya1N0YWNrID0gbmV3IE5ldHdvcmsoKTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IE5ldHdvcmtTdGFjaztcblxuLyoqKi8gfSxcbi8qIDggKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImxvZGFzaFwiKTtcblxuLyoqKi8gfSxcbi8qIDkgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuTWlkZGxld2FyZSA9IHVuZGVmaW5lZDtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qKlxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBHb3Jnb24gdGhlIHNjcmlwdGluZyBjYXBhYmxlIG5ldHdvcmsgc2VydmVyIGZvciBOb2RlIEpTXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBwYWNrYWdlIEdvcmdvblxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIFJ5YW4gUmVudGZyb1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAbGljZW5zZSBNSVRcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQHVybCBodHRwczovL2dpdGh1Yi5jb20vbWFudWZhY3R1cmluZy1pbmR1c3RyeVxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblx0XG5cdHZhciBfbG9kYXNoID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTtcblx0XG5cdHZhciBfbG9kYXNoMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZGFzaCk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdC8qKlxyXG5cdCAqIFRoZSBtaWRkbGV3YXJlIGNsYXNzXHJcblx0ICpcclxuXHQgKiBNYW5hZ2VzIG1pZGRsZXdhcmUgZm9yIHRoZSBzeXN0ZW0gZm9yIHNwZWNpZmljIHN5c3RlbSBpbnRlcmFjdGlvbnNcclxuXHQgKlxyXG5cdCAqIEBub3RlIE1pZGRsZXdhcmUgYXJlIGxpbWl0ZWQgdG8gMSBtaWRkbGV3YXJlIGFzc2lnbmVkIHRvIGEgY2hhbm5lbC0+c2VydmljZSBuYW1lc3BhY2UtPm1pZGRsZXdhcmVcclxuXHQgKiBAbm90ZSBUaGlzIG1lYW5zIHRoYXQgeW91IGhhdmUgMSBtZXRob2QgYXNzaWduYWJsZSB0byBhIGNoYW5uZWwgcGVyIHNlcnZpY2UgcGVyIG1pZGRsZXdhcmVcclxuXHQgKi9cblx0dmFyIE1pZGRsZXdhcmUgPSBleHBvcnRzLk1pZGRsZXdhcmUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBNaWRkbGV3YXJlKCkge1xuXHQgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNaWRkbGV3YXJlKTtcblx0XG5cdCAgICAgICAgdGhpcy5kYXRhID0gW107XG5cdCAgICAgICAgdGhpcy5zZXJ2aWNlUmVnaXN0ZXIgPSBbXTtcblx0ICAgICAgICB0aGlzLmRhdGFNYXAgPSBbXTtcblx0ICAgICAgICB0aGlzLmNoYW5uZWxzID0gWydQUkVfUkVRVUVTVCcsICdQUkVfUkVTUE9OU0UnLCAnUFJFX0FQSV9DQUxMJywgJ1BPU1RfQVBJX0NBTEwnXTtcblx0ICAgICAgICB0aGlzLmNoYW5uZWxzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgICAgIHRoaXMuZGF0YS5wdXNoKFtdKTtcblx0ICAgICAgICAgICAgdGhpcy5kYXRhTWFwLnB1c2godmFsdWUpO1xuXHQgICAgICAgIH0sIHRoaXMpO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBBZGRzIGEgbWlkZGxld2FyZSB0byB0aGUgc2VydmVyIGJhc2VkIG9uIGEgbWlkZGxld2FyZSBjaGFubmVsXHJcblx0ICAgICAqXHJcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjaGFubmVsIFRoZSBsYWJlbCBmb3IgdGhlIGNoYW5uZWxcclxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VOYW1lc3BhY2UgVGhlIHNlcnZpY2UgbmFtZXNwYWNlIGZvciB0aGUgbWlkZGxld2FyZVxyXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWlkZGxld2FyZSBUaGUgY2xhc3MgbmFtZSBvZiB0aGUgbWlkZGxld2FyZSB0byBiZSB1c2VkXHJcblx0ICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IG1ldGhvZCBUaGUgbWV0aG9kIHRvIGJlIGNhbGxlZCB3aXRoIHRoZSBvYmplY3Qgd2hlbiBhIGNoYW5uZWwgY2FsbCBpcyBtYWRlXHJcblx0ICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG5cdCAgICAgKi9cblx0XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKE1pZGRsZXdhcmUsIFt7XG5cdCAgICAgICAga2V5OiAnYWRkTWlkZGxld2FyZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZE1pZGRsZXdhcmUoY2hhbm5lbCwgc2VydmljZU5hbWVzcGFjZSwgbWlkZGxld2FyZSwgbWV0aG9kKSB7XG5cdCAgICAgICAgICAgIHZhciBwb3MgPSB0aGlzLl9nZXRDaGFubmVsSWQoY2hhbm5lbCk7XG5cdCAgICAgICAgICAgIGlmIChwb3MgPiAtMSkge1xuXHQgICAgICAgICAgICAgICAgdmFyIF9taWRkbGV3YXJlID0gdGhpcy5fZ2V0RXhpc3RpbmdNaWRkbGV3YXJlKGNoYW5uZWxbcG9zXSwgc2VydmljZU5hbWVzcGFjZSwgX21pZGRsZXdhcmUsIG1ldGhvZCk7XG5cdCAgICAgICAgICAgICAgICBpZiAoX21pZGRsZXdhcmUgPT09IGZhbHNlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFubmVsc1twb3NdLnB1c2goeyBzZXJ2aWNlOiBzZXJ2aWNlTmFtZXNwYWNlLCBtaWRkbGV3YXJlOiBfbWlkZGxld2FyZSwgbWV0aG9kOiBtZXRob2QgfSk7XG5cdCAgICAgICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ01pZGRsZXdhcmU6YWRkTWlkZGxld2FyZScsIDIwMCwgJ0EgbmV3IG1pZGRsZXdhcmUgd2FzIGFkZGVkIGZvciBTZXJ2aWNlIE5hbWVzcGFjZTogJyArIHNlcnZpY2VOYW1lc3BhY2UgKyAnIG9uIENoYW5uZWw6ICcgKyBjaGFubmVsKTtcblx0ICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ01pZGRsZXdhcmU6YWRkTWlkZGxld2FyZScsIDMwMCwgJ0F0dGVtcHRlZCB0byBhZGQgZHVwbGljYXRlIG1pZGRsZXdhcmUgZm9yIFNlcnZpY2UgTmFtZXNwYWNlOiAnICsgc2VydmljZU5hbWVzcGFjZSArICcgb24gQ2hhbm5lbDogJyArIGNoYW5uZWwgKyAnIGZvciBtaWRkbGV3YXJlOiAnICsgX21pZGRsZXdhcmUgKyAnIHdpdGggbWV0aG9kOiAnICsgbWV0aG9kKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICBnbG9iYWwuTG9nZ2VyLmxvZygnTWlkZGxld2FyZTphZGRNaWRkbGV3YXJlJywgNDAwLCAnQXR0ZW1wdGVkIHRvIGFkZCBhIG1pZGRsZXdhcmUgZm9yIG5vbi1leGlzdGVudCBjaGFubmVsOiAnICsgY2hhbm5lbCArICcgLSBmb3IgU2VydmljZSBOYW1lc3BhY2U6ICcgKyBzZXJ2aWNlTmFtZXNwYWNlKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogUmVtb3ZlcyBhIHJlZ2lzdGVyZWQgbWlkZGxld2FyZSBmcm9tIHRoZSBzZXJ2ZXJcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2hhbm5lbFxyXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VOYW1lc3BhY2VcclxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtaWRkbGV3YXJlXHJcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVtb3ZlTWlkZGxld2FyZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZU1pZGRsZXdhcmUoY2hhbm5lbCwgc2VydmljZU5hbWVzcGFjZSwgbWlkZGxld2FyZSkge1xuXHQgICAgICAgICAgICB2YXIgcG9zID0gdGhpcy5fZ2V0Q2hhbm5lbElkKGNoYW5uZWwpO1xuXHQgICAgICAgICAgICBpZiAocG9zID4gLTEpIHtcblx0ICAgICAgICAgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICAgICAgICAgKiBAdG9kbyBBZGQgUmVtb3ZlIG1pZGRsZXdhcmUgY29kZVxyXG5cdCAgICAgICAgICAgICAgICAgKi9cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgLyoqXHJcblx0ICAgICAgICAgKiBDYWxscyBhIGNoYW5uZWxzIGFzc2lnbmVkIG1pZGRsZXdhcmUgd2l0aCB0aGUgZGF0YSBhbmQgcmV0dXJucyB0aGUgZGF0YVxyXG5cdCAgICAgICAgICpcclxuXHQgICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjaGFubmVsIFRoZSBuYW1lIG9mIHRoZSBjaGFubmVsXHJcblx0ICAgICAgICAgKiBAcGFyYW0geyp9IGRhdGEgVGhlIG9iamVjdCBvciBkYXRhIHRvIGJlIHBhc3NlZCB0byB0aGUgbWlkZGxld2FyZVxyXG5cdCAgICAgICAgICogQHJldHVybnMgeyp8Ym9vbGVhbn0gUmV0dXJucyB0aGUgZGF0YSBmcm9tIHRoZSBtaWRkbGV3YXJlIGNhbGwgZm9yIHRoZSBkYXRhIHNlbnRcclxuXHQgICAgICAgICAqL1xuXHRcblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdjYWxsQ2hhbm5lbCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNhbGxDaGFubmVsKGNoYW5uZWwsIGRhdGEpIHtcblx0ICAgICAgICAgICAgdmFyIHBvcyA9IHRoaXMuX2dldENoYW5uZWxJZChjaGFubmVsKTtcblx0ICAgICAgICAgICAgaWYgKHBvcyA+IC0xKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgbWlkZGxld2FyZUxpc3QgPSB0aGlzLmNoYW5uZWxzW3Bvc107XG5cdCAgICAgICAgICAgICAgICBpZiAobWlkZGxld2FyZUxpc3QgaW5zdGFuY2VvZiBBcnJheSkge1xuXHQgICAgICAgICAgICAgICAgICAgIG1pZGRsZXdhcmVMaXN0LmZvcmVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSB2YWx1ZS5tZXRob2QoZGF0YSk7XG5cdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0gZWxzZSBnbG9iYWwuTG9nZ2VyLmxvZygnTWlkZGxld2FyZTpjYWxsQ2hhbm5lbCcsIDQwMCwgJ0F0dGVtcHRlZCB0byBjYWxsIGEgbm9uLWV4aXN0ZW50IGNoYW5uZWw6ICcgKyBjaGFubmVsICsgJyAtIGZvciBTZXJ2aWNlIE5hbWVzcGFjZTogJyArIHNlcnZpY2VOYW1lc3BhY2UpO1xuXHQgICAgICAgICAgICByZXR1cm4gZGF0YTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICogQ2hlY2tzIGZvciBhbiBleGlzdGluZyBtaWRkbGV3YXJlIGZvciBhIGdpdmVuIGNoYW5uZWxPYmplY3QsIHNlcnZpY2VOYW1lc3BhY2UsIGFuZCBtaWRkbGV3YXJlXHJcblx0ICAgICAgICAgKlxyXG5cdCAgICAgICAgICogQG5vdGUgVGhpcyBtZXRob2QgZW5zdXJlcyB3ZSBsb2NrIHRoZSBhc3NpZ25lZCBtaWRkbGV3YXJlIGZvciBhIGdpdmVuIGNoYW5uZWwvc2VydmljZSBuYW1lc3BhY2UvbWlkZGxld2FyZVxyXG5cdCAgICAgICAgICogQHBhcmFtIHtvYmplY3R9IGNoYW5uZWxPYmplY3QgVGhlIGNoYW5uZWwgb2JqZWN0IGZyb20gdGhlIG1pZGRsZXdhcmUgZGF0YSBzdGFja1xyXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VOYW1lc3BhY2UgVGhlIHNlcnZpY2UgbmFtZXNwYWNlIGZvciB0aGUgbWlkZGxld2FyZVxyXG5cdCAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IG1pZGRsZXdhcmUgVGhlIGNsYXNzIG5hbWUgb2YgdGhlIG1pZGRsZXdhcmUgdG8gYmUgdXNlZFxyXG5cdCAgICAgICAgICogQHJldHVybnMge2Jvb2xlYW58YXJyYXl9IFJldHVybnMgZmFsc2UgaWYgY2hhbm5lbCBkb2Vzbid0IGV4aXN0IG9yIHRoZSBjaGFubmVsIGRhdGFzIGFycmF5IGlmIGl0IGRvZXNcclxuXHQgICAgICAgICAqIEBwcml2YXRlXHJcblx0ICAgICAgICAgKi9cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnX2dldEV4aXN0aW5nTWlkZGxld2FyZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9nZXRFeGlzdGluZ01pZGRsZXdhcmUoY2hhbm5lbE9iamVjdCwgc2VydmljZU5hbWVzcGFjZSwgbWlkZGxld2FyZSkge1xuXHQgICAgICAgICAgICB2YXIgZXhpc3RpbmcgPSBfbG9kYXNoMi5kZWZhdWx0LmZpbmQoY2hhbm5lbE9iamVjdCwgeyAnc2VydmljZU5hbWVzcGFjZSc6IHNlcnZpY2VOYW1lc3BhY2UsICdtaWRkbGV3YXJlJzogbWlkZGxld2FyZSB9KTtcblx0ICAgICAgICAgICAgaWYgKGV4aXN0aW5nICE9IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgICAgICByZXR1cm4gZXhpc3Rpbmc7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICAvKipcclxuXHQgICAgICAgICAqIExvY2F0ZXMgYSBjaGFubmVsIGlkIGZyb20gdGhlIGNoYW5uZWxzIG5hbWVcclxuXHQgICAgICAgICAqXHJcblx0ICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSBUaGUgbmFtZSBvZiB0aGUgY2hhbm5lbFxyXG5cdCAgICAgICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGNoYW5uZWwgKC0xIGlmIGNoYW5uZWwgZG9lcyBub3QgZXhpc3QpXHJcblx0ICAgICAgICAgKiBAcHJpdmF0ZVxyXG5cdCAgICAgICAgICovXG5cdFxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ19nZXRDaGFubmVsSWQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0Q2hhbm5lbElkKG5hbWUpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hhbm5lbHMuaW5kZXhPZihuYW1lLnRvVXBwZXIpO1xuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gTWlkZGxld2FyZTtcblx0fSgpO1xuXHRcblx0LyoqXHJcblx0ICogRXhwb3J0IHRoZSBtaWRkbGV3YXJlIGNsYXNzIGFzIGRlZmF1bHRcclxuXHQgKi9cblx0XG5cdFxuXHRleHBvcnRzLmRlZmF1bHQgPSBNaWRkbGV3YXJlO1xuXG4vKioqLyB9LFxuLyogMTAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLkFwaSA9IHVuZGVmaW5lZDtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHR2YXIgX2xvZGFzaCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7XG5cdFxuXHR2YXIgX2xvZGFzaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2Rhc2gpO1xuXHRcblx0dmFyIF9tb21lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpO1xuXHRcblx0dmFyIF9tb21lbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbW9tZW50KTtcblx0XG5cdHZhciBfbWlkZGxld2FyZSA9IF9fd2VicGFja19yZXF1aXJlX18oOSk7XG5cdFxuXHR2YXIgX21pZGRsZXdhcmUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWlkZGxld2FyZSk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdC8qKlxyXG5cdCAqIEdvcmdvbiB0aGUgc2NyaXB0aW5nIGNhcGFibGUgbmV0d29yayBzZXJ2ZXIgZm9yIE5vZGUgSlNcclxuXHQgKlxyXG5cdCAqIEBwYWNrYWdlIEdvcmdvblxyXG5cdCAqIEBhdXRob3IgUnlhbiBSZW50ZnJvXHJcblx0ICogQGxpY2Vuc2UgTUlUXHJcblx0ICogQHVybCBodHRwczovL2dpdGh1Yi5jb20vbWFudWZhY3R1cmluZy1pbmR1c3RyeVxyXG5cdCAqL1xuXHRcblx0dmFyIGluc3RhbmNlID0gbnVsbDtcblx0XG5cdC8qKlxyXG5cdCAqIFRoZSBhcGkgY2xhc3NcclxuXHQgKlxyXG5cdCAqIEBub3RlIFRoaXMgcG93ZXJzIHRoZSBleHRlbnNpYmxlIGludGVybmFsIEFQSVxyXG5cdCAqL1xuXHR2YXIgQXBpID0gZXhwb3J0cy5BcGkgPSBmdW5jdGlvbiAoKSB7XG5cdCAgLyoqXHJcblx0ICAgKiBDb25zdHJ1Y3RzIHRoZSBjbGFzc1xyXG5cdCAgICovXG5cdCAgZnVuY3Rpb24gQXBpKCkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFwaSk7XG5cdFxuXHQgICAgaWYgKCFpbnN0YW5jZSkge1xuXHQgICAgICAvKipcclxuXHQgICAgICAgKiBUaGUgbWlkZGxld2FyZSBmb3IgdGhlIGNsYXNzXHJcblx0ICAgICAgICogQHR5cGUge01pZGRsZXdhcmV9XHJcblx0ICAgICAgICovXG5cdCAgICAgIHRoaXMubWlkZGxld2FyZSA9IG5ldyBfbWlkZGxld2FyZTIuZGVmYXVsdCgpO1xuXHRcblx0ICAgICAgLyoqXHJcblx0ICAgICAgICogQ29udGFpbnMgdGhlIGFwaSBub2RlIHJlZmVyZW5jZXNcclxuXHQgICAgICAgKiBAdHlwZSB7QXJyYXl9XHJcblx0ICAgICAgICovXG5cdCAgICAgIHRoaXMuYXBpID0gW107XG5cdFxuXHQgICAgICAvKipcclxuXHQgICAgICAgKiBDb250YWlucyB0aGUgYXBpIG5vZGUgbWFwXHJcblx0ICAgICAgICogQG5vdGUgVGhlIGFwaSBtYXAgaXMgYWxzbyB1c2VkIGZvciByZXNlcnZpbmcgYXBpIGVuZHBvaW50c1xyXG5cdCAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuXHQgICAgICAgKi9cblx0ICAgICAgdGhpcy5hcGlNYXAgPSBbXTtcblx0XG5cdCAgICAgIC8qKlxyXG5cdCAgICAgICAqIE1hcHMgdGhlIHNlcnZpY2UgaWQncyB0byB0aGUgYXBpXHJcblx0ICAgICAgICogQHR5cGUge0FycmF5fVxyXG5cdCAgICAgICAqL1xuXHQgICAgICB0aGlzLnNlcnZpY2VJZE1hcCA9IFtdO1xuXHRcblx0ICAgICAgLyoqXHJcblx0ICAgICAgICogUmVzZXJ2ZWQgd29yZHMgdGhhdCBjYW4gbm90IGJlIHJlZ2lzdGVyZWQgYXMgYXBpIGVuZHBvaW50c1xyXG5cdCAgICAgICAqIEB0eXBlIHtzdHJpbmdbXX1cclxuXHQgICAgICAgKi9cblx0ICAgICAgdGhpcy5yZXNlcnZlZCA9IFsnaW5zdGFuY2UnLCAnbWlkZGxld2FyZScsICdhcGknLCAnYXBpTWFwJywgJ3NlcnZpY2VJZE1hcCcsICdyZXNlcnZlZCcsICdhZGRBcGlOb2RlJywgJ2dldEFwaU5vZGUnLCAnX2dldE5vZGVQb3MnLCAnY2FsbEFwaU5vZGUnLCAnQXBpQ2FsbCddO1xuXHRcblx0ICAgICAgaW5zdGFuY2UgPSB0aGlzO1xuXHQgICAgfSBlbHNlIHJldHVybiBpbnN0YW5jZTtcblx0ICB9XG5cdFxuXHQgIC8qKlxyXG5cdCAgICogQWRkcyBhbiBBUEkgbm9kZSB0byB0aGUgYXBpIHN0YWNrIGFuZCBiaW5kcyBpdCB0byB0aGUgYXBpXHJcblx0ICAgKlxyXG5cdCAgICogQHBhcmFtIHtudW1iZXJ9IHNlcnZpY2VJZCBUaGUgc2VydmljZSBpZFxyXG5cdCAgICogQHBhcmFtIHtuYW1lc3BhY2V9IG5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2UgbW91bnRlZCB0byB0aGUgYXBpXHJcblx0ICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBub2RlIFRoZSBmdW5jdGlvbiByZWZlcmVuY2UgZm9yIHRoZSBub2RlXHJcblx0ICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIG9uIGNvbXBsZXRpb24gYW5kIGZhbHNlIG9uIGZhaWx1cmVcclxuXHQgICAqL1xuXHRcblx0XG5cdCAgX2NyZWF0ZUNsYXNzKEFwaSwgW3tcblx0ICAgIGtleTogJ2FkZEFwaU5vZGUnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEFwaU5vZGUoc2VydmljZUlkLCBuYW1lc3BhY2UsIG5vZGUpIHtcblx0ICAgICAgaWYgKHRoaXMuX2dldE5vZGVQb3MobmFtZXNwYWNlKSA9PT0gZmFsc2UgJiYgdGhpcy5faXNSZXNlcnZlZE5hbWVzcGFjZShuYW1lc3BhY2UpID09PSBmYWxzZSkge1xuXHQgICAgICAgIHRoaXMuYXBpLnB1c2gobm9kZSk7XG5cdCAgICAgICAgdGhpcy5hcGlNYXAucHVzaChuYW1lc3BhY2UpO1xuXHQgICAgICAgIHRoaXMuc2VydmljZUlkTWFwLnB1c2goc2VydmljZUlkKTtcblx0ICAgICAgICB2YXIgcG9zID0gdGhpcy5hcGkubGVuZ3RoIC0gMTtcblx0ICAgICAgICB0aGlzW25hbWVzcGFjZV0gPSB0aGlzLmFwaVtwb3NdO1xuXHQgICAgICAgIGdsb2JhbC5Mb2dnZXIubG9nKCdBcGk6YWRkQXBpTm9kZScsIDIwMCwgJ0FkZGVkIGEgbmV3IEFQSSBub2RlIGZvciBTZXJ2aWNlIE5hbWVzcGFjZTogJyArIG5hbWVzcGFjZSk7XG5cdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIGlmICh0aGlzLl9nZXROb2RlUG9zKG5hbWVzcGFjZSkgIT09IGZhbHNlKSBnbG9iYWwuTG9nZ2VyLmxvZygnQXBpOmFkZEFwaU5vZGUnLCA0MDAsICdVbmFibGUgdG8gY3JlYXRlIG5ldyBhcGkgbm9kZS4gQSBub2RlIGJ5IGZvciB0aGlzIHNlcnZpY2UgbmFtZXNwYWNlIGFscmVhZHkgZXhpc3RzIC0gU2VydmljZSBOYW1lc3BhY2U6ICcgKyBuYW1lc3BhY2UpO2Vsc2UgZ2xvYmFsLkxvZ2dlci5sb2coJ0FwaTphZGRBcGlOb2RlJywgNDAwLCAnVW5hYmxlIHRvIGNyZWF0ZSBuZXcgYXBpIG5vZGUuIFRoaXMgbmFtZXNwYWNlIGlzIHJlc2VydmVkIC0gU2VydmljZSBOYW1lc3BhY2U6ICcgKyBuYW1lc3BhY2UpO1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXHJcblx0ICAgICAqIFJldHVybnMgYW4gYXBpIG5vZGUgZnJvbSB0aGUgc3RhY2tcclxuXHQgICAgICpcclxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2UgdG8gbG9jYXRlXHJcblx0ICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBhcGkgbm9kZSB3aGVuIGZvdW5kIG9yIGZhbHNlIHdoZW4gbm8gbm9kZSB3YXMgZm91bmRcclxuXHQgICAgICovXG5cdFxuXHQgIH0sIHtcblx0ICAgIGtleTogJ2dldEFwaU5vZGUnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFwaU5vZGUobmFtZXNwYWNlKSB7XG5cdCAgICAgIHZhciBwb3MgPSB0aGlzLl9nZXROb2RlUG9zKG5hbWVzcGFjZSk7XG5cdCAgICAgIGlmIChwb3MgPiAtMSkgcmV0dXJuIHRoaXMuYXBpW3Bvc107XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcclxuXHQgICAgICogQ3JlYXRlcyBhbiBBcGlDYWxsIGluc3RhbmNlIGFuZCBleGVjdXRlcyBpdCAtIHRoZW4gcmV0dXJucyB0aGUgQXBpQ2FsbCBpbnN0YW5jZSBpZiB0aGUgY2FsbCBjb21wbGV0ZWRcclxuXHQgICAgICpcclxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2UgdG8gYmUgY2FsbGVkXHJcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtZXRob2QgVGhlIG1ldGhvZCB0byBiZSBjYWxsZWRcclxuXHQgICAgICogQHBhcmFtIHsqfSBkYXRhIFRoZSBkYXRhIHRvIGJlIHNlbnQgdG8gdGhlIGNhbGxcclxuXHQgICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHJlc3VsdCBvZiB0aGUgY2FsbCBvciBmYWxzZSBpZiB0aGUgbm9kZSBkaWQgbm90IGV4aXN0XHJcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdjYWxsQXBpTm9kZScsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gY2FsbEFwaU5vZGUobmFtZXNwYWNlLCBtZXRob2QsIGRhdGEpIHtcblx0ICAgICAgbm9kZSA9IHRoaXMuZ2V0QXBpTm9kZShuYW1lc3BhY2UpO1xuXHQgICAgICBpZiAobm9kZSAhPT0gZmFsc2UpIHtcblx0ICAgICAgICB2YXIgYXBpQ2FsbCA9IG5ldyBBcGlDYWxsKG1ldGhvZCwgZGF0YSk7XG5cdCAgICAgICAgdGhpcy5taWRkbGV3YXJlLmNhbGxDaGFubmVsKCdQUkVfQVBJX0NBTEwnLCBhcGlDYWxsKTtcblx0ICAgICAgICBkYXRhID0gYXBpQ2FsbC5jYWxsQXBpKG5vZGUsIG1laG9kKTtcblx0ICAgICAgICB0aGlzLm1pZGRsZXdhcmUuY2FsbENoYW5uZWwoJ1BPU1RfQVBJX0NBTEwnLCBkYXRhKTtcblx0ICAgICAgICBkYXRhLnJldHVybmVkID0gKDAsIF9tb21lbnQyLmRlZmF1bHQpKCk7XG5cdCAgICAgICAgcmV0dXJuIGRhdGE7XG5cdCAgICAgIH1cblx0ICAgICAgdGhpcy5Mb2dnZXIubG9nKCdBcGk6Y2FsbEFwaU5vZGUnLCA0MDAsICdGYWlsZWQgdG8gY2FsbCBub2RlIHNlcnZpY2Ugd2l0aCBuYW1lc3BhY2U6ICcgKyBuYW1lc3BhY2UgKyAnIC0gbm8gYXBpIG5vZGUgZXhpc3RzIGZvciB0aGlzIG5hbWVzcGFjZS4nKTtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBSZXR1cm5zIHRoZSBwb3NpdGlvbiBvZiB0aGUgbm9kZSBieSBpdHMgbmFtZXNwYWNlXHJcblx0ICAgICAqXHJcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lc3BhY2UgVGhlIHNlcnZpY2UgbmFtZXNwYWNlIHRvIGJlIHJldHJpZXZlZFxyXG5cdCAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbnxudW1iZXJ9IFJldHVybnMgZmFsc2UgaWYgbm90IGZvdW5kIG9yIHRoZSBwb3NpdGlvbiBvZiB0aGUgc2VydmljZSBuYW1lc3BhY2UgaW4gdGhlIHN0YWNrXHJcblx0ICAgICAqIEBwcml2YXRlXHJcblx0ICAgICAqL1xuXHRcblx0ICB9LCB7XG5cdCAgICBrZXk6ICdfZ2V0Tm9kZVBvcycsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gX2dldE5vZGVQb3MobmFtZXNwYWNlKSB7XG5cdCAgICAgIHZhciBwb3MgPSB0aGlzLmFwaU1hcC5pbmRleE9mKG5hbWVzcGFjZSk7XG5cdCAgICAgIGlmIChwb3MgPT0gLTEpIHJldHVybiBmYWxzZTtcblx0ICAgICAgcmV0dXJuIHRoaXMuYXBpTWFwW3Bvc107XG5cdCAgICB9XG5cdFxuXHQgICAgLyoqXHJcblx0ICAgICAqIENoZWNrIGlmIHRoZSBuYW1lc3BhY2UgaXMgcmVzZXJ2ZWQgYnkgdGhlIG9iamVjdFxyXG5cdCAgICAgKlxyXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZXNwYWNlIFRoZSBzZXJ2aWNlIG5hbWVzcGFjZSB0byBiZSBjaGVja2VkXHJcblx0ICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRydWUgaWYgdGhlIG5hbWVzcGFjZSBleGlzdHMgZmFsc2UgaWYgaXQgZG9lc24ndFxyXG5cdCAgICAgKiBAcHJpdmF0ZVxyXG5cdCAgICAgKi9cblx0XG5cdCAgfSwge1xuXHQgICAga2V5OiAnX2lzUmVzZXJ2ZWROYW1lc3BhY2UnLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIF9pc1Jlc2VydmVkTmFtZXNwYWNlKG5hbWVzcGFjZSkge1xuXHQgICAgICByZXR1cm4gdGhpcy5yZXNlcnZlZC5pbmRleE9mKG5hbWVzcGFjZSkgPiAtMTtcblx0ICAgIH1cblx0ICB9XSk7XG5cdFxuXHQgIHJldHVybiBBcGk7XG5cdH0oKTtcblx0XG5cdC8qKlxyXG5cdCAqIFRoaXMgQVBJIGNhbGwgY2xhc3NcclxuXHQgKlxyXG5cdCAqIEBub3RlIFRoaXMgaXMgdGhlIHBhY2thZ2VkIGNhbGwgYW5kIGl0cyByZWxhdGVkIGRhdGFcclxuXHQgKi9cblx0XG5cdFxuXHR2YXIgQXBpQ2FsbCA9IGZ1bmN0aW9uICgpIHtcblx0ICAvKipcclxuXHQgICAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcblx0ICAgKi9cblx0ICBmdW5jdGlvbiBBcGlDYWxsKG1ldGhvZCwgZGF0YSkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFwaUNhbGwpO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgbWV0aG9kIHRvIGJlIGNhbGxlZFxyXG5cdCAgICAgKiBAdmFyIHtmdW5jdGlvbn1cclxuXHQgICAgICovXG5cdCAgICB0aGlzLm1ldGhvZCA9IG1ldGhvZDtcblx0XG5cdCAgICAvKipcclxuXHQgICAgICogQSBmbGFnIHRoYXQgY29udHJvbHMgaWYgdGhlIGNhbGwgcmVzdWx0ZWQgaW4gYW4gZXJyb3JcclxuXHQgICAgICogQHR5cGUge2Jvb2xlYW59XHJcblx0ICAgICAqL1xuXHQgICAgdGhpcy5lcnJvciA9IGZhbHNlO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgZXJyb3JzIHRoYXQgb2NjdXJyZWQgZHVyaW5nIHRoZSBjYWxsXHJcblx0ICAgICAqIEB0eXBlIHtBcnJheX1cclxuXHQgICAgICovXG5cdCAgICB0aGlzLmVycm9ycyA9IFtdO1xuXHRcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBUaGUgZGF0YSBmb3IgdGhlIGNhbGxcclxuXHQgICAgICogQHR5cGUgeyp9XHJcblx0ICAgICAqL1xuXHQgICAgdGhpcy5kYXRhID0gZGF0YTtcblx0XG5cdCAgICAvKipcclxuXHQgICAgICogVGhlIHRpbWUgdGhlIEFQSSBjYWxsIHdhcyBjcmVhdGVkXHJcblx0ICAgICAqIEB0eXBlIHttb21lbnR9XHJcblx0ICAgICAqL1xuXHQgICAgdGhpcy5jcmVhdGVkID0gKDAsIF9tb21lbnQyLmRlZmF1bHQpKCk7XG5cdFxuXHQgICAgLyoqXHJcblx0ICAgICAqIFRoZSB0aW1lIHRoZSBBUEkgY2FsbCB3YXMgdXBkYXRlZFxyXG5cdCAgICAgKiBAdHlwZSB7bW9tZW50fVxyXG5cdCAgICAgKi9cblx0ICAgIHRoaXMudXBkYXRlZCA9IG51bGw7XG5cdFxuXHQgICAgLyoqXHJcblx0ICAgICAqIFRoZSB0aW1lIHRoZSBBUEkgY2FsbCB3YXMgcmV0dXJuZWRcclxuXHQgICAgICogQHR5cGUge21vbWVudH1cclxuXHQgICAgICovXG5cdCAgICB0aGlzLnJldHVybmVkID0gbnVsbDtcblx0ICB9XG5cdFxuXHQgIC8qKlxyXG5cdCAgICogQ2FsbHMgdGhlIGFwaSBmb3IgdGhlIGNhbGxcclxuXHQgICAqXHJcblx0ICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBub2RlIFRoZSBub2RlIHRvIHRiZSBjYWxsZWRcclxuXHQgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBBcGlDYWxsIG9iamVjdFxyXG5cdCAgICovXG5cdFxuXHRcblx0ICBfY3JlYXRlQ2xhc3MoQXBpQ2FsbCwgW3tcblx0ICAgIGtleTogJ2NhbGxBcGknLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGNhbGxBcGkobm9kZSkge1xuXHQgICAgICBub2RlKHRoaXMpO1xuXHQgICAgICB0aGlzLnVwZGF0ZWQgPSAoMCwgX21vbWVudDIuZGVmYXVsdCkoKTtcblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9XG5cdCAgfV0pO1xuXG5cdCAgcmV0dXJuIEFwaUNhbGw7XG5cdH0oKTtcblxuLyoqKi8gfSxcbi8qIDExICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJuZXRcIik7XG5cbi8qKiovIH0sXG4vKiAxMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiaHR0cFwiKTtcblxuLyoqKi8gfSxcbi8qIDEzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJzb2NrZXQuaW9cIik7XG5cbi8qKiovIH0sXG4vKiAxNCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiY29tcHJlc3Npb25cIik7XG5cbi8qKiovIH0sXG4vKiAxNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiZXhwcmVzc1wiKTtcblxuLyoqKi8gfSxcbi8qIDE2ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLkxvZ2dlciA9IHVuZGVmaW5lZDtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qKlxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBHb3Jnb24gdGhlIHNjcmlwdGluZyBjYXBhYmxlIG5ldHdvcmsgc2VydmVyIGZvciBOb2RlIEpTXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBwYWNrYWdlIEdvcmdvblxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIFJ5YW4gUmVudGZyb1xyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAbGljZW5zZSBNSVRcclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQHVybCBodHRwczovL2dpdGh1Yi5jb20vbWFudWZhY3R1cmluZy1pbmR1c3RyeVxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblx0XG5cdC8qXHJcblx0ICogSW1wb3J0c1xyXG5cdCAqL1xuXHRcblx0XG5cdHZhciBfZnMgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3KTtcblx0XG5cdHZhciBmcyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9mcyk7XG5cdFxuXHR2YXIgX21vbWVudCA9IF9fd2VicGFja19yZXF1aXJlX18oNik7XG5cdFxuXHR2YXIgX21vbWVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tb21lbnQpO1xuXHRcblx0dmFyIF9vcyA9IF9fd2VicGFja19yZXF1aXJlX18oMTgpO1xuXHRcblx0dmFyIG9zID0gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoX29zKTtcblx0XG5cdHZhciBfY29uZmlnID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBfc2FuaXRpemVGaWxlbmFtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTkpO1xuXHRcblx0dmFyIF9zYW5pdGl6ZUZpbGVuYW1lMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Nhbml0aXplRmlsZW5hbWUpO1xuXHRcblx0ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKG9iaikgeyBpZiAob2JqICYmIG9iai5fX2VzTW9kdWxlKSB7IHJldHVybiBvYmo7IH0gZWxzZSB7IHZhciBuZXdPYmogPSB7fTsgaWYgKG9iaiAhPSBudWxsKSB7IGZvciAodmFyIGtleSBpbiBvYmopIHsgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIG5ld09ialtrZXldID0gb2JqW2tleV07IH0gfSBuZXdPYmouZGVmYXVsdCA9IG9iajsgcmV0dXJuIG5ld09iajsgfSB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0LyoqXHJcblx0ICogVGhlIHNlcnZlciBsb2dnaW5nIGNsYXNzXHJcblx0ICovXG5cdHZhciBMb2dnZXIgPSBleHBvcnRzLkxvZ2dlciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIC8qKlxyXG5cdCAgICAgKiBDb25zdHJ1Y3RzIHRoZSBjbGFzc1xyXG5cdCAgICAgKi9cblx0ICAgIGZ1bmN0aW9uIExvZ2dlcigpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTG9nZ2VyKTtcblx0XG5cdCAgICAgICAgdGhpcy5mcyA9IGZzO1xuXHQgICAgICAgIHRoaXMuR29yZ29uQ29uZmlnID0gbmV3IF9jb25maWcuR29yZ29uQ29uZmlnKCk7XG5cdCAgICAgICAgdGhpcy5zYW5pdGl6ZSA9IF9zYW5pdGl6ZUZpbGVuYW1lMi5kZWZhdWx0O1xuXHQgICAgICAgIHRoaXMudG9waWNNYXAgPSBbXTtcblx0ICAgICAgICB0aGlzLnN1YnNjcmliZXJzID0gW107XG5cdCAgICAgICAgdGhpcy5zdWJzY3JpYmVyTWFwID0gW107XG5cdCAgICAgICAgdGhpcy5sZXZlbCA9IFsnRGVidWcnLCAnSW5mbycsICdXYXJuJywgJ0Vycm9yJywgJ0NyaXRpY2FsJywgJ0ZhdGFsJ107XG5cdCAgICAgICAgdGhpcy5sZXZlbEtleSA9IFsxMDAsIDIwMCwgMzAwLCA0MDAsIDUwMCwgNjAwXTtcblx0ICAgIH1cblx0XG5cdCAgICAvKipcclxuXHQgICAgICogQ3JlYXRlcyBhIG5ldyBsb2cgYW5kIHdyaXRlcyBpdCB0byB0aGUgY29ycmVzcG9uZGluZyBmaWxlXHJcblx0ICAgICAqXHJcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsb2NhdGlvbiBUaGUgbG9jYXRpb24gdGhlIGxvZyBvcmlnaW5hdGVkIGZyb21cclxuXHQgICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsIFRoZSBsZXZlbCBvZiB0aGUgbG9nIChmcm9tIGxldmVsS2V5KVxyXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBUaGUgbWVzc2FnZSBmb3IgdGhlIGxvZ1xyXG5cdCAgICAgKiBAcGFyYW0geyp9IHZhbHVlcyBUaGUgdmFsdWVzIHRvIGluY2x1ZGUgd2l0aCB0aGUgbG9nXHJcblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFRoZSB0eXBlIGZvciB0aGUgbG9nXHJcblx0ICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uIGFuZCBmYWxzZSBvbiBmYWlsdXJlXHJcblx0ICAgICAqL1xuXHRcblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoTG9nZ2VyLCBbe1xuXHQgICAgICAgIGtleTogJ2xvZycsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvZyhsb2NhdGlvbiwgbGV2ZWwsIG1lc3NhZ2UsIHZhbHVlcywgdHlwZSkge1xuXHQgICAgICAgICAgICB2YXIgbG9nSXRlbSA9IG5ldyBMb2cobG9jYXRpb24sIGxldmVsLCBtZXNzYWdlLCB2YWx1ZXMsIHR5cGUpO1xuXHQgICAgICAgICAgICB2YXIgbG9nVmFsdWVzID0gbG9nSXRlbS52YWx1ZXMgPT0gbnVsbCB8fCBsb2dJdGVtLnZhbHVlcyA9PSB1bmRlZmluZWQgPyBudWxsIDogSlNPTi5zdHJpbmdpZnkobG9nSXRlbS52YWx1ZXMpO1xuXHQgICAgICAgICAgICB2YXIgZmlsZW5hbWUgPSBsb2dJdGVtLmNyZWF0ZWQuZm9ybWF0KCdZWVlZTU1ERCcpICsgJy5sb2cnO1xuXHRcblx0ICAgICAgICAgICAgc3dpdGNoIChsb2dJdGVtLnR5cGUpIHtcblx0ICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG5cdCAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUgPSB0aGlzLnNhbml0aXplKGxvZ0l0ZW0udHlwZSkgKyAnLScgKyBmaWxlbmFtZTtcblx0ICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgIGNhc2UgdW5kZWZpbmVkOlxuXHQgICAgICAgICAgICAgICAgY2FzZSB0cnVlOlxuXHQgICAgICAgICAgICAgICAgY2FzZSAnc3lzJzpcblx0ICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSA9ICdzeXMtJyArIGZpbGVuYW1lO1xuXHQgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgY2FzZSAnZXJyb3InOlxuXHQgICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gJ2Vycm9yLScgKyBmaWxlbmFtZTtcblx0ICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgdmFyIGxvZ0VudHJ5ID0gbG9nSXRlbS5jcmVhdGVkLmZvcm1hdCgpICsgJyAnICsgbG9nSXRlbS5sZXZlbCArICcgJyArIGxvZ0l0ZW0ubG9jYXRpb24gKyAnIFttZXNzYWdlPScgKyBsb2dJdGVtLm1lc3NhZ2UgKyAnXScgKyAnIFt2YWx1ZXM9JyArIGxvZ1ZhbHVlcyArICddJyArIG9zLkVPTDtcblx0XG5cdCAgICAgICAgICAgIGlmICghdGhpcy5mcy5leGlzdHNTeW5jKHRoaXMuR29yZ29uQ29uZmlnLnN0b3JhZ2UubG9ncykpIHtcblx0ICAgICAgICAgICAgICAgIGZzLm1rZGlyU3luYyh0aGlzLkdvcmdvbkNvbmZpZy5zdG9yYWdlLmxvZ3MpO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICB0aGlzLmZzLmFwcGVuZEZpbGUodGhpcy5Hb3Jnb25Db25maWcuc3RvcmFnZS5sb2dzICsgZmlsZW5hbWUsIGxvZ0VudHJ5LCAndXRmOCcsIGZ1bmN0aW9uIChlcnIpIHtcblx0ICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcblx0ICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG5cdCAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBMb2dnZXI7XG5cdH0oKTtcblx0XG5cdC8qKlxyXG5cdCAqIFRoZSBzZXJ2ZXIgbG9nIGNsYXNzXHJcblx0ICovXG5cdFxuXHRcblx0dmFyIExvZyA9XG5cdC8qKlxyXG5cdCAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcblx0ICpcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gbG9jYXRpb24gVGhlIGxvY2F0aW9uIHRoZSBsb2cgb3JpZ2luYXRlZCBmcm9tXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGxldmVsIFRoZSBsZXZlbCBvZiB0aGUgbG9nIChmcm9tIGxldmVsS2V5KVxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIFRoZSBtZXNzYWdlIGZvciB0aGUgbG9nXHJcblx0ICogQHBhcmFtIHsqfSB2YWx1ZXMgVGhlIHZhbHVlcyB0byBpbmNsdWRlIHdpdGggdGhlIGxvZ1xyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFRoZSB0eXBlIGZvciB0aGUgbG9nXHJcblx0ICovXG5cdGZ1bmN0aW9uIExvZyhsb2NhdGlvbiwgbGV2ZWwsIG1lc3NhZ2UsIHZhbHVlcywgdHlwZSkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExvZyk7XG5cdFxuXHQgICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uO1xuXHQgICAgdGhpcy5sZXZlbCA9IGxldmVsID09IG51bGwgfHwgbGV2ZWwgPT0gdW5kZWZpbmVkID8gMTAwIDogbGV2ZWw7XG5cdCAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuXHQgICAgdGhpcy50eXBlID0gdHlwZSA9PSBudWxsIHx8IHR5cGUgPT0gdW5kZWZpbmVkID8gJ3N5cycgOiB0eXBlO1xuXHQgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMgPT0gbnVsbCB8fCB2YWx1ZXMgPT0gdW5kZWZpbmVkID8gbnVsbCA6IHZhbHVlcztcblx0ICAgIHRoaXMuY3JlYXRlZCA9ICgwLCBfbW9tZW50Mi5kZWZhdWx0KSgpO1xuXHR9O1xuXG4vKioqLyB9LFxuLyogMTcgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImZzXCIpO1xuXG4vKioqLyB9LFxuLyogMTggKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm9zXCIpO1xuXG4vKioqLyB9LFxuLyogMTkgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNhbml0aXplLWZpbGVuYW1lXCIpO1xuXG4vKioqLyB9LFxuLyogMjAgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNvbG9nXCIpO1xuXG4vKioqLyB9XG4vKioqKioqLyBdKVxufSk7XG47XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogZ29yZ29uLm1pbi5qc1xuICoqLyIsIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcIm1vbWVudFwiKSwgcmVxdWlyZShcImxvZGFzaFwiKSwgcmVxdWlyZShcIm5ldFwiKSwgcmVxdWlyZShcImh0dHBcIiksIHJlcXVpcmUoXCJzb2NrZXQuaW9cIiksIHJlcXVpcmUoXCJjb21wcmVzc2lvblwiKSwgcmVxdWlyZShcImV4cHJlc3NcIiksIHJlcXVpcmUoXCJmc1wiKSwgcmVxdWlyZShcIm9zXCIpLCByZXF1aXJlKFwic2FuaXRpemUtZmlsZW5hbWVcIiksIHJlcXVpcmUoXCJjb2xvZ1wiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShcImdvcmdvblwiLCBbXCJtb21lbnRcIiwgXCJsb2Rhc2hcIiwgXCJuZXRcIiwgXCJodHRwXCIsIFwic29ja2V0LmlvXCIsIFwiY29tcHJlc3Npb25cIiwgXCJleHByZXNzXCIsIFwiZnNcIiwgXCJvc1wiLCBcInNhbml0aXplLWZpbGVuYW1lXCIsIFwiY29sb2dcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiZ29yZ29uXCJdID0gZmFjdG9yeShyZXF1aXJlKFwibW9tZW50XCIpLCByZXF1aXJlKFwibG9kYXNoXCIpLCByZXF1aXJlKFwibmV0XCIpLCByZXF1aXJlKFwiaHR0cFwiKSwgcmVxdWlyZShcInNvY2tldC5pb1wiKSwgcmVxdWlyZShcImNvbXByZXNzaW9uXCIpLCByZXF1aXJlKFwiZXhwcmVzc1wiKSwgcmVxdWlyZShcImZzXCIpLCByZXF1aXJlKFwib3NcIiksIHJlcXVpcmUoXCJzYW5pdGl6ZS1maWxlbmFtZVwiKSwgcmVxdWlyZShcImNvbG9nXCIpKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJnb3Jnb25cIl0gPSBmYWN0b3J5KHJvb3RbXCJtb21lbnRcIl0sIHJvb3RbXCJsb2Rhc2hcIl0sIHJvb3RbXCJuZXRcIl0sIHJvb3RbXCJodHRwXCJdLCByb290W1wic29ja2V0LmlvXCJdLCByb290W1wiY29tcHJlc3Npb25cIl0sIHJvb3RbXCJleHByZXNzXCJdLCByb290W1wiZnNcIl0sIHJvb3RbXCJvc1wiXSwgcm9vdFtcInNhbml0aXplLWZpbGVuYW1lXCJdLCByb290W1wiY29sb2dcIl0pO1xufSkodGhpcywgZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV82X18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfOF9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzExX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMTJfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xM19fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzE0X18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMTVfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8xN19fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzE4X18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMTlfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8yMF9fKSB7XG5yZXR1cm4gXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uXG4gKiovIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL2Jvb3RzdHJhcCA2NGU2NDNjMDBmYjNmZjhhNDEyNVxuICoqLyIsIi8qKlxyXG4gKiBHb3Jnb24gdGhlIHNjcmlwdGluZyBjYXBhYmxlIG5ldHdvcmsgc2VydmVyIGZvciBOb2RlIEpTXHJcbiAqXHJcbiAqIEBwYWNrYWdlIEdvcmdvblxyXG4gKiBAYXV0aG9yIFJ5YW4gUmVudGZyb1xyXG4gKiBAbGljZW5zZSBNSVRcclxuICogQHVybCBodHRwczovL2dpdGh1Yi5jb20vbWFudWZhY3R1cmluZy1pbmR1c3RyeVxyXG4gKi9cclxuXHJcbi8qXHJcbiAqIEltcG9ydHNcclxuICovXHJcbmltcG9ydCB7R29yZ29uQ29uZmlnfSBmcm9tIFwiY29uZmlnL2NvbmZpZ1wiO1xyXG5pbXBvcnQge0dvcmdvbkVudn0gZnJvbSBcImNvbmZpZy9lbnZcIjtcclxuaW1wb3J0IHtHb3Jnb25Db250YWluZXJTZXJ2aWNlfSBmcm9tICdzZXJ2aWNlL2luZGV4JztcclxuaW1wb3J0IHtMb2dnZXJ9IGZyb20gJ2NvbXBvbmVudC9sb2cnXHJcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCdcclxuaW1wb3J0IGNvbG9nIGZyb20gJ2NvbG9nJ1xyXG5cclxuLypcclxuICogQ29uZmlndXJlIGdsb2JhbHNcclxuICovXHJcblxyXG4vKipcclxuICogVGhlIGdsb2JhbCBsb2dnZXIgY2xhc3NcclxuICpcclxuICogQHR5cGUge0xvZ2dlcn1cclxuICovXHJcbmdsb2JhbC5Mb2dnZXIgPSBuZXcgTG9nZ2VyKCk7XHJcblxyXG4vKipcclxuICogVGhlIGdsb2JhbCBjb25zb2xlIGNsYXNzXHJcbiAqXHJcbiAqIEB0eXBlIHtvYmplY3R9IFRoZSBjb2xvZyBpbnN0YW5jZVxyXG4gKi9cclxuZ2xvYmFsLkNvbnNvbGUgPSBjb2xvZztcclxuXHJcbmdsb2JhbC5Db25zb2xlLnN0YXR1cyA9ICh0eXBlLCBtZXNzYWdlKT0+XHJcbntcclxuICAgIHN3aXRjaCh0eXBlKVxyXG4gICAge1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgY2FzZSAnaW5mbyc6XHJcbiAgICAgICAgICAgIGdsb2JhbC5Db25zb2xlLmxvZygnWycgKyBnbG9iYWwuQ29uc29sZS5jb2xvcignSScsICd5ZWxsb3cnKSArICddICcgKyBtZXNzYWdlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnbm90aWNlJzpcclxuICAgICAgICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKCdbJyArIGdsb2JhbC5Db25zb2xlLmNvbG9yKCdOJywgJ2N5YW4nKSArICddICcgKyBtZXNzYWdlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnZXJyb3InOlxyXG4gICAgICAgICAgICBnbG9iYWwuQ29uc29sZS5sb2coJ1snICsgZ2xvYmFsLkNvbnNvbGUuY29sb3IoJ0UnLCAncmVkJykgKyAnXSAnICsgbWVzc2FnZSk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFRoZSBHb3Jnb24gY2xhc3NcclxuICovXHJcbmNsYXNzIEdvcmdvbiB7XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKClcclxuICAgIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgZ29yZ29uIGNvbmZpZyBmb3IgdGhlIHNlcnZlclxyXG4gICAgICAgICAqIEB0eXBlIHtHb3Jnb25Db25maWd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5Hb3Jnb25Db25maWcgPSBuZXcgR29yZ29uQ29uZmlnKCk7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBnb3Jnb24gc2VydmVyIGxvZ2dlclxyXG4gICAgICAgICAqIEB0eXBlIHtMb2dnZXJ9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5Mb2dnZXIgPSBnbG9iYWwuTG9nZ2VyO1xyXG4gICAgICAgIHRoaXMuTG9nZ2VyLmxvZygnR29yZ29uOmluaXRTZXJ2ZXInLCAyMDAsICdUaGUgR29yZ29uIGhhcyBiZWVuIHN1bW1vbmVkIC0gR09SR09OIFNFUlZFUiBTVEFSVElORy4uLicpO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgZ29yZ29uIGVudmlyb25tZW50IGZvciB0aGUgc2VydmVyXHJcbiAgICAgICAgICogQHR5cGUge0dvcmdvbkVudn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLkdvcmdvbkVudiA9IG5ldyBHb3Jnb25FbnYoKTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGNvbnRhaW5lciBzZXJ2aWNlXHJcbiAgICAgICAgICogQHR5cGUge0dvcmdvbkNvbnRhaW5lclNlcnZpY2V9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5Hb3Jnb25Db250YWluZXJTZXJ2aWNlID0gbmV3IEdvcmdvbkNvbnRhaW5lclNlcnZpY2UoKTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGZpcnN0IHN0eWxlIG9mIENMSSBzZXBhcmF0b3JcclxuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuc2VwYXJhdG9yMSA9ICc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0nO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgc2Vjb25kIHN0eWxlIG9mIENMSSBzZXBhcmF0b3JcclxuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuc2VwYXJhdG9yMiA9ICctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW5pdGlhbGl6ZXMgdGhlIHNlcnZlciBhbmQgbG9hZHMgdGhlIGNvbmZpZ3VyZWQgc2VydmljZXMgZnJvbSB0aGUgZW52aXJvbm1lbnRcclxuICAgICAqL1xyXG4gICAgaW5pdFNlcnZlcigpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fYm9vdHN0cmFwKCk7XHJcbiAgICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKHRoaXMuc2VwYXJhdG9yMik7XHJcbiAgICAgICAgZ2xvYmFsLkNvbnNvbGUucXVlc3Rpb24oJ0xvYWRpbmcgU2VydmljZXMnKTtcclxuICAgICAgICBnbG9iYWwuQ29uc29sZS5sb2codGhpcy5zZXBhcmF0b3IyKTtcclxuICAgICAgICB0aGlzLkxvZ2dlci5sb2coJ0dvcmdvbjppbml0U2VydmVyJywgMjAwLCAnVGhlIHNlcnZlciB3YXMgc3RhcnRlZCBzdWNjZXNzZnVsbHknKTtcclxuXHJcbiAgICAgICAgdGhpcy5Hb3Jnb25FbnYuc2VydmljZS5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKXtcclxuICAgICAgICAgICAgbGV0IGNvbnNvbGVXaWR0aCA9IDQ4O1xyXG4gICAgICAgICAgICBsZXQgbG9hZGVkID0gdGhpcy5Hb3Jnb25Db250YWluZXJTZXJ2aWNlLmFkZCh2YWx1ZS5zZXJ2aWNlKTtcclxuICAgICAgICAgICAgaWYgKGxvYWRlZClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbGV0IGxvZ0V4dExlbiA9IDY7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BhY2VMZW5ndGggPSBjb25zb2xlV2lkdGggLSBsb2dFeHRMZW4gLSB2YWx1ZS5uYW1lc3BhY2UubGVuZ3RoIC0gMjtcclxuICAgICAgICAgICAgICAgIGxldCBzcGFjZUNoYXIgPSBfLnJlcGVhdCgnLicsIHNwYWNlTGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuTG9nZ2VyLmxvZygnR29yZ29uOmluaXRTZXJ2ZXInLCAyMDAsICdMb2FkZWQgc2VydmljZSBuYW1lc3BhY2U6ICcgKyB2YWx1ZS5uYW1lc3BhY2UpO1xyXG4gICAgICAgICAgICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKHZhbHVlLm5hbWVzcGFjZSArJyAnICsgc3BhY2VDaGFyICsgJyBbICcgKyBnbG9iYWwuQ29uc29sZS5jb2xvcignT0snLCAnZ3JlZW4nKSArICcgXScpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV0IGxvZ0V4dExlbiA9IDEwO1xyXG4gICAgICAgICAgICAgICAgbGV0IHNwYWNlTGVuZ3RoID0gY29uc29sZVdpZHRoIC0gbG9nRXh0TGVuIC0gdmFsdWUubmFtZXNwYWNlLmxlbmd0aCAtIDI7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BhY2VDaGFyID0gXy5yZXBlYXQoJy4nLCBzcGFjZUxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLkxvZ2dlci5sb2coJ0dvcmdvbjppbml0U2VydmVyJywgNDAwLCAnRmFpbGVkIHRvIGxvYWQgc2VydmljZSB3aXRoIG5hbWVzcGFjZTogJyArIHZhbHVlLm5hbWVzcGFjZSk7XHJcbiAgICAgICAgICAgICAgICBnbG9iYWwuQ29uc29sZS5sb2codmFsdWUubmFtZXNwYWNlICsnICcgKyBzcGFjZUNoYXIgKyAnIFsgJyArIGdsb2JhbC5Db25zb2xlLmNvbG9yKCdGQUlMRUQnLCAncmVkJykgKyAnIF0nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLkxvZ2dlci5sb2coJ0dvcmdvbjppbml0U2VydmVyJywgMjAwLCAnU2VydmljZSBMb2FkaW5nIENvbXBsZXRlZCcpO1xyXG4gICAgICAgIGdsb2JhbC5Db25zb2xlLmxvZyh0aGlzLnNlcGFyYXRvcjIpO1xyXG4gICAgICAgIGdsb2JhbC5Db25zb2xlLnF1ZXN0aW9uKCdMb2FkaW5nIENvbXBsZXRlIC0gU2VydmVyIE9ubGluZScpO1xyXG4gICAgICAgIGdsb2JhbC5Db25zb2xlLmxvZyh0aGlzLnNlcGFyYXRvcjEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhlIENMSSBzZXJ2ZXIgYm9vdHN0cmFwXHJcbiAgICAgKlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgX2Jvb3RzdHJhcCgpXHJcbiAgICB7XHJcbiAgICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKGdsb2JhbC5Db25zb2xlLmNvbG9yKF9fTElCX0ZVTExfTkFNRV9fICsgJyAtIHYnICsgdGhpcy5Hb3Jnb25Db25maWcuZGF0YS52ZXJzaW9uLCAnZ3JlZW4nKSk7XHJcbiAgICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKCdBdXRob3I6IFJ5YW4gUmVudGZybyA8cnJlbnRmcm8gYXQgZ21haWwgZG90IGNvbT4nKTtcclxuICAgICAgICBnbG9iYWwuQ29uc29sZS5sb2coJ1Byb2plY3Q6IGh0dHBzOi8vZ2l0aHViLmNvbS9tYW51ZmFjdHVyaW5nLWluZHVzdHJ5L2dvcmdvbicpO1xyXG4gICAgICAgIHRoaXMuX21vdGQoKTtcclxuICAgICAgICBnbG9iYWwuQ29uc29sZS5sb2coJ1ByZXNzICcgKyBnbG9iYWwuQ29uc29sZS5jb2xvcignY250cmwrYycsICd5ZWxsb3cnKSArICcgdG8gZXhpdCB0aGUgc2VydmVyJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc2VydmVyIG1lc3NhZ2Ugb2YgdGhlIGRheSBkaXNwbGF5XHJcbiAgICAgKlxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgX21vdGQoKVxyXG4gICAge1xyXG4gICAgICAgIGdsb2JhbC5Db25zb2xlLmxvZyh0aGlzLnNlcGFyYXRvcjEpO1xyXG4gICAgICAgIGdsb2JhbC5Db25zb2xlLmxvZyhnbG9iYWwuQ29uc29sZS5jb2xvcih0aGlzLkdvcmdvbkNvbmZpZy5kYXRhLm1vdGQsICd5ZWxsb3cnKSk7XHJcbiAgICAgICAgZ2xvYmFsLkNvbnNvbGUubG9nKHRoaXMuc2VwYXJhdG9yMSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qXHJcbiAqIFJ1biB0aGUgR29yZ29uIFNlcnZlclxyXG4gKi9cclxudmFyIEdvcmdvblNlcnZlciA9IG5ldyBHb3Jnb24oKTtcclxuR29yZ29uU2VydmVyLmluaXRTZXJ2ZXIoKTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9nb3Jnb24uanNcbiAqKi8iLCIvKipcclxuICogR29yZ29uIHRoZSBzY3JpcHRpbmcgY2FwYWJsZSBuZXR3b3JrIHNlcnZlciBmb3IgTm9kZSBKU1xyXG4gKlxyXG4gKiBAcGFja2FnZSBHb3Jnb25cclxuICogQGF1dGhvciBSeWFuIFJlbnRmcm9cclxuICogQGxpY2Vuc2UgTUlUXHJcbiAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL21hbnVmYWN0dXJpbmctaW5kdXN0cnlcclxuICovXHJcblxyXG4vKipcclxuICogVGhlIEdvcmdvbiBjb25maWcgY2xhc3NcclxuICovXHJcbmV4cG9ydCBjbGFzcyBHb3Jnb25Db25maWdcclxue1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RzIHRoZSBjbGFzc1xyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcigpXHJcbiAgICB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNlcnZlcnMgZGVmYXVsdCBjb25maWcgZGF0YVxyXG4gICAgICAgICAqIEB0eXBlIHt7bmFtZTogc3RyaW5nLCB2ZXJzaW9uOiBzdHJpbmd9fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IHtcclxuICAgICAgICAgICAgbmFtZTogX19MSUJfTkFNRV9fLFxyXG4gICAgICAgICAgICB2ZXJzaW9uOiBfX1ZFUlNJT05fU1RSSU5HX18sXHJcbiAgICAgICAgICAgIG1vdGQ6IF9fTU9URF9fXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNlcnZlcnMgZGVmYXVsdCBzdG9yYWdlIGNvbmZpZ1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQG5vdGUgQ29udGFpbnMgdGhlIHBhdGggcG9pbnRlcnMgZm9yIGJhc2Ugc3RvcmFnZSBjb21wb25lbnRzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7e2xvZ3M6IHN0cmluZ319XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5zdG9yYWdlID0ge1xyXG4gICAgICAgICAgICBsb2dzOiAnbG9ncy8nXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNlcnZlcnMgZGVmYXVsdCBsYXllcnMgY29udHJvbHNcclxuICAgICAgICAgKiBAdHlwZSB7e3NlcnZlcjogYm9vbGVhbiwgY2xpOiBib29sZWFuLCBzZXJ2aWNlczogYm9vbGVhbn19XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5sb2FkID0ge1xyXG4gICAgICAgICAgICBzZXJ2ZXI6IHRydWUsXHJcbiAgICAgICAgICAgIGNsaTogdHJ1ZSxcclxuICAgICAgICAgICAgc2VydmljZXM6IHRydWVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb250cm9scyBkZWJ1Z2dpbmdcclxuICAgICAgICAgKiBAdHlwZSB7e2VuYWJsZTogYm9vbGVhbn19XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5kZWJ1ZyA9IHtcclxuICAgICAgICAgICAgZW5hYmxlOiB0cnVlXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbmZpZy9jb25maWcuanNcbiAqKi8iLCIvKipcclxuICogR29yZ29uIHRoZSBzY3JpcHRpbmcgY2FwYWJsZSBuZXR3b3JrIHNlcnZlciBmb3IgTm9kZSBKU1xyXG4gKlxyXG4gKiBAcGFja2FnZSBHb3Jnb25cclxuICogQGF1dGhvciBSeWFuIFJlbnRmcm9cclxuICogQGxpY2Vuc2UgTUlUXHJcbiAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL21hbnVmYWN0dXJpbmctaW5kdXN0cnlcclxuICovXHJcblxyXG5pbXBvcnQgU3RhdHVzU2VydmljZSBmcm9tICcuLi9zZXJ2aWNlL3N0YXR1cy9pbmRleCdcclxuXHJcbi8qKlxyXG4gKiBUaGUgR29yZ29uIGVudiBjbGFzc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEdvcmdvbkVudlxyXG57XHJcbiAgICBjb25zdHJ1Y3RvcigpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gbmV3IFN0YXR1c1NlcnZpY2UoKTtcclxuICAgICAgICB0aGlzLnNlcnZpY2UgPSBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHNpZDogMCxcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdTdGF0dXMnLFxyXG4gICAgICAgICAgICAgICAgbmFtZXNwYWNlOiAnU3RhdHVzU2VydmljZScsXHJcbiAgICAgICAgICAgICAgICBlbmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBzZXJ2aWNlOiB0aGlzLnNlcnZpY2UgfVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcbn1cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb25maWcvZW52LmpzXG4gKiovIiwiLyoqXHJcbiAqIEdvcmdvbiB0aGUgc2NyaXB0aW5nIGNhcGFibGUgbmV0d29yayBzZXJ2ZXIgZm9yIE5vZGUgSlNcclxuICpcclxuICogQHBhY2thZ2UgR29yZ29uXHJcbiAqIEBhdXRob3IgUnlhbiBSZW50ZnJvXHJcbiAqIEBsaWNlbnNlIE1JVFxyXG4gKiBAdXJsIGh0dHBzOi8vZ2l0aHViLmNvbS9tYW51ZmFjdHVyaW5nLWluZHVzdHJ5XHJcbiAqL1xyXG5cclxuLypcclxuICogSW1wb3J0c1xyXG4gKi9cclxuaW1wb3J0IHtSb3V0ZXN9IGZyb20gJy4uLy4uL2NvbXBvbmVudC9yb3V0ZXMnXHJcbmltcG9ydCB7R29yZ29uU2VydmljZX0gZnJvbSAnLi4vaW5kZXgnO1xyXG5pbXBvcnQge1N0YXR1c1NlcnZpY2VDb25maWd9IGZyb20gJ2NvbmZpZy9jb25maWcnO1xyXG5pbXBvcnQge05ldHdvcmt9IGZyb20gJy4uLy4uL2NvbXBvbmVudC9uZXR3b3JrJ1xyXG5cclxudmFyIE5ldHdvcmtTdGFjayA9IG5ldyBOZXR3b3JrKCk7XHJcblxyXG4vKipcclxuICogVGhlIHN0YXR1cyBzZXJ2aWNlXHJcbiAqXHJcbiAqIEBub3RlIFByb3ZpZGVzIHN0YXR1cyBvbiBzZXJ2ZXIgY29uZmlndXJhdGlvblxyXG4gKi9cclxuY2xhc3MgU3RhdHVzU2VydmljZSBleHRlbmRzIEdvcmdvblNlcnZpY2Uge1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RzIHRoZSBjbGFzc1xyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcigpXHJcbiAgICB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHN0YXR1cyBzZXJ2aWNlIGNvbmZpZ3VyYXRpb25cclxuICAgICAgICAgKiBAdHlwZSB7U3RhdHVzU2VydmljZUNvbmZpZ31cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmNvbmZpZyA9IFN0YXR1c1NlcnZpY2VDb25maWc7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBzZXJ2aWNlIG5hbWVcclxuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubmFtZSA9ICdTdGF0dXMgU2VydmljZSc7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBzZXJ2aWNlIG5hbWVzcGFjZVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5uYW1lc3BhY2UgPSAnU3RhdHVzU2VydmljZSc7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBzZXJ2aWNlIGRlc2NyaXB0aW9uXHJcbiAgICAgICAgICogQHR5cGUge3N0cmluZ31cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gJ1Byb3ZpZGVzIHNlcnZpY2Ugc3RhdHVzJztcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNlcnZpY2UgdHlwZVxyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy50eXBlID0gJ1NlcnZpY2UnO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgc2VydmljZSBodHRwcyBjb250cm9sIC0gY29udHJvbHMgaG93IGh0dHBzIHdvcmtzIGZvciB0aGUgc2VydmljZXMgZXhwb3NlZCBodHRwIGVuZHBvaW50c1xyXG4gICAgICAgICAqIEB0eXBlIHtzdHJpbmd8Ym9vbGVhbn0gQ2FuIGJlIGVuYWJsZSwgZGlzYWJsZSwgdHJ1ZSwgZmFsc2UsIG9yIGVuZm9yY2VcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmh0dHBzID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGluYm91bmQgdHlwZXMgc3VwcG9ydGVkIGJ5IHRoZSBzZXJ2aWNlXHJcbiAgICAgICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuaW5ib3VuZFR5cGVzID0gWydyZXN0JywgJ3NvY2tldCcsICdodHRwJywgJ3dlYlNvY2tldCcsICdhcGknXTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHBvcnRzIHRoYXQgbWFwIHRvIHRoZSBpbmJvdW5kIHR5cGVzIDE6MVxyXG4gICAgICAgICAqIEB0eXBlIHtudW1iZXJ8bnVsbFtdfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucG9ydHMgPSBbMjYwMCwgbnVsbCwgMjY4MCwgMjY4OCwgbnVsbF07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSByb3V0ZXIgZm9yIHRoZSBzZXJ2aWNlXHJcbiAgICAgICAgICogQHR5cGUge1JvdXRlc31cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnJvdXRlciA9IG5ldyBSb3V0ZXModGhpcy5uYW1lcHNhY2UpO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgcGVybWlzc2lvbnMgZm9yIHRoZSBzZXJ2aWNlXHJcbiAgICAgICAgICogQHR5cGUge3N0cmluZ1tdfSBDYW4gYmUgaW50ZXJuYWwgYW5kL29yIGV4dGVybmFsXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wZXJtaXNzaW9ucyA9IFsnaW50ZXJuYWwnXTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQmluZHMgdGhlIHNlcnZpY2VzIHJvdXRlcyBhbmQgbmV0d29ya2luZ1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuc2VydmljZUJpbmQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoZSByb3V0ZXMgY29uZmlndXJhdGlvbiBmb3IgdGhlIHNlcnZpY2VcclxuICAgICAqXHJcbiAgICAgKiBAbm90ZSBUaGlzIGlzIGxvYWRlZCBpbnRvIHRoZSBjbGFzc2VzIHJvdXRlciBhbmQgdGhlIG5ldHdvcmsgc3RhY2tcclxuICAgICAqL1xyXG4gICAgcm91dGVzKClcclxuICAgIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAnU2VydmljZVJlcXVlc3QnOlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpbmJvdW5kVHlwZXM6IHRoaXMuaW5ib3VuZFR5cGVzLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnL1N0YXR1c1NlcnZpY2VSZXF1ZXN0JyxcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiB0aGlzLnNlcnZpY2VSZXF1ZXN0KClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhlIHNlcnZpY2UgcmVxdWVzdCBtZXRob2QgZm9yIGh0dHAgYW5kIHJlc3Qgc2VydmljZXNcclxuICAgICAqXHJcbiAgICAgKiBAbm90ZSBQcm92aWRlcyB0aGUgc2VydmljZSByZXF1ZXN0IGZvciB0aGUgc2VydmVyXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtSZXF1ZXN0fSByZXEgQSByZXF1ZXN0IG9iamVjdFxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHJlcyBBIHJlc3BvbnNlIG9iamVjdFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1vZGUgQ29udHJvbHMgaWYgdGhlIGNhbGwgaXMgaHR0cCBvciByZXN0XHJcbiAgICAgKiBAdG9kbyBBZGQgcm91dGluZyBmb3IgaGFuZGxpbmcgaW5ib3VuZCByZXF1ZXN0c1xyXG4gICAgICovXHJcbiAgICBzZXJ2aWNlUmVxdWVzdChyZXEsIHJlcywgbW9kZSlcclxuICAgIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgc2VydmljZSBhcGkgY2FsbCBtZXRob2RcclxuICAgICAqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGRhdGFcclxuICAgICAqIEB0b2RvIEFkZCByb3V0aW5nIGZvciBoYW5kbGluZyBpbmJvdW5kIHJlcXVlc3RzXHJcbiAgICAgKi9cclxuICAgIGFwaVJlcXVlc3QoZGF0YSlcclxuICAgIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0V2ViU29ja2V0RXZlbnRzKHNvY2tldClcclxuICAgIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBCaW5kcyB0aGUgc2VydmljZXMgcm91dGVzIGFuZCBuZXR3b3JraW5nIGNvbXBvbmVudHNcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBSZXR1cm5zIHRydWUgb24gY29tcGxldGlvblxyXG4gICAgICovXHJcbiAgICBzZXJ2aWNlQmluZCgpXHJcbiAgICB7XHJcbiAgICAgICAgLypcclxuICAgICAgICAgKiBJbXBvcnRzIHRoZSByb3V0ZXJzIHJvdXRlcyBmcm9tIHRoZSBjbGFzc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucm91dGVyLmltcG9ydFJvdXRlcyh0aGlzLnJvdXRlcygpKTtcclxuXHJcbiAgICAgICAgLypcclxuICAgICAgICAgKiBTZXQgdGhlIG5ldHdvcmtpbmcgY29uZmlndXJhdGlvbiBmb3IgdGhlIGNsYXNzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fc2V0TmV0d29ya2luZygpO1xyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIEFkZCB0aGUgc2VydmljZSB0byB0aGUgbmV0d29ya1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIE5ldHdvcmtTdGFjay5hZGRTZXJ2aWNlKHRoaXMpO1xyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBzZXJ2aWNlVW5iaW5kKClcclxuICAgIHtcclxuICAgICAgICBOZXR3b3JrU3RhY2sucmVtb3ZlU2VydmljZSh0aGlzLm5hbWVzcGFjZSk7XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG4vKlxyXG4gKiBFeHBvcnRzXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBTdGF0dXNTZXJ2aWNlO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3NlcnZpY2Uvc3RhdHVzL2luZGV4LmpzXG4gKiovIiwiLyoqXHJcbiAqIEdvcmdvbiB0aGUgc2NyaXB0aW5nIGNhcGFibGUgbmV0d29yayBzZXJ2ZXIgZm9yIE5vZGUgSlNcclxuICpcclxuICogQHBhY2thZ2UgR29yZ29uXHJcbiAqIEBhdXRob3IgUnlhbiBSZW50ZnJvXHJcbiAqIEBsaWNlbnNlIE1JVFxyXG4gKiBAdXJsIGh0dHBzOi8vZ2l0aHViLmNvbS9tYW51ZmFjdHVyaW5nLWluZHVzdHJ5XHJcbiAqL1xyXG5cclxuZXhwb3J0IGNsYXNzIFJvdXRlcyB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZXJ2aWNlTmFtZXNwYWNlKSB7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZU5hbWVzcGFjZTtcclxuICAgICAgICB0aGlzLmluYm91bmRUeXBlcyA9IFsncmVzdCcsICdzb2NrZXQnLCAnaHR0cCcsICdodHRwcycsICd3ZWJTb2NrZXQnLCAnYXBpJ107XHJcbiAgICAgICAgdGhpcy5yb3V0ZXMgPSBbXTtcclxuICAgICAgICB0aGlzLnJvdXRlQ2FsbGJhY2tzID0gW107XHJcbiAgICAgICAgdGhpcy5wZXJtaXNzaW9uTWFwID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgYWRkKGluYm91bmRUeXBlcywgbWV0aG9kLCBjYWxsYmFjaylcclxuICAgIHtcclxuICAgICAgICB0aGlzLnJvdXRlcy5wdXNoKG1ldGhvZCk7XHJcbiAgICAgICAgdGhpcy5yb3V0ZUNhbGxiYWNrcyhjYWxsYmFjayk7XHJcbiAgICAgICAgdmFyIHBvcyA9IHRoaXMucm91dGVDYWxsYmFja3MubGVuZ3RoIC0gMTtcclxuXHJcbiAgICAgICAgaW5ib3VuZFR5cGVzLmZvckVhY2goZnVuY3Rpb24odmFsdWUpe1xyXG4gICAgICAgICAgICBpZiAodGhpcy5pbmJvdW5kVHlwZXMuaW5kZXhPZih2YWx1ZSkgPiAtMSkgdGhpcy5wZXJtaXNzaW9uTWFwW3ZhbHVlXS5wdXNoKHBvcyk7XHJcbiAgICAgICAgICAgIGVsc2UgY29uc29sZS5sb2coJ0VSUk9SIC0gSW52YWxpZCBQZXJtaXNzaW9uIEVuY291bnRlcmVkIGluIFNlcnZpY2U6IFsnICsgdGhpcy5zZXJ2aWNlICsgJ10gTWV0aG9kOiBbJyArIG1ldGhvZCArICddJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlKG1ldGhvZClcclxuICAgIHtcclxuICAgICAgICBsZXQgcG9zID0gdGhpcy5yb3V0ZXMuaW5kZXhPZihtZXRob2QpO1xyXG4gICAgICAgIGlmIChwb3MgPiAtMSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMucm91dGVDYWxsYmFja3NbcG9zXSA9IG51bGw7XHJcbiAgICAgICAgICAgIHRoaXMucm91dGVzW3Bvc10gPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5pbmJvdW5kVHlwZXMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucGVybWlzc2lvbk1hcFt2YWx1ZV0gIT0gdW5kZWZpbmVkICYmIHRoaXMucGVybWlzc2lvbk1hcFt2YWx1ZV0gaW5zdGFuY2VvZiBBcnJheSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQga2V5UG9zID0gdGhpcy5wZXJtaXNzaW9uTWFwW3ZhbHVlXS5pbmRleE9mKHBvcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGtleVBvcyA+IC0xKSB0aGlzLnBlcm1pc3Npb25NYXBbdmFsdWVdLnNwbGljZShrZXlQb3MsIDEpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBpbXBvcnRSb3V0ZXMocm91dGVzKVxyXG4gICAge1xyXG4gICAgICAgIGlmIChyb3V0ZXMgaW5zdGFuY2VvZiBBcnJheSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiByb3V0ZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyb3V0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkKHJvdXRlc1trZXldWydpbmJvdW5kVHlwZXMnXSwgcm91dGVzW2tleV1bJ21ldGhvZCddLCByb3V0ZXNba2V5XVsnY2FsbGJhY2snXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJvdXRlKGluYm91bmRUeXBlLCBtZXRob2QsIHBheWxvYWQpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IHBvcyA9IHRoaXMucm91dGVzLmluZGV4T2YobWV0aG9kKTtcclxuICAgICAgICBpZiAocG9zID4gLTEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wZXJtaXNzaW9uTWFwW2luYm91bmRUeXBlXSAhPSB1bmRlZmluZWQgJiYgdGhpcy5wZXJtaXNzaW9uTWFwW2luYm91bmRUeXBlXS5sZW5ndGggPiAwICYmIHRoaXMucGVybWlzc2lvbk1hcFtpbmJvdW5kVHlwZV0uaW5kZXhPZihwb3MpID4gLTEpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIC8vY2FsbGJhY2sgZXhpc3RzIGZvciBtZXRob2RcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJvdXRlQ2FsbGJhY2tzW3Bvc10obWV0aG9kLCBpbmJvdW5kVHlwZSwgLi4ucGF5bG9hZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvY29tcG9uZW50L3JvdXRlcy5qc1xuICoqLyIsIi8qKlxyXG4gKiBHb3Jnb24gdGhlIHNjcmlwdGluZyBjYXBhYmxlIG5ldHdvcmsgc2VydmVyIGZvciBOb2RlIEpTXHJcbiAqXHJcbiAqIEBwYWNrYWdlIEdvcmdvblxyXG4gKiBAYXV0aG9yIFJ5YW4gUmVudGZyb1xyXG4gKiBAbGljZW5zZSBNSVRcclxuICogQHVybCBodHRwczovL2dpdGh1Yi5jb20vbWFudWZhY3R1cmluZy1pbmR1c3RyeVxyXG4gKi9cclxuXHJcbi8qXHJcbiAqIEltcG9ydHNcclxuICovXHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuXHJcbi8qKlxyXG4gKiBUaGUgR29yZ29uIENvbnRhaW5lciBTZXJ2aWNlIENsYXNzXHJcbiAqXHJcbiAqIEBub3RlIFRoaXMgY2xhc3MgcHJvdmlkZXMgY29udGFpbmVycyBmb3Igc2VydmljZXNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBHb3Jnb25Db250YWluZXJTZXJ2aWNlIHtcclxuICAgIC8qKlxyXG4gICAgICogQ29uc3RydWN0cyB0aGUgY2xhc3NcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVycyA9IFtdO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyTWFwID0gW107XHJcbiAgICAgICAgdGhpcy5uYW1lID0gXCJHb3Jnb24gQ29udGFpbmVyIFNlcnZpY2VcIjtcclxuICAgICAgICB0aGlzLnR5cGUgPSBcIlNlcnZpY2VcIjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgYSBuZXcgc2VydmljZSBieSBjcmVhdGluZyBhIGNvbnRhaW5lciBhbmQgaW5qZWN0aW5nIHRoZSBzZXJ2aWNlIGFuZCBpdHMgbG9jYXRpb24gdG8gdGhlIHNlcnZpY2UgbWFwXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IHNlcnZpY2UgVGhlIHNlcnZpY2UgdG8gdGJlIGFkZGVkXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIG9uIGNvbXBsZXRpb24gYW5kIGZhbHNlIG9uIGZhaWx1cmVcclxuICAgICAqL1xyXG4gICAgYWRkKHNlcnZpY2UpXHJcbiAgICB7XHJcbiAgICAgICAgaWYgKHNlcnZpY2UubmFtZXNwYWNlICE9IG51bGwgJiYgc2VydmljZS5uYW1lc3BhY2UgIT0gJycgJiYgdGhpcy5jb250YWluZXJNYXAuaW5kZXhPZihzZXJ2aWNlLm5hbWVzcGFjZSkgPT0gLTEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lcnMucHVzaChzZXJ2aWNlKTtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXJNYXAucHVzaChzZXJ2aWNlLm5hbWVzcGFjZSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIGEgc2VydmljZSBjb250YWluZXIgYnkgdGhlIHNlcnZpY2UgbmFtZXNwYWNlXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VOYW1lc3BhY2UgVGhlIHNlcnZpY2UgbmFtZXNwYWNlIHRvIGJlIHJlbW92ZWRcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRydWUgb24gY29tcGxldGlvbiBhbmQgZmFsc2Ugb24gZmFpbHVyZVxyXG4gICAgICovXHJcbiAgICByZW1vdmUoc2VydmljZU5hbWVzcGFjZSlcclxuICAgIHtcclxuICAgICAgICBpZiAodGhpcy5jb250YWluZXJNYXAuaW5kZXhPZihzZXJ2aWNlTmFtZXNwYWNlKSA+IC0xKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgbGV0IHBvcyA9IHRoaXMuY29udGFpbmVyTWFwLmluZGV4T2Yoc2VydmljZU5hbWVzcGFjZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVycy5zcGxpY2UocG9zLCAxKTtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXJNYXAuc3BsaWNlKHBvcywgMSk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXRyaWV2ZXMgYSBzZXJ2aWNlIGNvbnRhaW5lciBieSBpdHMgbmFtZXNwYWNlXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VOYW1lc3BhY2UgVGhlIHNlcnZpY2UgbmFtZXNwYWNlXHJcbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgc2VydmljZSB3aGVuIGxvY2F0ZWQgb3IgZmFsc2Ugd2hlbiBub3QgbG9jYXRlZFxyXG4gICAgICovXHJcbiAgICBnZXQoc2VydmljZU5hbWVzcGFjZSlcclxuICAgIHtcclxuICAgICAgICBpZiAodGhpcy5jb250YWluZXJNYXAuaW5kZXhPZihzZXJ2aWNlTmFtZXNwYWNlKSA+IC0xKSByZXR1cm4gdGhpcy5jb250YWluZXJzW3RoaXMuY29udGFpbmVyTWFwLmluZGV4T2Yoc2VydmljZU5hbWVzcGFjZSldO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRoZSBnb3Jnb24gc2VydmljZSBvYmplY3RcclxuICpcclxuICogQG5vdGUgUHJvdmlkZXMgdGhlIHNlcnZpY2UsIGRlZmF1bHQgcHJvcGVydGllcy9tZXRob2RzIHVzZWQgZm9yIGNvbnN0cnVjdGluZyBjb250YWluZXJzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgR29yZ29uU2VydmljZVxyXG57XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKClcclxuICAgIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgc2VydmljZSBpZCBmb3IgdGhlIHNlcnZpY2VcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBub3RlIFRoZSBzZXJ2aWNlIElkIGlzIHNldCB3aGVuIGEgc2VydmljZSBpcyBhZGRlZCB0byB0aGUgbmV0d29yayBsYXllciBhbmQgaXRzIHNlcnZpY2UgaWQgaXMgcmV0dXJuZWRcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtudWxsfG51bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnNlcnZpY2VJZCA9IG51bGw7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBzZXJ2aWNlIG5hbWVcclxuICAgICAgICAgKiBAdHlwZSB7bnVsbHxzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5uYW1lID0gbnVsbDtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNlcnZpY2UgZGVzY3JpcHRpb25cclxuICAgICAgICAgKiBAdHlwZSB7bnVsbHxzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IG51bGw7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBzZXJ2aWNlIHR5cGVcclxuICAgICAgICAgKiBAdHlwZSB7c3RyaW5nfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMudHlwZSA9ICdTZXJ2aWNlJztcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNlcnZpY2Ugcm91dGVyXHJcbiAgICAgICAgICogQHR5cGUge251bGx8Um91dGVyfVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucm91dGVyID0gbnVsbDtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGxpc3Qgb2YgaW5ib3VuZCBzZXJ2aWNlIHR5cGVzIHRvIGNvbm5lY3RcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBub3RlIFRoZXNlIG1hcCAxOjEgd2l0aCB0aGlzLnBvcnRzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7QXJyYXl9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5pbmJvdW5kVHlwZXMgPSBbXTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGxpc3Qgb2YgaW5ib3VuZCBwb3J0cyB0eXBlcyB0b1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQG5vdGUgVGhlc2UgbWFwIDE6MSB3aXRoIHRoaXMuaW5ib3VuZFR5cGVzXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAdHlwZSB7QXJyYXl9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wb3J0cyA9IFtdO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgc2VydmljZSBwZXJtaXNzaW9ucyBsaXN0XHJcbiAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucGVybWlzc2lvbnMgPSBbXTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIHNlcnZpY2UgbmV0d29ya2luZyBjb25maWd1cmF0aW9uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAbm90ZSBNb3N0IG9iamVjdCB3aWxsIGJ1aWxkIHRoaXMgdmlhIHRoaXMuX3NldE5ldHdvcmtpbmdcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLm5ldHdvcmtpbmcgPSBbXTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldHMgdGhlIG5ldHdvcmtpbmcgcHJvcGVydHkgdmlhIHRoZSBpbmJvdW5kVHlwZXMgYW5kIHBvcnRzIHByb3BlcnRpZXNcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIF9zZXROZXR3b3JraW5nKClcclxuICAgIHtcclxuICAgICAgICBpZiAodGhpcy5pbmJvdW5kVHlwZXMgaW5zdGFuY2VvZiBBcnJheSAmJiB0aGlzLnBvcnRzIGluc3RhbmNlb2YgQXJyYXkgJiYgdGhpcy5pbmJvdW5kVHlwZXMubGVuZ3RoID09IHRoaXMucG9ydHMubGVuZ3RoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IHRoaXMuaW5ib3VuZFR5cGVzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm5ldHdvcmtpbmcucHVzaCh7IG5hbWU6IHRoaXMuaW5ib3VuZFR5cGVzW2ldLCBwb3J0OiB0aGlzLnBvcnRzW2ldIH0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0dvcmdvblNlcnZpY2U6X3NldE5ldHdvcmtpbmcgLSBNaXNzaW5nIG9yIGludmFsaWQgbmV0d29ya2luZyBmb3Igc2VydmljZSAnICsgdGhpcy5uYW1lKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXRzIHRoZSBzZXJ2aWNlSWQgZm9yIHRoZSBzZXJ2aWNlXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2VydmljZUlkXHJcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBSZXR1cm5zIHRydWUgb24gY29tcGxldGlvblxyXG4gICAgICovXHJcbiAgICBzZXRTZXJ2aWNlSWQoc2VydmljZUlkKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuc2VydmljZUlkID0gc2VydmljZUlkO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogSW50ZXJmYWNlOiBUaGUgZGVmYXVsdCBzZXJ2aWNlUmVxdWVzdCBtZXRob2RcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3JlcX0gcmVxIFRoZSByZXF1ZXN0IG9iamVjdFxyXG4gICAgICogQHBhcmFtIHtyZXN9IHJlcyBUaGUgcmVzcG9uc2Ugb2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBUaGUgdHlwZSBmb3IgdGhlIHNlcnZpY2UgcmVxdWVzdCAoaHR0cCBvciByZXN0KVxyXG4gICAgICogQHJldHVybnMge251bGx9IFJldHVybnMgbnVsbCB3aGVuIG5vdCBpbXBsZW1lbnRlZFxyXG4gICAgICovXHJcbiAgICBzZXJ2aWNlUmVxdWVzdChyZXEsIHJlcywgdHlwZSlcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEludGVyZmFjZTogVGhlIGRlZmF1bHQgYXBpUmVxdWVzdCBtZXRob2RcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0FwaUNhbGx9IGFwaUNhbGwgVGhlIEFwaUNhbGwgb2JqZWN0XHJcbiAgICAgKiBAcmV0dXJucyB7QXBpQ2FsbH0gUmV0dXJucyB0aGUgYXBpIGNhbGwgYWZ0ZXIgc2V0dGluZyBlcnJvciBzdGF0ZSBhbmQgdXBkYXRpbmcgdGhlIHJldHVybmVkIHRpbWVzdGFtcFxyXG4gICAgICovXHJcbiAgICBhcGlSZXF1ZXN0KGFwaUNhbGwpXHJcbiAgICB7XHJcbiAgICAgICAgYXBpQ2FsbC5lcnJvciA9IHRydWU7XHJcbiAgICAgICAgYXBpQ2FsbC5lcnJvcnMscHVzaCgnQVBJIGNhbGwgaGFuZGxlciBub3QgZGVmaW5lZCcpO1xyXG4gICAgICAgIGFwaUNhbGwucmV0dXJuZWQgPSBtb21lbnQoKTtcclxuICAgICAgICByZXR1cm4gYXBpQ2FsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEludGVyZmFjZTogVGhlIGRlZmF1bHQgYXBpUmVxdWVzdCBtZXRob2RcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc29ja2V0IFRoZSBzb2NrZXQgb2JqZWN0IHRvIGNhbGxcclxuICAgICAqIEByZXR1cm5zIHtudWxsfSBSZXR1cm5zIG51bGwgd2hlbiBub3QgaW1wbGVtZW50ZWRcclxuICAgICAqL1xyXG4gICAgc2V0V2ViU29ja2V0RXZlbnRzKHNvY2tldClcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcblxyXG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvc2VydmljZS9pbmRleC5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm1vbWVudFwiKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIFwibW9tZW50XCJcbiAqKiBtb2R1bGUgaWQgPSA2XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvKipcclxuICogR29yZ29uIHRoZSBzY3JpcHRpbmcgY2FwYWJsZSBuZXR3b3JrIHNlcnZlciBmb3IgTm9kZSBKU1xyXG4gKlxyXG4gKiBAcGFja2FnZSBHb3Jnb25cclxuICogQGF1dGhvciBSeWFuIFJlbnRmcm9cclxuICogQGxpY2Vuc2UgTUlUXHJcbiAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL21hbnVmYWN0dXJpbmctaW5kdXN0cnlcclxuICovXHJcblxyXG4vKlxyXG4gKiBJbXBvcnRzXHJcbiAqL1xyXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnXHJcbmltcG9ydCBNaWRkbGV3YXJlIGZyb20gJy4vbWlkZGxld2FyZSdcclxuaW1wb3J0IHtBcGl9IGZyb20gJy4vYXBpJztcclxuaW1wb3J0IG5ldCBmcm9tICduZXQnO1xyXG5pbXBvcnQgaHR0cCBmcm9tICdodHRwJztcclxuaW1wb3J0IFNvY2tldElPIGZyb20gJ3NvY2tldC5pbyc7XHJcbmltcG9ydCBjb21wcmVzc2lvbiBmcm9tICdjb21wcmVzc2lvbic7XHJcbmltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xyXG5cclxuLypcclxuICogVmFyaWFibGVzXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIENvbnRhaW5zIHRoZSBzaW5nbGV0b24gaW5zdGFuY2UgZm9yIHRoZSBuZXR3b3JrXHJcbiAqIEB0eXBlIHtudWxsfE5ldHdvcmt9XHJcbiAqL1xyXG5sZXQgaW5zdGFuY2UgPSBudWxsO1xyXG5cclxuLyoqXHJcbiAqIFRoZSBuZXR3b3JrIGNvbnRyb2xzIHNpbmdsZXRvbiBjbGFzc1xyXG4gKlxyXG4gKiBAbm90ZSBDcmVhdGVzIGFuZCBtYXBzIHRoZSBuZXR3b3JrIGNvbXBvbmVudHMgZm9yIHNlcnZpY2VzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgTmV0d29yayB7XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKClcclxuICAgIHtcclxuICAgICAgICBpZighaW5zdGFuY2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogVGhlIG1pZGRsZXdhcmUgZm9yIHRoZSBjbGFzc1xyXG4gICAgICAgICAgICAgKiBAdHlwZSB7TWlkZGxld2FyZX1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMubWlkZGxld2FyZSA9IG5ldyBNaWRkbGV3YXJlKCk7XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogVGhlIHNlcnZpY2VzIHN0YWNrXHJcbiAgICAgICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMuc2VydmljZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBUaGUgc2VydmljZSBzdGFjayBtYXBcclxuICAgICAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlTWFwID0gW107XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogVGhlIGNvbXBvbmVudCBjb2xsZWN0aW9uXHJcbiAgICAgICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIFRoZSBjb21wb25lbnQgY29sbGVjdGlvbiBtYXBcclxuICAgICAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRNYXAgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBUaGUgY29tcG9uZW50IGNvbGxlY3Rpb24gdHlwZSBtYXBcclxuICAgICAgICAgICAgICogQHR5cGUge3tyZXN0OiBBcnJheSwgc29ja2V0OiBBcnJheSwgd2ViU29ja2V0OiBBcnJheSwgaHR0cDogQXJyYXksIGFwaTogQXJyYXl9fVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRUeXBlTWFwID0ge1xyXG4gICAgICAgICAgICAgICAgcmVzdDogW10sXHJcbiAgICAgICAgICAgICAgICBzb2NrZXQ6IFtdLFxyXG4gICAgICAgICAgICAgICAgd2ViU29ja2V0OiBbXSxcclxuICAgICAgICAgICAgICAgIGh0dHA6IFtdLFxyXG4gICAgICAgICAgICAgICAgYXBpOiBbXVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIFRoZSBuZXR3b3JrIEFQSSBjb250cm9sXHJcbiAgICAgICAgICAgICAqIEB0eXBlIHtBcGl9XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB0aGlzLmFwaSA9IG5ldyBBcGkoKTtcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBUaGUgcG9ydCByZXNlcnZhdGlvbiBsaXN0XHJcbiAgICAgICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMucG9ydFJlc2VydmF0aW9ucyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIFRoZSBwb3J0IHJlc2VydmF0aW9uIG5hbWVzcGFjZSBsaXN0XHJcbiAgICAgICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMucG9ydFJlc2VydmF0aW9uTmFtZXNwYWNlID0gW107XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogVGhlIGFjdGl2ZSBzZXJ2aWNlIGluIHRoZSBuZXR3b3JrIHN0YWNrXHJcbiAgICAgICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZlU2VydmljZXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICB9IGVsc2UgcmV0dXJuIGluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhIHNlcnZpY2UgdG8gdGhlIG5ldHdvcmsgbGF5ZXJcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gc2VydmljZSBUaGUgc2VydmljZSB0byBiZSBhZGRlZFxyXG4gICAgICogQHJldHVybiB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIG9uIGNvbXBsZXRpb24gYW5kIGZhbHNlIG9uIGZhaWx1cmVcclxuICAgICAqL1xyXG4gICAgYWRkU2VydmljZShzZXJ2aWNlKVxyXG4gICAge1xyXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZVNlcnZpY2VzLmluZGV4T2Yoc2VydmljZS5uYW1lc3BhY2UpID09IC0xKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5zZXJ2aWNlcy5wdXNoKHNlcnZpY2UpO1xyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VNYXAucHVzaChzZXJ2aWNlLm5hbWVzcGFjZSk7XHJcbiAgICAgICAgICAgIGxldCBzZXJ2aWNlSWQgPSB0aGlzLnNlcnZpY2VNYXAubGVuZ3RoIC0gMTtcclxuICAgICAgICAgICAgc2VydmljZS5zZXRTZXJ2aWNlSWQoc2VydmljZSk7XHJcblxyXG4gICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgKiBBZGQgbmV0d29ya2luZyBjb21wb25lbnRzXHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICBpZiAoc2VydmljZS5uZXR3b3JraW5nIGluc3RhbmNlb2YgQXJyYXkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wOyBpIDwgc2VydmljZS5uZXR3b3JraW5nLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgICAgICAgICAqIEB0b2RvIFJFU1VNRSBIRVJFXHJcbiAgICAgICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGQoc2VydmljZUlkLCBzZXJ2aWNlLm5hbWVzcGFjZSwgc2VydmljZS5uZXR3b3JraW5nW2ldLm5hbWUsICdsYWJlbCcsIHNlcnZpY2UubmV0d29ya2luZ1tpXS5wb3J0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGdsb2JhbC5Mb2dnZXIubG9nKCdOZXR3b3JrOmFkZFNlcnZpY2UnLCAyMDAsICdBZGRlZCBzZXJ2aWNlcyBjb21wb25lbnRzOiAnICsgc2VydmljZS5uYW1lICsgJyBmb3IgU2VydmljZTogJyArIHNlcnZpY2UubmFtZXNwYWNlICsgJyAtIFNlcnZpY2VJZDogJyArIHNlcnZpY2VJZCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmVzIHRoZSBzZXJ2aWNlcyBuZXR3b3JrIGNvbXBvbmVudHNcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZU5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIG9mIHRoZSBzZXJ2aWNlIHRvIGJlIHJlbW92ZWRcclxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uIGFuZCBmYWxzZSBvbiBmYWlsdXJlXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZVNlcnZpY2Uoc2VydmljZU5hbWVzcGFjZSlcclxuICAgIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgc2VydmljZSBuZXR3b3JrIGNvbXBvbmVudFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzZXJ2aWNlSWQgVGhlIHNlcnZpY2VJZCBmb3IgdGhlIHNlcnZpY2VcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlTmFtZXNwYWNlIFRoZSBzZXJ2aWNlIG5hbWVzcGFjZSBmb3IgdGhlIGNvbXBvbmVudFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVGhlIG5ldHdvcmsgY29tcG9uZW50IHR5cGVcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsYWJlbCBUaGUgbGFiZWwgZm9yIHRoZSBjb21wb25lbnRcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IHBvcnQgVGhlIG9wdGlvbmFsIHBvcnQgZm9yIHRoZSBuZXR3b3JrIGNvbXBvbmVudFxyXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gbWlkZGxld2FyZSBUaGUgbWlkZGxld2FyZSB0byBjYWxsIGZvciB0aGlzIHNlcnZpY2VcclxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uIGFuZCBmYWxzZSBvbiBmYWlsdXJlXHJcbiAgICAgKi9cclxuICAgIGFkZChzZXJ2aWNlSWQsIHNlcnZpY2VOYW1lc3BhY2UsIHR5cGUsIGxhYmVsLCBwb3J0LCBtaWRkbGV3YXJlKVxyXG4gICAge1xyXG4gICAgICAgIGxldCBjcmVhdGVkID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHJlc2VydmVQb3J0ID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGNyZWF0ZVBvcnQgPSBudWxsO1xyXG4gICAgICAgIGlmICh0aGlzLnBvcnRSZXNlcnZhdGlvbnMuaW5kZXhPZihwb3J0KSA9PSAtMSB8fCBwb3J0ID09IG51bGwgfHwgcG9ydCA9PSB1bmRlZmluZWQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZiAocG9ydCA9PSB1bmRlZmluZWQgfHwgcG9ydCA9PSBudWxsKSBwb3J0ID0gMDtcclxuICAgICAgICAgICAgc3dpdGNoKHR5cGUpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ05ldHdvcms6YWRkJywgNDAwLCAnVW5hYmxlIHRvIGxvYWQgY29tcG9uZW50IHR5cGUgb2Y6ICcgKyB0eXBlICsgJyBmb3IgU2VydmljZTogJyArIHNlcnZpY2VOYW1lc3BhY2UgKyAnIC0gU2VydmljZUlkOiAnICsgc2VydmljZUlkKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdyZXN0JzpcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkID0gdGhpcy5fY3JlYXRlUmVzdENvbXBvbmVudChzZXJ2aWNlSWQsIHNlcnZpY2VOYW1lc3BhY2UsIHBvcnQsIG1pZGRsZXdhcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnaHR0cCc6XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZCA9IHRoaXMuX2NyZWF0ZUh0dHBDb21wb25lbnQoc2VydmljZUlkLCBzZXJ2aWNlTmFtZXNwYWNlLCBwb3J0LCBtaWRkbGV3YXJlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3NvY2tldCc6XHJcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZCA9IHRoaXMuX2NyZWF0ZVNvY2tldENvbXBvbmVudChzZXJ2aWNlSWQsIHNlcnZpY2VOYW1lc3BhY2UsIHBvcnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnd2ViU29ja2V0JzpcclxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVkID0gdGhpcy5fY3JlYXRlV2ViU29ja2V0Q29tcG9uZW50KHNlcnZpY2VJZCwgc2VydmljZU5hbWVzcGFjZSwgcG9ydCwgbWlkZGxld2FyZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdhcGknOlxyXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWQgPSB0aGlzLl9jcmVhdGVBcGlDb21wb25lbnQoc2VydmljZUlkLCBzZXJ2aWNlTmFtZXNwYWNlKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGNyZWF0ZWQgPT09IGZhbHNlKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50cy5wdXNoKGNyZWF0ZWQpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudE1hcC5wdXNoKHNlcnZpY2VOYW1lc3BhY2UgKyAnLScgKyB0eXBlICsgJy0nICsgbGFiZWwgKyAnLScgKyBwb3J0KTtcclxuICAgICAgICAgICAgdGhpcy5jb21wb25lbnRUeXBlTWFwW3R5cGVdLnB1c2goc2VydmljZU5hbWVzcGFjZSArICctJyArIHR5cGUgKyAnLScgKyBwb3J0KTtcclxuICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ05ldHdvcms6YWRkJywgMjAwLCAnQWRkZWQgbmV0d29yayBjb21wb25lbnQ6ICcgKyB0eXBlICsgJyBmb3IgU2VydmljZTogJyArIHNlcnZpY2VOYW1lc3BhY2UgKyAnIC0gU2VydmljZUlkOiAnICsgc2VydmljZUlkKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBSRVNUIG5ldHdvcmsgY29tcG9uZW50XHJcbiAgICAgKlxyXG4gICAgICogQG5vdGUgQSBSRVNUIG5ldHdvcmsgY29tcG9uZW50IHVzZXMgdGhlIGh0dHAgMS4xIHN0YWNrIChleHByZXNzKVxyXG4gICAgICogQG5vdGUgV2hlbiB0aGUgcG9ydCBpcyBzZXQgdG8gMCBhIHJhbmRvbSBhdmFpbGFibGUgcG9ydCB3aWxsIGJlIGFzc2lnbmVkXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNlcnZpY2VJZCBUaGUgc2VydmljZXMgaWQgZnJvbSB0aGUgc2VydmljZSBzdGFja1xyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIGZvciB0aGUgc2VydmljZVxyXG4gICAgICogQHBhcmFtIHtudWxsfG51bWJlcn0gcG9ydCBUaGUgcG9ydCBmb3IgdGhlIHNlcnZpY2Ugb3IgbnVsbC5cclxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IG1pZGRsZXdhcmUgVGhlIG1pZGRsZXdhcmUgdG8gY2FsbCBmb3IgdGhpcyBzZXJ2aWNlXHJcbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyBjb21wb25lbnQgaWYgY3JlYXRlZCBvciBmYWxzZSBvbiBmYWlsdXJlXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBfY3JlYXRlUmVzdENvbXBvbmVudChzZXJ2aWNlSWQsIG5hbWVzcGFjZSwgcG9ydCwgbWlkZGxld2FyZSlcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY3JlYXRlSHR0cENvbXBvbmVudChzZXJ2aWNlSWQsIG5hbWVzcGFjZSwgcG9ydCwgbWlkZGxld2FyZSwgdHJ1ZSlcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBodHRwIG5ldHdvcmsgY29tcG9uZW50XHJcbiAgICAgKlxyXG4gICAgICogQG5vdGUgV2hlbiBhIHBvcnQgaXMgc2V0IGZvciBudWxsIGlmIHRoZSBjb21wb25lbnQgcmVxdWlyZXMgYSBwb3J0IHRvIGJlIGNyZWF0ZWQgdGhlIHNlcnZpY2Ugd2lsbCBhc3NpZ24gYSByYW5kb20gcG9ydC4gIFRoZSBzZXJ2aWNlIHdpbGwgbmVlZCB0byByZXRyaWV2ZSB0aGlzIGluZm9ybWF0aW9uIGFzIG5lZWRlZC5cclxuICAgICAqIEBub3RlIEEgaHR0cCBuZXR3b3JrIGNvbXBvbmVudCB1c2VzIHRoZSBodHRwIDEuMSBzdGFjayAoZXhwcmVzcylcclxuICAgICAqIEBub3RlIFdoZW4gdGhlIHBvcnQgaXMgc2V0IHRvIDAgYSByYW5kb20gYXZhaWxhYmxlIHBvcnQgd2lsbCBiZSBhc3NpZ25lZFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzZXJ2aWNlSWQgVGhlIHNlcnZpY2VzIGlkIGZyb20gdGhlIHNlcnZpY2Ugc3RhY2tcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lc3BhY2UgVGhlIG5hbWVzcGFjZSBmb3IgdGhlIHNlcnZpY2VcclxuICAgICAqIEBwYXJhbSB7bnVsbHxudW1iZXJ9IHBvcnQgVGhlIHBvcnQgZm9yIHRoZSBzZXJ2aWNlIG9yIG51bGwuXHJcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBtaWRkbGV3YXJlIFRoZSBtaWRkbGV3YXJlIHRvIGNhbGwgZm9yIHRoaXMgc2VydmljZVxyXG4gICAgICogQHBhcmFtIHtib29sZWFufHVuZGVmaW5lZH0gaXNSZXN0IENvbnRyb2xzIHRoZSByZXN0IGludGVyZmFjZSBmbGFnIHdoZW4gY3JlYXRpbmcgdGhlIGh0dHAgaW5zdGFuY2VcclxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIGNvbXBvbmVudCBpZiBjcmVhdGVkIG9yIGZhbHNlIG9uIGZhaWx1cmVcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIF9jcmVhdGVIdHRwQ29tcG9uZW50KHNlcnZpY2VJZCwgbmFtZXNwYWNlLCBwb3J0LCBtaWRkbGV3YXJlLCBpc1Jlc3QpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IHNldExpc3RlbmVyID0gdHJ1ZTtcclxuICAgICAgICBpZiAoaXNSZXN0ID09IHVuZGVmaW5lZCkgaXNSZXN0ID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHZhciBzZXJ2ZXIgPSBleHByZXNzKCk7XHJcbiAgICAgICAgc2VydmVyLnVzZShjb21wcmVzc2lvbih7fSkpO1xyXG5cclxuICAgICAgICB2YXIgY29tcG9uZW50ID0gc2VydmVyLmFsbCgnLycsIGZ1bmN0aW9uIChyZXEsIHJlcykge1xyXG4gICAgICAgICAgICB0aGlzLm1pZGRsZXdhcmUuY2FsbENoYW5uZWwoJ1BSRV9SRVFVRVNUJywgcmVxKTtcclxuICAgICAgICAgICAgdGhpcy5taWRkbGV3YXJlLmNhbGxDaGFubmVsKCdQUkVfUkVTUE9OU0UnLCByZXMpO1xyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VzW3NlcnZpY2VJZF0uc2VydmljZVJlcXVlc3QocmVxLCByZXMsIGlzUmVzdCA9PT0gZmFsc2UgPyAnaHR0cCcgOiAncmVzdCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5pc1BvcnRSZXNlcnZlZChwb3J0KSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNldExpc3RlbmVyID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGxldCBwb3MgPSB0aGlzLnBvcnRSZXNlcnZhdGlvbnMuaW5kZXhPZihwb3J0KTtcclxuICAgICAgICAgICAgbGV0IHNlcnZpY2VOYW1lc3BhY2UgPSB0aGlzLnBvcnRSZXNlcnZhdGlvbk5hbWVzcGFjZVtwb3NdO1xyXG4gICAgICAgICAgICBpZiAoc2VydmljZU5hbWVzcGFjZSAhPSBuYW1lc3BhY2UpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGdsb2JhbC5Mb2dnZXIubG9nKCdOZXR3b3JrOl9jcmVhdGVIdHRwQ29tcG9uZW50JywgNDAwLCAnVW5hYmxlIHRvIGNyZWF0ZSBuZXcgaHR0cCBjb21wb25lbnQgLSBQb3J0IFJlc2VydmVkIGJ5IGFub3RoZXIgc2VydmljZS4gQXR0ZW1wdGVkIHRvIG1vdW50OiAnICsgbmFtZXNwYWNlICsgJyAvIFNlcnZpY2VJZDogJyArIHNlcnZpY2VJZCArICcgLSBFeGlzdGluZyBzZXJ2aWNlIGFzc2lnbmVkIHRvIHBvcnQ6ICcgKyBzZXJ2aWNlTmFtZXNwYWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHsgdHlwZTogaXNSZXN0ID09PSBmYWxzZSA/ICdodHRwJyA6ICdyZXN0JyB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKF8uaXNGdW5jdGlvbihtaWRkbGV3YXJlKSkgY29tcG9uZW50LnVzZShtaWRkbGV3YXJlKTtcclxuXHJcbiAgICAgICAgaWYgKHNldExpc3RlbmVyKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gY29tcG9uZW50Lmxpc3Rlbihwb3J0LCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBOZXR3b3JrU3RhY2suYWRkUG9ydFJlc2VydmF0aW9uKG5hbWVzcGFjZSwgbGlzdGVuZXIuYWRkcmVzcygpLnBvcnQpO1xyXG4gICAgICAgICAgICAgICAgZ2xvYmFsLkNvbnNvbGUuc3RhdHVzKCdpbmZvJywgJ0h0dHAgQm91bmQgVHlwZTogJyArIChpc1Jlc3QgPT09IGZhbHNlID8gJ2h0dHAnIDogJ3Jlc3QnKSArICcgLSBTZXJ2aWNlOiAnICsgbmFtZXNwYWNlICsgJyAtICcgKyAocG9ydCA9PSAwID8gJ1JhbmRvbSAnIDogJycpICsgJ1BvcnQ6ICcgKyBsaXN0ZW5lci5hZGRyZXNzKCkucG9ydCk7XHJcbiAgICAgICAgICAgICAgICBnbG9iYWwuTG9nZ2VyLmxvZygnTmV0d29yazpfY3JlYXRlSHR0cENvbXBvbmVudCcsIDIwMCwgJ0NyZWF0ZWQgbmV3IGh0dHAgY29tcG9uZW50IC0gTW91bnRlZDogJyArIG5hbWVzcGFjZSArICcgLyBTZXJ2aWNlSWQ6ICcgKyBzZXJ2aWNlSWQgKyAnIC0gbGlzdGVuaW5nIG9uICcgKyAocG9ydCA9PSAwID8gJ1JhbmRvbSAnIDogJycpICsgJ1BvcnQ6ICcgKyBsaXN0ZW5lci5hZGRyZXNzKCkucG9ydCxcclxuICAgICAgICAgICAgICAgICAgICB7IHR5cGU6IGlzUmVzdCA9PT0gZmFsc2UgPyAnaHR0cCcgOiAncmVzdCcgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGNvbXBvbmVudDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSB3ZWIgc29ja2V0IG5ldHdvcmsgY29tcG9uZW50XHJcbiAgICAgKlxyXG4gICAgICogQG5vdGUgVXNlcyBzb2NrZXQgaW8vZXhwcmVzcyBmb3Igd2ViIHNvY2tldCBzZXJ2ZXJcclxuICAgICAqIEBub3RlIFdoZW4gdGhlIHBvcnQgaXMgc2V0IHRvIDAgYSByYW5kb20gYXZhaWxhYmxlIHBvcnQgd2lsbCBiZSBhc3NpZ25lZFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzZXJ2aWNlSWQgVGhlIHNlcnZpY2VzIGlkIGZyb20gdGhlIHNlcnZpY2Ugc3RhY2tcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lc3BhY2UgVGhlIG5hbWVzcGFjZSBmb3IgdGhlIHNlcnZpY2VcclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBwb3J0IFRoZSBwb3J0IGZvciB0aGUgd2ViIHNvY2tldCBjb21wb25lbnRcclxuICAgICAqIEBwYXJhbSB7ZnVuY3Rpb259IG1pZGRsZXdhcmUgVGhlIG1pZGRsZXdhcmUgdG8gY2FsbCBmb3IgdGhpcyBzZXJ2aWNlXHJcbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyBjb21wb25lbnQgaWYgY3JlYXRlZCBvciBmYWxzZSBvbiBmYWlsdXJlXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBfY3JlYXRlV2ViU29ja2V0Q29tcG9uZW50KHNlcnZpY2VJZCwgbmFtZXNwYWNlLCBwb3J0LCBtaWRkbGV3YXJlKVxyXG4gICAge1xyXG4gICAgICAgIGxldCBzZXRMaXN0ZW5lciA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNQb3J0UmVzZXJ2ZWQocG9ydCkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBzZXRMaXN0ZW5lciA9IGZhbHNlO1xyXG4gICAgICAgICAgICBsZXQgcG9zID0gdGhpcy5wb3J0UmVzZXJ2YXRpb25zLmluZGV4T2YocG9ydCk7XHJcbiAgICAgICAgICAgIGxldCBzZXJ2aWNlTmFtZXNwYWNlID0gdGhpcy5wb3J0UmVzZXJ2YXRpb25OYW1lc3BhY2VbcG9zXTtcclxuICAgICAgICAgICAgaWYgKHNlcnZpY2VOYW1lc3BhY2UgIT0gbmFtZXNwYWNlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBnbG9iYWwuTG9nZ2VyLmxvZygnTmV0d29yazpfY3JlYXRlUmVzdENvbXBvbmVudCcsIDQwMCwgJ1VuYWJsZSB0byBjcmVhdGUgY29tcG9uZW50IC0gUG9ydCBSZXNlcnZlZCBieSBhbm90aGVyIHNlcnZpY2UuIEF0dGVtcHRlZCB0byBtb3VudDogJyArIG5hbWVzcGFjZSArICcgLyBTZXJ2aWNlSWQ6ICcgKyBzZXJ2aWNlSWQgKyAnIC0gRXhpc3Rpbmcgc2VydmljZSBhc3NpZ25lZCB0byBwb3J0OiAnICsgc2VydmljZU5hbWVzcGFjZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vY3JlYXRlIHdlYlNvY2tldCBjb21wb25lbnRcclxuICAgICAgICB2YXIgc2VydmVyID0gZXhwcmVzcygpO1xyXG4gICAgICAgIHNlcnZlci51c2UoY29tcHJlc3Npb24oe30pKTtcclxuXHJcbiAgICAgICAgdmFyIGh0dHBTZXJ2ZXIgPSBodHRwLlNlcnZlcihzZXJ2ZXIpO1xyXG4gICAgICAgIHZhciB3ZWJTb2NrZXQgPSBuZXcgU29ja2V0SU8oaHR0cFNlcnZlcik7XHJcblxyXG4gICAgICAgIGxldCB1c2VycyA9IFtdO1xyXG4gICAgICAgIGxldCBzb2NrZXRzID0ge307XHJcblxyXG4gICAgICAgIHdlYlNvY2tldC51c2UoY29tcHJlc3Npb24oe30pKTtcclxuICAgICAgICAvL2FwcC51c2UoZXhwcmVzc1snc3RhdGljJ10oX19kaXJuYW1lICsgJy8uLi8uLi9jbGllbnQnKSk7XHJcblxyXG4gICAgICAgIHdlYlNvY2tldC5vbignY29ubmVjdGlvbicsIChzb2NrZXQpID0+IHtcclxuICAgICAgICAgICAgbGV0IHVzZXJJZCA9IHNvY2tldC5oYW5kc2hha2UucXVlcnkudXNlcklkO1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudFVzZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBpZDogc29ja2V0LmlkLFxyXG4gICAgICAgICAgICAgICAgdXNlcklkOiB1c2VySWRcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIGlmIChmaW5kSW5kZXgodXNlcnMsIGN1cnJlbnRVc2VyLmlkKSA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0lORk9dIFVzZXIgSUQgaXMgYWxyZWFkeSBjb25uZWN0ZWQsIGtpY2tpbmcuJyk7XHJcbiAgICAgICAgICAgICAgICBzb2NrZXQuZGlzY29ubmVjdCgpO1xyXG4gICAgICAgICAgICB9ICAvKmVsc2UgaWYgKCF2YWxpZE5pY2soY3VycmVudFVzZXIubmljaykpIHtcclxuICAgICAgICAgICAgICAgIHNvY2tldC5kaXNjb25uZWN0KCk7XHJcbiAgICAgICAgICAgIH0qLyBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbSU5GT10gVXNlciBJRDogJyArIGN1cnJlbnRVc2VyLnVzZXJJZCArICcgY29ubmVjdGVkIScpO1xyXG4gICAgICAgICAgICAgICAgc29ja2V0c1tjdXJyZW50VXNlci5pZF0gPSBzb2NrZXQ7XHJcbiAgICAgICAgICAgICAgICB1c2Vycy5wdXNoKGN1cnJlbnRVc2VyKTtcclxuICAgICAgICAgICAgICAgIHdlYlNvY2tldC5lbWl0KCdVc2VyIEpvaW4nLCB7IHVzZXJJZDogY3VycmVudFVzZXIudXNlcklkIH0pO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1tJTkZPXSBUb3RhbCB1c2VyczogJyArIHVzZXJzLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHNvY2tldC5vbignZGluZycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHNvY2tldC5lbWl0KCdkb25nJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgc29ja2V0Lm9uKCdkaXNjb25uZWN0JywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbmRJbmRleCh1c2VycywgY3VycmVudFVzZXIuaWQpID4gLTEpIHVzZXJzLnNwbGljZShmaW5kSW5kZXgodXNlcnMsIGN1cnJlbnRVc2VyLmlkKSwgMSk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnW0lORk9dIFVzZXIgJyArIGN1cnJlbnRVc2VyLnVzZXJJZCArICcgZGlzY29ubmVjdGVkIScpO1xyXG4gICAgICAgICAgICAgICAgc29ja2V0LmJyb2FkY2FzdC5lbWl0KCd1c2VyRGlzY29ubmVjdCcsIHsgdXNlcklkOiBjdXJyZW50VXNlci51c2VySWQgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy9CaW5kIHRoZSBldmVudHMgY29udGFpbmVkIHdpdGhpbiB0aGUgc2VydmljZSB0byB0aGlzIHNvY2tldFxyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VzW3NlcnZpY2VJZF0uc2V0V2ViU29ja2V0RXZlbnRzKHNvY2tldCk7XHJcblxyXG4gICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICBzb2NrZXQub24oJ2FjdGlvbicsIChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgX25pY2sgPSBzYW5pdGl6ZVN0cmluZyhkYXRhLm5pY2spO1xyXG4gICAgICAgICAgICAgICAgbGV0IF9tZXNzYWdlID0gc2FuaXRpemVTdHJpbmcoZGF0YS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIGxldCBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgICAgIGxldCB0aW1lID0gKFwiMFwiICsgZGF0ZS5nZXRIb3VycygpKS5zbGljZSgtMikgKyAoXCIwXCIgKyBkYXRlLmdldE1pbnV0ZXMoKSkuc2xpY2UoLTIpO1xyXG5cclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdbQ0hBVF0gWycgKyB0aW1lICsgJ10gJyArIF9uaWNrICsgJzogJyArIF9tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIHNvY2tldC5icm9hZGNhc3QuZW1pdCgnc2VydmVyU2VuZFVzZXJDaGF0Jywge25pY2s6IF9uaWNrLCBtZXNzYWdlOiBfbWVzc2FnZX0pO1xyXG4gICAgICAgICAgICB9KTsqL1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgbGlzdGVuZXIgPSBodHRwU2VydmVyLmxpc3Rlbihwb3J0LCAoKSA9PiB7XHJcbiAgICAgICAgICAgIE5ldHdvcmtTdGFjay5hZGRQb3J0UmVzZXJ2YXRpb24obmFtZXNwYWNlLCBsaXN0ZW5lci5hZGRyZXNzKCkucG9ydCk7XHJcbiAgICAgICAgICAgIGdsb2JhbC5Db25zb2xlLnN0YXR1cygnaW5mbycsICdXZWIgU29ja2V0IEJvdW5kIC0gU2VydmljZTogJyArIG5hbWVzcGFjZSArICcgLSAnICsgKHBvcnQgPT0gMCA/ICdSYW5kb20gJyA6ICcnKSArICdQb3J0OiAnICsgbGlzdGVuZXIuYWRkcmVzcygpLnBvcnQpO1xyXG4gICAgICAgICAgICBnbG9iYWwuTG9nZ2VyLmxvZygnTmV0d29yazpfY3JlYXRlV2ViU29ja2V0Q29tcG9uZW50JywgMjAwLCAnQ3JlYXRlZCBuZXcgd2ViIHNvY2tldCBjb21wb25lbnQgLSBNb3VudGVkOiAnICsgbmFtZXNwYWNlICsgJyAvIFNlcnZpY2VJZDogJyArIHNlcnZpY2VJZCArICcgLSBsaXN0ZW5pbmcgb24gJyArIChwb3J0ID09IDAgPyAnUmFuZG9tICcgOiAnJykgKyAnUG9ydDogJyArIGxpc3RlbmVyLmFkZHJlc3MoKS5wb3J0KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHdlYlNvY2tldDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYSBUQ1AvSVAgc29ja2V0IG5ldHdvcmsgY29tcG9uZW50XHJcbiAgICAgKlxyXG4gICAgICogQG5vdGUgV2hlbiB0aGUgcG9ydCBpcyBzZXQgdG8gMCBhIHJhbmRvbSBhdmFpbGFibGUgcG9ydCB3aWxsIGJlIGFzc2lnbmVkXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNlcnZpY2VJZCBUaGUgc2VydmljZXMgaWQgZnJvbSB0aGUgc2VydmljZSBzdGFja1xyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIGZvciB0aGUgc2VydmljZVxyXG4gICAgICogQHBhcmFtIHBvcnQgVGhlIHBvcnQgZm9yIHRoZSBUQ1AvSVAgc29ja2V0IGNvbXBvbmVudFxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uIGFuZCBmYWxzZSBvbiBlcnJvclxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgX2NyZWF0ZVNvY2tldENvbXBvbmVudChzZXJ2aWNlSWQsIG5hbWVzcGFjZSwgcG9ydClcclxuICAgIHtcclxuICAgICAgICBsZXQgc2V0TGlzdGVuZXIgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLmlzUG9ydFJlc2VydmVkKHBvcnQpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgc2V0TGlzdGVuZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgbGV0IHBvcyA9IHRoaXMucG9ydFJlc2VydmF0aW9ucy5pbmRleE9mKHBvcnQpO1xyXG4gICAgICAgICAgICBsZXQgc2VydmljZU5hbWVzcGFjZSA9IHRoaXMucG9ydFJlc2VydmF0aW9uTmFtZXNwYWNlW3Bvc107XHJcbiAgICAgICAgICAgIGlmIChzZXJ2aWNlTmFtZXNwYWNlICE9IG5hbWVzcGFjZSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ05ldHdvcms6X2NyZWF0ZVNvY2tldENvbXBvbmVudCcsIDQwMCwgJ1VuYWJsZSB0byBjcmVhdGUgbmV3IHNvY2tldCBjb21wb25lbnQgLSBQb3J0IFJlc2VydmVkIGJ5IGFub3RoZXIgc2VydmljZS4gQXR0ZW1wdGVkIHRvIG1vdW50OiAnICsgbmFtZXNwYWNlICsgJyAvIFNlcnZpY2VJZDogJyArIHNlcnZpY2VJZCArICcgLSBFeGlzdGluZyBzZXJ2aWNlIGFzc2lnbmVkIHRvIHBvcnQ6ICcgKyBzZXJ2aWNlTmFtZXNwYWNlLFxyXG4gICAgICAgICAgICAgICAgICAgIHsgdHlwZTogaXNSZXN0ID09PSBmYWxzZSA/ICdodHRwJyA6ICdyZXN0JyB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHNlcnZlciA9IG5ldC5jcmVhdGVTZXJ2ZXIoKHNvY2tldCkgPT4ge1xyXG4gICAgICAgICAgICAvLyAnY29ubmVjdGlvbicgbGlzdGVuZXJcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NsaWVudCBjb25uZWN0ZWQnKTtcclxuICAgICAgICAgICAgc29ja2V0Lm9uKCdlbmQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2xpZW50IGRpc2Nvbm5lY3RlZCcpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgc29ja2V0LndyaXRlKCdoZWxsb1xcclxcbicpO1xyXG4gICAgICAgICAgICBzb2NrZXQucGlwZShzb2NrZXQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzZXJ2ZXIub24oJ2Vycm9yJywgKGVycikgPT4ge1xyXG4gICAgICAgICAgICAvL3Rocm93IGVycjtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0Egc29ja2V0IGVycm9yIGhhcyBvY2N1cnJlZCcpO1xyXG4gICAgICAgICAgICBnbG9iYWwuTG9nZ2VyLmxvZygnTmV0d29yazpfY3JlYXRlU29ja2V0Q29tcG9uZW50JywgNDAwLCAnQSBzb2NrZXQgZXJyb3IgaGFzIG9jY3VycmVkIGluIFNlcnZpY2U6ICcgKyBuYW1lcHNhY2UgKyAnIC0gU2VydmljZSBJZDogJyArIHNlcnZpY2VJZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmIChzZXRMaXN0ZW5lcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHZhciBsaXN0ZW5lciA9IHNlcnZlci5saXN0ZW4ocG9ydCwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgTmV0d29ya1N0YWNrLmFkZFBvcnRSZXNlcnZhdGlvbihuYW1lc3BhY2UsIGxpc3RlbmVyLmFkZHJlc3MoKS5wb3J0KTtcclxuICAgICAgICAgICAgICAgIGdsb2JhbC5Db25zb2xlLnN0YXR1cygnaW5mbycsICdUQ1AvSVAgU29ja2V0IEJvdW5kIC0gU2VydmljZTogJyArIG5hbWVzcGFjZSArICcgLSAnICsgKHBvcnQgPT0gMCA/ICdSYW5kb20gJyA6ICcnKSArICdQb3J0OiAnICsgbGlzdGVuZXIuYWRkcmVzcygpLnBvcnQpO1xyXG4gICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ05ldHdvcms6X2NyZWF0ZVNvY2tldENvbXBvbmVudCcsIDIwMCwgJ0NyZWF0ZWQgbmV3IFRDUC9JUCBzb2NrZXQgY29tcG9uZW50IC0gTW91bnRlZDogJyArIG5hbWVzcGFjZSArICcgLyBTZXJ2aWNlSWQ6ICcgKyBzZXJ2aWNlSWQgKyAnIC0gbGlzdGVuaW5nIG9uICcgKyAocG9ydCA9PSAwID8gJ1JhbmRvbSAnIDogJycpICsgJ1BvcnQ6ICcgKyBsaXN0ZW5lci5hZGRyZXNzKCkucG9ydCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc2VydmVyO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIGFuIEFQSSBleHRlbnNpb24gY29tcG9uZW50XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNlcnZpY2VJZCBUaGUgc2VydmljZXMgaWQgZnJvbSB0aGUgc2VydmljZSBzdGFja1xyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgbmFtZXNwYWNlIGZvciB0aGUgc2VydmljZVxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uIGFuZCBmYWxzZSBvbiBlcnJvclxyXG4gICAgICogQHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgX2NyZWF0ZUFwaUNvbXBvbmVudChzZXJ2aWNlSWQsIG5hbWVzcGFjZSlcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5hcGkuYWRkQXBpTm9kZShzZXJ2aWNlSWQsIG5hbWVzcGFjZSwgdGhpcy5zZXJ2aWNlc1tzZXJ2aWNlSWRdLmFwaVJlcXVlc3QpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyBhIHNlcnZpY2UgbmV0d29yayBjb21wb25lbnRcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc2VydmljZU5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2UgZm9yIHRoZSBjb21wb25lbnRcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFRoZSBuZXR3b3JrIGNvbXBvbmVudCB0eXBlXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGFiZWwgVGhlIGxhYmVsIGZvciB0aGUgY29tcG9uZW50XHJcbiAgICAgKiBAcmV0dXJuIHtib29sZWFufSBSZXR1cm5zIHRydWUgb24gY29tcGxldGlvbiBhbmQgZmFsc2Ugb24gZmFpbHVyZVxyXG4gICAgICogQHRvZG8gTmVlZCB0byBjb21wbGV0ZSB0aGlzXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZShzZXJ2aWNlTmFtZXNwYWNlLCB0eXBlLCBsYWJlbClcclxuICAgIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlIHBvcnQgaXMgcmVzZXJ2ZWRcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcG9ydCBUaGUgcG9ydCBudW1iZXJcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRydWUgaWYgdGhlIHBvcnQgaXMgcmVzZXJ2ZWQgZmFsc2UgaWYgaXQgaXMgbm90XHJcbiAgICAgKi9cclxuICAgIGlzUG9ydFJlc2VydmVkKHBvcnQpXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucG9ydFJlc2VydmF0aW9ucy5pbmRleE9mKHBvcnQpID4gLTE7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgcG9ydCByZXNlcnZhdGlvbiB0byB0aGUgbmV0d29yayBzdGFja1xyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2UgZm9yIHRoZSByZXNlcnZlZCBwb3J0XHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gcG9ydCBUaGUgcG9ydCBudW1iZXJcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIHRydWUgb24gY29tcGxldGlvblxyXG4gICAgICovXHJcbiAgICBhZGRQb3J0UmVzZXJ2YXRpb24obmFtZXNwYWNlLCBwb3J0KVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMucG9ydFJlc2VydmF0aW9ucy5wdXNoKHBvcnQpO1xyXG4gICAgICAgIHRoaXMucG9ydFJlc2VydmF0aW9uTmFtZXNwYWNlLnB1c2gobmFtZXNwYWNlKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufVxyXG5cclxuLypcclxuICogRXhwb3J0c1xyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBUaGUgbmV0d29yayBzdGFjayBzaW5nbGV0b24gaW5zdGFuY2VcclxuICogQHR5cGUge05ldHdvcmt9XHJcbiAqL1xyXG52YXIgTmV0d29ya1N0YWNrID0gbmV3IE5ldHdvcmsoKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IE5ldHdvcmtTdGFjaztcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnQvbmV0d29yay5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImxvZGFzaFwiKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIFwibG9kYXNoXCJcbiAqKiBtb2R1bGUgaWQgPSA4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvKipcclxuICogR29yZ29uIHRoZSBzY3JpcHRpbmcgY2FwYWJsZSBuZXR3b3JrIHNlcnZlciBmb3IgTm9kZSBKU1xyXG4gKlxyXG4gKiBAcGFja2FnZSBHb3Jnb25cclxuICogQGF1dGhvciBSeWFuIFJlbnRmcm9cclxuICogQGxpY2Vuc2UgTUlUXHJcbiAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL21hbnVmYWN0dXJpbmctaW5kdXN0cnlcclxuICovXHJcblxyXG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xyXG5cclxuLyoqXHJcbiAqIFRoZSBtaWRkbGV3YXJlIGNsYXNzXHJcbiAqXHJcbiAqIE1hbmFnZXMgbWlkZGxld2FyZSBmb3IgdGhlIHN5c3RlbSBmb3Igc3BlY2lmaWMgc3lzdGVtIGludGVyYWN0aW9uc1xyXG4gKlxyXG4gKiBAbm90ZSBNaWRkbGV3YXJlIGFyZSBsaW1pdGVkIHRvIDEgbWlkZGxld2FyZSBhc3NpZ25lZCB0byBhIGNoYW5uZWwtPnNlcnZpY2UgbmFtZXNwYWNlLT5taWRkbGV3YXJlXHJcbiAqIEBub3RlIFRoaXMgbWVhbnMgdGhhdCB5b3UgaGF2ZSAxIG1ldGhvZCBhc3NpZ25hYmxlIHRvIGEgY2hhbm5lbCBwZXIgc2VydmljZSBwZXIgbWlkZGxld2FyZVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE1pZGRsZXdhcmUge1xyXG4gICAgY29uc3RydWN0b3IoKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xyXG4gICAgICAgIHRoaXMuc2VydmljZVJlZ2lzdGVyID0gW107XHJcbiAgICAgICAgdGhpcy5kYXRhTWFwID0gW107XHJcbiAgICAgICAgdGhpcy5jaGFubmVscyA9IFsnUFJFX1JFUVVFU1QnLCAnUFJFX1JFU1BPTlNFJywgJ1BSRV9BUElfQ0FMTCcsICdQT1NUX0FQSV9DQUxMJ107XHJcbiAgICAgICAgdGhpcy5jaGFubmVscy5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKXtcclxuICAgICAgICAgICAgdGhpcy5kYXRhLnB1c2goW10pO1xyXG4gICAgICAgICAgICB0aGlzLmRhdGFNYXAucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgfSwgdGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgbWlkZGxld2FyZSB0byB0aGUgc2VydmVyIGJhc2VkIG9uIGEgbWlkZGxld2FyZSBjaGFubmVsXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGNoYW5uZWwgVGhlIGxhYmVsIGZvciB0aGUgY2hhbm5lbFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VOYW1lc3BhY2UgVGhlIHNlcnZpY2UgbmFtZXNwYWNlIGZvciB0aGUgbWlkZGxld2FyZVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1pZGRsZXdhcmUgVGhlIGNsYXNzIG5hbWUgb2YgdGhlIG1pZGRsZXdhcmUgdG8gYmUgdXNlZFxyXG4gICAgICogQHBhcmFtIHtmdW5jdGlvbn0gbWV0aG9kIFRoZSBtZXRob2QgdG8gYmUgY2FsbGVkIHdpdGggdGhlIG9iamVjdCB3aGVuIGEgY2hhbm5lbCBjYWxsIGlzIG1hZGVcclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICovXHJcbiAgICBhZGRNaWRkbGV3YXJlKGNoYW5uZWwsIHNlcnZpY2VOYW1lc3BhY2UsIG1pZGRsZXdhcmUsIG1ldGhvZClcclxuICAgIHtcclxuICAgICAgICBsZXQgcG9zID0gdGhpcy5fZ2V0Q2hhbm5lbElkKGNoYW5uZWwpO1xyXG4gICAgICAgIGlmIChwb3MgPiAtMSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGxldCBtaWRkbGV3YXJlID0gdGhpcy5fZ2V0RXhpc3RpbmdNaWRkbGV3YXJlKGNoYW5uZWxbcG9zXSwgc2VydmljZU5hbWVzcGFjZSwgbWlkZGxld2FyZSwgbWV0aG9kKTtcclxuICAgICAgICAgICAgaWYgKG1pZGRsZXdhcmUgPT09IGZhbHNlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5uZWxzW3Bvc10ucHVzaCh7IHNlcnZpY2U6IHNlcnZpY2VOYW1lc3BhY2UsIG1pZGRsZXdhcmU6IG1pZGRsZXdhcmUsIG1ldGhvZDogbWV0aG9kIH0pO1xyXG4gICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ01pZGRsZXdhcmU6YWRkTWlkZGxld2FyZScsIDIwMCwgJ0EgbmV3IG1pZGRsZXdhcmUgd2FzIGFkZGVkIGZvciBTZXJ2aWNlIE5hbWVzcGFjZTogJyArIHNlcnZpY2VOYW1lc3BhY2UgKyAnIG9uIENoYW5uZWw6ICcgKyBjaGFubmVsKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZ2xvYmFsLkxvZ2dlci5sb2coJ01pZGRsZXdhcmU6YWRkTWlkZGxld2FyZScsIDMwMCwgJ0F0dGVtcHRlZCB0byBhZGQgZHVwbGljYXRlIG1pZGRsZXdhcmUgZm9yIFNlcnZpY2UgTmFtZXNwYWNlOiAnICsgc2VydmljZU5hbWVzcGFjZSArICcgb24gQ2hhbm5lbDogJyArIGNoYW5uZWwgKyAnIGZvciBtaWRkbGV3YXJlOiAnICsgbWlkZGxld2FyZSArICcgd2l0aCBtZXRob2Q6ICcgKyBtZXRob2QpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdsb2JhbC5Mb2dnZXIubG9nKCdNaWRkbGV3YXJlOmFkZE1pZGRsZXdhcmUnLCA0MDAsICdBdHRlbXB0ZWQgdG8gYWRkIGEgbWlkZGxld2FyZSBmb3Igbm9uLWV4aXN0ZW50IGNoYW5uZWw6ICcgKyBjaGFubmVsICsgJyAtIGZvciBTZXJ2aWNlIE5hbWVzcGFjZTogJyArIHNlcnZpY2VOYW1lc3BhY2UpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyBhIHJlZ2lzdGVyZWQgbWlkZGxld2FyZSBmcm9tIHRoZSBzZXJ2ZXJcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gY2hhbm5lbFxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VOYW1lc3BhY2VcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtaWRkbGV3YXJlXHJcbiAgICAgKi9cclxuICAgIHJlbW92ZU1pZGRsZXdhcmUoY2hhbm5lbCwgc2VydmljZU5hbWVzcGFjZSwgbWlkZGxld2FyZSlcclxuICAgIHtcclxuICAgICAgICBsZXQgcG9zID0gdGhpcy5fZ2V0Q2hhbm5lbElkKGNoYW5uZWwpO1xyXG4gICAgICAgIGlmIChwb3MgPiAtMSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBAdG9kbyBBZGQgUmVtb3ZlIG1pZGRsZXdhcmUgY29kZVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxscyBhIGNoYW5uZWxzIGFzc2lnbmVkIG1pZGRsZXdhcmUgd2l0aCB0aGUgZGF0YSBhbmQgcmV0dXJucyB0aGUgZGF0YVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBjaGFubmVsIFRoZSBuYW1lIG9mIHRoZSBjaGFubmVsXHJcbiAgICAgKiBAcGFyYW0geyp9IGRhdGEgVGhlIG9iamVjdCBvciBkYXRhIHRvIGJlIHBhc3NlZCB0byB0aGUgbWlkZGxld2FyZVxyXG4gICAgICogQHJldHVybnMgeyp8Ym9vbGVhbn0gUmV0dXJucyB0aGUgZGF0YSBmcm9tIHRoZSBtaWRkbGV3YXJlIGNhbGwgZm9yIHRoZSBkYXRhIHNlbnRcclxuICAgICAqL1xyXG4gICAgY2FsbENoYW5uZWwoY2hhbm5lbCwgZGF0YSlcclxuICAgIHtcclxuICAgICAgICBsZXQgcG9zID0gdGhpcy5fZ2V0Q2hhbm5lbElkKGNoYW5uZWwpO1xyXG4gICAgICAgIGlmIChwb3MgPiAtMSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGxldCBtaWRkbGV3YXJlTGlzdCA9IHRoaXMuY2hhbm5lbHNbcG9zXTtcclxuICAgICAgICAgICAgaWYgKG1pZGRsZXdhcmVMaXN0IGluc3RhbmNlb2YgQXJyYXkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG1pZGRsZXdhcmVMaXN0LmZvcmVhY2goZnVuY3Rpb24odmFsdWUpe1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGEgPSB2YWx1ZS5tZXRob2QoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBnbG9iYWwuTG9nZ2VyLmxvZygnTWlkZGxld2FyZTpjYWxsQ2hhbm5lbCcsIDQwMCwgJ0F0dGVtcHRlZCB0byBjYWxsIGEgbm9uLWV4aXN0ZW50IGNoYW5uZWw6ICcgKyBjaGFubmVsICsgJyAtIGZvciBTZXJ2aWNlIE5hbWVzcGFjZTogJyArIHNlcnZpY2VOYW1lc3BhY2UpO1xyXG4gICAgICAgIHJldHVybiBkYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2tzIGZvciBhbiBleGlzdGluZyBtaWRkbGV3YXJlIGZvciBhIGdpdmVuIGNoYW5uZWxPYmplY3QsIHNlcnZpY2VOYW1lc3BhY2UsIGFuZCBtaWRkbGV3YXJlXHJcbiAgICAgKlxyXG4gICAgICogQG5vdGUgVGhpcyBtZXRob2QgZW5zdXJlcyB3ZSBsb2NrIHRoZSBhc3NpZ25lZCBtaWRkbGV3YXJlIGZvciBhIGdpdmVuIGNoYW5uZWwvc2VydmljZSBuYW1lc3BhY2UvbWlkZGxld2FyZVxyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGNoYW5uZWxPYmplY3QgVGhlIGNoYW5uZWwgb2JqZWN0IGZyb20gdGhlIG1pZGRsZXdhcmUgZGF0YSBzdGFja1xyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNlcnZpY2VOYW1lc3BhY2UgVGhlIHNlcnZpY2UgbmFtZXNwYWNlIGZvciB0aGUgbWlkZGxld2FyZVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1pZGRsZXdhcmUgVGhlIGNsYXNzIG5hbWUgb2YgdGhlIG1pZGRsZXdhcmUgdG8gYmUgdXNlZFxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW58YXJyYXl9IFJldHVybnMgZmFsc2UgaWYgY2hhbm5lbCBkb2Vzbid0IGV4aXN0IG9yIHRoZSBjaGFubmVsIGRhdGFzIGFycmF5IGlmIGl0IGRvZXNcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIF9nZXRFeGlzdGluZ01pZGRsZXdhcmUoY2hhbm5lbE9iamVjdCwgc2VydmljZU5hbWVzcGFjZSwgbWlkZGxld2FyZSlcclxuICAgIHtcclxuICAgICAgICBsZXQgZXhpc3RpbmcgPSBfLmZpbmQoY2hhbm5lbE9iamVjdCwgeyAnc2VydmljZU5hbWVzcGFjZSc6IHNlcnZpY2VOYW1lc3BhY2UsICdtaWRkbGV3YXJlJzogbWlkZGxld2FyZSB9KTtcclxuICAgICAgICBpZiAoZXhpc3RpbmcgIT0gdW5kZWZpbmVkKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIGV4aXN0aW5nO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTG9jYXRlcyBhIGNoYW5uZWwgaWQgZnJvbSB0aGUgY2hhbm5lbHMgbmFtZVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBjaGFubmVsXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgY2hhbm5lbCAoLTEgaWYgY2hhbm5lbCBkb2VzIG5vdCBleGlzdClcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIF9nZXRDaGFubmVsSWQobmFtZSlcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jaGFubmVscy5pbmRleE9mKG5hbWUudG9VcHBlcik7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFeHBvcnQgdGhlIG1pZGRsZXdhcmUgY2xhc3MgYXMgZGVmYXVsdFxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgTWlkZGxld2FyZTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9jb21wb25lbnQvbWlkZGxld2FyZS5qc1xuICoqLyIsIi8qKlxyXG4gKiBHb3Jnb24gdGhlIHNjcmlwdGluZyBjYXBhYmxlIG5ldHdvcmsgc2VydmVyIGZvciBOb2RlIEpTXHJcbiAqXHJcbiAqIEBwYWNrYWdlIEdvcmdvblxyXG4gKiBAYXV0aG9yIFJ5YW4gUmVudGZyb1xyXG4gKiBAbGljZW5zZSBNSVRcclxuICogQHVybCBodHRwczovL2dpdGh1Yi5jb20vbWFudWZhY3R1cmluZy1pbmR1c3RyeVxyXG4gKi9cclxuXHJcbmxldCBpbnN0YW5jZSA9IG51bGw7XHJcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0IE1pZGRsZXdhcmUgZnJvbSAnLi9taWRkbGV3YXJlJztcclxuXHJcbi8qKlxyXG4gKiBUaGUgYXBpIGNsYXNzXHJcbiAqXHJcbiAqIEBub3RlIFRoaXMgcG93ZXJzIHRoZSBleHRlbnNpYmxlIGludGVybmFsIEFQSVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFwaVxyXG57XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKClcclxuICAgIHtcclxuICAgICAgICBpZighaW5zdGFuY2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogVGhlIG1pZGRsZXdhcmUgZm9yIHRoZSBjbGFzc1xyXG4gICAgICAgICAgICAgKiBAdHlwZSB7TWlkZGxld2FyZX1cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMubWlkZGxld2FyZSA9IG5ldyBNaWRkbGV3YXJlKCk7XHJcblxyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogQ29udGFpbnMgdGhlIGFwaSBub2RlIHJlZmVyZW5jZXNcclxuICAgICAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdGhpcy5hcGkgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBDb250YWlucyB0aGUgYXBpIG5vZGUgbWFwXHJcbiAgICAgICAgICAgICAqIEBub3RlIFRoZSBhcGkgbWFwIGlzIGFsc28gdXNlZCBmb3IgcmVzZXJ2aW5nIGFwaSBlbmRwb2ludHNcclxuICAgICAgICAgICAgICogQHR5cGUge0FycmF5fVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdGhpcy5hcGlNYXAgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBNYXBzIHRoZSBzZXJ2aWNlIGlkJ3MgdG8gdGhlIGFwaVxyXG4gICAgICAgICAgICAgKiBAdHlwZSB7QXJyYXl9XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VJZE1hcCA9IFtdO1xyXG5cclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIFJlc2VydmVkIHdvcmRzIHRoYXQgY2FuIG5vdCBiZSByZWdpc3RlcmVkIGFzIGFwaSBlbmRwb2ludHNcclxuICAgICAgICAgICAgICogQHR5cGUge3N0cmluZ1tdfVxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdGhpcy5yZXNlcnZlZCA9IFtcclxuICAgICAgICAgICAgICAgICdpbnN0YW5jZScsICdtaWRkbGV3YXJlJywgJ2FwaScsICdhcGlNYXAnLCAnc2VydmljZUlkTWFwJywgJ3Jlc2VydmVkJyxcclxuICAgICAgICAgICAgICAgICdhZGRBcGlOb2RlJywgJ2dldEFwaU5vZGUnLCAnX2dldE5vZGVQb3MnLCAnY2FsbEFwaU5vZGUnLCAnQXBpQ2FsbCdcclxuICAgICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAgIGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICB9IGVsc2UgcmV0dXJuIGluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhbiBBUEkgbm9kZSB0byB0aGUgYXBpIHN0YWNrIGFuZCBiaW5kcyBpdCB0byB0aGUgYXBpXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNlcnZpY2VJZCBUaGUgc2VydmljZSBpZFxyXG4gICAgICogQHBhcmFtIHtuYW1lc3BhY2V9IG5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2UgbW91bnRlZCB0byB0aGUgYXBpXHJcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBub2RlIFRoZSBmdW5jdGlvbiByZWZlcmVuY2UgZm9yIHRoZSBub2RlXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIG9uIGNvbXBsZXRpb24gYW5kIGZhbHNlIG9uIGZhaWx1cmVcclxuICAgICAqL1xyXG4gICAgYWRkQXBpTm9kZShzZXJ2aWNlSWQsIG5hbWVzcGFjZSwgbm9kZSlcclxuICAgIHtcclxuICAgICAgICBpZiAodGhpcy5fZ2V0Tm9kZVBvcyhuYW1lc3BhY2UpID09PSBmYWxzZSAmJiB0aGlzLl9pc1Jlc2VydmVkTmFtZXNwYWNlKG5hbWVzcGFjZSkgPT09IGZhbHNlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5hcGkucHVzaChub2RlKTtcclxuICAgICAgICAgICAgdGhpcy5hcGlNYXAucHVzaChuYW1lc3BhY2UpO1xyXG4gICAgICAgICAgICB0aGlzLnNlcnZpY2VJZE1hcC5wdXNoKHNlcnZpY2VJZCk7XHJcbiAgICAgICAgICAgIGxldCBwb3MgPSB0aGlzLmFwaS5sZW5ndGggLSAxO1xyXG4gICAgICAgICAgICB0aGlzW25hbWVzcGFjZV0gPSB0aGlzLmFwaVtwb3NdO1xyXG4gICAgICAgICAgICBnbG9iYWwuTG9nZ2VyLmxvZygnQXBpOmFkZEFwaU5vZGUnLCAyMDAsICdBZGRlZCBhIG5ldyBBUEkgbm9kZSBmb3IgU2VydmljZSBOYW1lc3BhY2U6ICcgKyBuYW1lc3BhY2UpO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9nZXROb2RlUG9zKG5hbWVzcGFjZSkgIT09IGZhbHNlKSBnbG9iYWwuTG9nZ2VyLmxvZygnQXBpOmFkZEFwaU5vZGUnLCA0MDAsICdVbmFibGUgdG8gY3JlYXRlIG5ldyBhcGkgbm9kZS4gQSBub2RlIGJ5IGZvciB0aGlzIHNlcnZpY2UgbmFtZXNwYWNlIGFscmVhZHkgZXhpc3RzIC0gU2VydmljZSBOYW1lc3BhY2U6ICcgKyBuYW1lc3BhY2UpO1xyXG4gICAgICAgIGVsc2UgZ2xvYmFsLkxvZ2dlci5sb2coJ0FwaTphZGRBcGlOb2RlJywgNDAwLCAnVW5hYmxlIHRvIGNyZWF0ZSBuZXcgYXBpIG5vZGUuIFRoaXMgbmFtZXNwYWNlIGlzIHJlc2VydmVkIC0gU2VydmljZSBOYW1lc3BhY2U6ICcgKyBuYW1lc3BhY2UpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYW4gYXBpIG5vZGUgZnJvbSB0aGUgc3RhY2tcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZXNwYWNlIFRoZSBzZXJ2aWNlIG5hbWVzcGFjZSB0byBsb2NhdGVcclxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBhcGkgbm9kZSB3aGVuIGZvdW5kIG9yIGZhbHNlIHdoZW4gbm8gbm9kZSB3YXMgZm91bmRcclxuICAgICAqL1xyXG4gICAgZ2V0QXBpTm9kZShuYW1lc3BhY2UpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IHBvcyA9IHRoaXMuX2dldE5vZGVQb3MobmFtZXNwYWNlKTtcclxuICAgICAgICBpZiAocG9zID4gLTEpIHJldHVybiB0aGlzLmFwaVtwb3NdO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgYW4gQXBpQ2FsbCBpbnN0YW5jZSBhbmQgZXhlY3V0ZXMgaXQgLSB0aGVuIHJldHVybnMgdGhlIEFwaUNhbGwgaW5zdGFuY2UgaWYgdGhlIGNhbGwgY29tcGxldGVkXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2UgdG8gYmUgY2FsbGVkXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWV0aG9kIFRoZSBtZXRob2QgdG8gYmUgY2FsbGVkXHJcbiAgICAgKiBAcGFyYW0geyp9IGRhdGEgVGhlIGRhdGEgdG8gYmUgc2VudCB0byB0aGUgY2FsbFxyXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHJlc3VsdCBvZiB0aGUgY2FsbCBvciBmYWxzZSBpZiB0aGUgbm9kZSBkaWQgbm90IGV4aXN0XHJcbiAgICAgKi9cclxuICAgIGNhbGxBcGlOb2RlKG5hbWVzcGFjZSwgbWV0aG9kLCBkYXRhKVxyXG4gICAge1xyXG4gICAgICAgIG5vZGUgPSB0aGlzLmdldEFwaU5vZGUobmFtZXNwYWNlKTtcclxuICAgICAgICBpZiAobm9kZSAhPT0gZmFsc2UpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBsZXQgYXBpQ2FsbCA9IG5ldyBBcGlDYWxsKG1ldGhvZCwgZGF0YSk7XHJcbiAgICAgICAgICAgIHRoaXMubWlkZGxld2FyZS5jYWxsQ2hhbm5lbCgnUFJFX0FQSV9DQUxMJywgYXBpQ2FsbCk7XHJcbiAgICAgICAgICAgIGRhdGEgPSBhcGlDYWxsLmNhbGxBcGkobm9kZSwgbWVob2QpO1xyXG4gICAgICAgICAgICB0aGlzLm1pZGRsZXdhcmUuY2FsbENoYW5uZWwoJ1BPU1RfQVBJX0NBTEwnLCBkYXRhKTtcclxuICAgICAgICAgICAgZGF0YS5yZXR1cm5lZCA9IG1vbWVudCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5Mb2dnZXIubG9nKCdBcGk6Y2FsbEFwaU5vZGUnLCA0MDAsICdGYWlsZWQgdG8gY2FsbCBub2RlIHNlcnZpY2Ugd2l0aCBuYW1lc3BhY2U6ICcgKyBuYW1lc3BhY2UgKyAnIC0gbm8gYXBpIG5vZGUgZXhpc3RzIGZvciB0aGlzIG5hbWVzcGFjZS4nKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBwb3NpdGlvbiBvZiB0aGUgbm9kZSBieSBpdHMgbmFtZXNwYWNlXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWVzcGFjZSBUaGUgc2VydmljZSBuYW1lc3BhY2UgdG8gYmUgcmV0cmlldmVkXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbnxudW1iZXJ9IFJldHVybnMgZmFsc2UgaWYgbm90IGZvdW5kIG9yIHRoZSBwb3NpdGlvbiBvZiB0aGUgc2VydmljZSBuYW1lc3BhY2UgaW4gdGhlIHN0YWNrXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBfZ2V0Tm9kZVBvcyhuYW1lc3BhY2UpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IHBvcyA9IHRoaXMuYXBpTWFwLmluZGV4T2YobmFtZXNwYWNlKTtcclxuICAgICAgICBpZiAocG9zID09IC0xKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBpTWFwW3Bvc107XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiB0aGUgbmFtZXNwYWNlIGlzIHJlc2VydmVkIGJ5IHRoZSBvYmplY3RcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZXNwYWNlIFRoZSBzZXJ2aWNlIG5hbWVzcGFjZSB0byBiZSBjaGVja2VkXHJcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyB0cnVlIGlmIHRoZSBuYW1lc3BhY2UgZXhpc3RzIGZhbHNlIGlmIGl0IGRvZXNuJ3RcclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIF9pc1Jlc2VydmVkTmFtZXNwYWNlKG5hbWVzcGFjZSlcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXNlcnZlZC5pbmRleE9mKG5hbWVzcGFjZSkgPiAtMTtcclxuICAgIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIFRoaXMgQVBJIGNhbGwgY2xhc3NcclxuICpcclxuICogQG5vdGUgVGhpcyBpcyB0aGUgcGFja2FnZWQgY2FsbCBhbmQgaXRzIHJlbGF0ZWQgZGF0YVxyXG4gKi9cclxuY2xhc3MgQXBpQ2FsbFxyXG57XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKG1ldGhvZCwgZGF0YSlcclxuICAgIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgbWV0aG9kIHRvIGJlIGNhbGxlZFxyXG4gICAgICAgICAqIEB2YXIge2Z1bmN0aW9ufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubWV0aG9kID0gbWV0aG9kO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGZsYWcgdGhhdCBjb250cm9scyBpZiB0aGUgY2FsbCByZXN1bHRlZCBpbiBhbiBlcnJvclxyXG4gICAgICAgICAqIEB0eXBlIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuZXJyb3IgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIGVycm9ycyB0aGF0IG9jY3VycmVkIGR1cmluZyB0aGUgY2FsbFxyXG4gICAgICAgICAqIEB0eXBlIHtBcnJheX1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmVycm9ycyA9IFtdO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgZGF0YSBmb3IgdGhlIGNhbGxcclxuICAgICAgICAgKiBAdHlwZSB7Kn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgdGltZSB0aGUgQVBJIGNhbGwgd2FzIGNyZWF0ZWRcclxuICAgICAgICAgKiBAdHlwZSB7bW9tZW50fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuY3JlYXRlZCA9IG1vbWVudCgpO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgdGltZSB0aGUgQVBJIGNhbGwgd2FzIHVwZGF0ZWRcclxuICAgICAgICAgKiBAdHlwZSB7bW9tZW50fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMudXBkYXRlZCA9IG51bGw7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSB0aW1lIHRoZSBBUEkgY2FsbCB3YXMgcmV0dXJuZWRcclxuICAgICAgICAgKiBAdHlwZSB7bW9tZW50fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucmV0dXJuZWQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2FsbHMgdGhlIGFwaSBmb3IgdGhlIGNhbGxcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBub2RlIFRoZSBub2RlIHRvIHRiZSBjYWxsZWRcclxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBBcGlDYWxsIG9iamVjdFxyXG4gICAgICovXHJcbiAgICBjYWxsQXBpKG5vZGUpXHJcbiAgICB7XHJcbiAgICAgICAgbm9kZSh0aGlzKTtcclxuICAgICAgICB0aGlzLnVwZGF0ZWQgPSBtb21lbnQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxufVxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2NvbXBvbmVudC9hcGkuanNcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJuZXRcIik7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiBleHRlcm5hbCBcIm5ldFwiXG4gKiogbW9kdWxlIGlkID0gMTFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImh0dHBcIik7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiBleHRlcm5hbCBcImh0dHBcIlxuICoqIG1vZHVsZSBpZCA9IDEyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJzb2NrZXQuaW9cIik7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiBleHRlcm5hbCBcInNvY2tldC5pb1wiXG4gKiogbW9kdWxlIGlkID0gMTNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNvbXByZXNzaW9uXCIpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogZXh0ZXJuYWwgXCJjb21wcmVzc2lvblwiXG4gKiogbW9kdWxlIGlkID0gMTRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImV4cHJlc3NcIik7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiBleHRlcm5hbCBcImV4cHJlc3NcIlxuICoqIG1vZHVsZSBpZCA9IDE1XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCIvKipcclxuICogR29yZ29uIHRoZSBzY3JpcHRpbmcgY2FwYWJsZSBuZXR3b3JrIHNlcnZlciBmb3IgTm9kZSBKU1xyXG4gKlxyXG4gKiBAcGFja2FnZSBHb3Jnb25cclxuICogQGF1dGhvciBSeWFuIFJlbnRmcm9cclxuICogQGxpY2Vuc2UgTUlUXHJcbiAqIEB1cmwgaHR0cHM6Ly9naXRodWIuY29tL21hbnVmYWN0dXJpbmctaW5kdXN0cnlcclxuICovXHJcblxyXG4vKlxyXG4gKiBJbXBvcnRzXHJcbiAqL1xyXG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XHJcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcclxuaW1wb3J0ICogYXMgb3MgZnJvbSAnb3MnO1xyXG5pbXBvcnQge0dvcmdvbkNvbmZpZ30gZnJvbSAnLi4vY29uZmlnL2NvbmZpZydcclxuaW1wb3J0IHNhbml0aXplIGZyb20gJ3Nhbml0aXplLWZpbGVuYW1lJztcclxuXHJcbi8qKlxyXG4gKiBUaGUgc2VydmVyIGxvZ2dpbmcgY2xhc3NcclxuICovXHJcbmV4cG9ydCBjbGFzcyBMb2dnZXIge1xyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RzIHRoZSBjbGFzc1xyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcigpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5mcyA9IGZzO1xyXG4gICAgICAgIHRoaXMuR29yZ29uQ29uZmlnID0gbmV3IEdvcmdvbkNvbmZpZygpO1xyXG4gICAgICAgIHRoaXMuc2FuaXRpemUgPSBzYW5pdGl6ZTtcclxuICAgICAgICB0aGlzLnRvcGljTWFwID0gW107XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVycyA9IFtdO1xyXG4gICAgICAgIHRoaXMuc3Vic2NyaWJlck1hcCA9IFtdO1xyXG4gICAgICAgIHRoaXMubGV2ZWwgPSBbJ0RlYnVnJywgJ0luZm8nLCAnV2FybicsICdFcnJvcicsICdDcml0aWNhbCcsICdGYXRhbCddO1xyXG4gICAgICAgIHRoaXMubGV2ZWxLZXkgPSBbMTAwLCAyMDAsIDMwMCwgNDAwLCA1MDAsIDYwMF07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGEgbmV3IGxvZyBhbmQgd3JpdGVzIGl0IHRvIHRoZSBjb3JyZXNwb25kaW5nIGZpbGVcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbG9jYXRpb24gVGhlIGxvY2F0aW9uIHRoZSBsb2cgb3JpZ2luYXRlZCBmcm9tXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbGV2ZWwgVGhlIGxldmVsIG9mIHRoZSBsb2cgKGZyb20gbGV2ZWxLZXkpXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBUaGUgbWVzc2FnZSBmb3IgdGhlIGxvZ1xyXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZXMgVGhlIHZhbHVlcyB0byBpbmNsdWRlIHdpdGggdGhlIGxvZ1xyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgZm9yIHRoZSBsb2dcclxuICAgICAqIEByZXR1cm4ge2Jvb2xlYW59IFJldHVybnMgdHJ1ZSBvbiBjb21wbGV0aW9uIGFuZCBmYWxzZSBvbiBmYWlsdXJlXHJcbiAgICAgKi9cclxuICAgIGxvZyhsb2NhdGlvbiwgbGV2ZWwsIG1lc3NhZ2UsIHZhbHVlcywgdHlwZSlcclxuICAgIHtcclxuICAgICAgICB2YXIgbG9nSXRlbSA9IG5ldyBMb2cobG9jYXRpb24sIGxldmVsLCBtZXNzYWdlLCB2YWx1ZXMsIHR5cGUpO1xyXG4gICAgICAgIHZhciBsb2dWYWx1ZXMgPSBsb2dJdGVtLnZhbHVlcyA9PSBudWxsIHx8IGxvZ0l0ZW0udmFsdWVzID09IHVuZGVmaW5lZCA/IG51bGwgOiBKU09OLnN0cmluZ2lmeShsb2dJdGVtLnZhbHVlcyk7XHJcbiAgICAgICAgdmFyIGZpbGVuYW1lID0gbG9nSXRlbS5jcmVhdGVkLmZvcm1hdCgnWVlZWU1NREQnKSArICcubG9nJztcclxuXHJcbiAgICAgICAgc3dpdGNoKGxvZ0l0ZW0udHlwZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IHRoaXMuc2FuaXRpemUobG9nSXRlbS50eXBlKSArICctJyArIGZpbGVuYW1lO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgdW5kZWZpbmVkOlxyXG4gICAgICAgICAgICBjYXNlIHRydWU6XHJcbiAgICAgICAgICAgIGNhc2UgJ3N5cyc6XHJcbiAgICAgICAgICAgICAgICBmaWxlbmFtZSA9ICdzeXMtJyArIGZpbGVuYW1lO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Vycm9yJzpcclxuICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gJ2Vycm9yLScgKyBmaWxlbmFtZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGxvZ0VudHJ5ID0gbG9nSXRlbS5jcmVhdGVkLmZvcm1hdCgpICsgJyAnICsgbG9nSXRlbS5sZXZlbCArICcgJyArIGxvZ0l0ZW0ubG9jYXRpb24gKyAnIFttZXNzYWdlPScgKyBsb2dJdGVtLm1lc3NhZ2UgKyAnXScgKyAnIFt2YWx1ZXM9JyArIGxvZ1ZhbHVlcyArICddJyArIG9zLkVPTDtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmZzLmV4aXN0c1N5bmModGhpcy5Hb3Jnb25Db25maWcuc3RvcmFnZS5sb2dzKSl7XHJcbiAgICAgICAgICAgIGZzLm1rZGlyU3luYyh0aGlzLkdvcmdvbkNvbmZpZy5zdG9yYWdlLmxvZ3MpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5mcy5hcHBlbmRGaWxlKHRoaXMuR29yZ29uQ29uZmlnLnN0b3JhZ2UubG9ncyArIGZpbGVuYW1lLCBsb2dFbnRyeSwgJ3V0ZjgnLCAgZnVuY3Rpb24gKGVycilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogVGhlIHNlcnZlciBsb2cgY2xhc3NcclxuICovXHJcbmNsYXNzIExvZyB7XHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgdGhlIGNsYXNzXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGxvY2F0aW9uIFRoZSBsb2NhdGlvbiB0aGUgbG9nIG9yaWdpbmF0ZWQgZnJvbVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsIFRoZSBsZXZlbCBvZiB0aGUgbG9nIChmcm9tIGxldmVsS2V5KVxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgVGhlIG1lc3NhZ2UgZm9yIHRoZSBsb2dcclxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWVzIFRoZSB2YWx1ZXMgdG8gaW5jbHVkZSB3aXRoIHRoZSBsb2dcclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIFRoZSB0eXBlIGZvciB0aGUgbG9nXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGxvY2F0aW9uLCBsZXZlbCwgbWVzc2FnZSwgdmFsdWVzLCB0eXBlKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBsb2NhdGlvbjtcclxuICAgICAgICB0aGlzLmxldmVsID0gbGV2ZWwgPT0gbnVsbCB8fCBsZXZlbCA9PSB1bmRlZmluZWQgPyAxMDAgOiBsZXZlbDtcclxuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgICAgIHRoaXMudHlwZSA9IHR5cGUgPT0gbnVsbCB8fCB0eXBlID09IHVuZGVmaW5lZCA/ICdzeXMnIDogdHlwZTtcclxuICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlcyA9PSBudWxsIHx8IHZhbHVlcyA9PSB1bmRlZmluZWQgPyBudWxsIDogdmFsdWVzO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlZCA9IG1vbWVudCgpO1xyXG4gICAgfVxyXG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvY29tcG9uZW50L2xvZy5qc1xuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImZzXCIpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogZXh0ZXJuYWwgXCJmc1wiXG4gKiogbW9kdWxlIGlkID0gMTdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIm9zXCIpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogZXh0ZXJuYWwgXCJvc1wiXG4gKiogbW9kdWxlIGlkID0gMThcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInNhbml0aXplLWZpbGVuYW1lXCIpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogZXh0ZXJuYWwgXCJzYW5pdGl6ZS1maWxlbmFtZVwiXG4gKiogbW9kdWxlIGlkID0gMTlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImNvbG9nXCIpO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogZXh0ZXJuYWwgXCJjb2xvZ1wiXG4gKiogbW9kdWxlIGlkID0gMjBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=