require("source-map-support").install(),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("http"),require("socket.io"),require("compression"),require("express"),require("fs"),require("moment"),require("os"),require("sanitize-filename")):"function"==typeof define&&define.amd?define("gorgon",["http","socket.io","compression","express","fs","moment","os","sanitize-filename"],t):"object"==typeof exports?exports.gorgon=t(require("http"),require("socket.io"),require("compression"),require("express"),require("fs"),require("moment"),require("os"),require("sanitize-filename")):e.gorgon=t(e.http,e["socket.io"],e.compression,e.express,e.fs,e.moment,e.os,e["sanitize-filename"])}(this,function(e,t,n,r,o,i,s,a){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),s=n(2),a=n(5),u=n(11);global.Logger=new u.Logger;var c=function(){function e(){r(this,e),this.GorgonConfig=new i.GorgonConfig,this.Logger=global.Logger,this.Logger.log("Gorgon:initServer",200,"The Gorgon has been summoned - GORGON SERVER STARTING..."),this.GorgonEnv=new s.GorgonEnv,this.GorgonContainerService=new a.GorgonContainerService,this.separator1="================================================",this.separator2="------------------------------------------------"}return o(e,[{key:"initServer",value:function(){this._bootstrap(),console.log("Loading Services"),console.log(this.separator2),this.Logger.log("Gorgon:initServer",200,"The server was started successfully"),this.GorgonEnv.service.forEach(function(e){this.GorgonContainerService.add(e.service),console.log(e.namespace+" - [ Ok ]"),this.Logger.log("Gorgon:initServer",200,"Loaded service namespace: "+e.namespace)},this),this.Logger.log("Gorgon:initServer",200,"Service Loading Completed")}},{key:"_bootstrap",value:function(){console.log("Gorgon Server - v"+this.GorgonConfig.data.version),console.log("Author: Ryan Rentfro <rrentfro at gmail dot com>"),console.log("Project: https://github.com/manufacturing-industry/gorgon"),this._motd()}},{key:"_motd",value:function(){console.log(this.separator1),console.log(this.GorgonConfig.data.motd),console.log(this.separator1)}}]),e}(),l=new c;l.initServer()},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});/**
	 * Gorgon the scripting capable network server for Node JS
	 *
	 * @package Gorgon
	 * @author Ryan Rentfro
	 * @license MIT
	 * @url https://github.com/manufacturing-industry
	 */
t.GorgonConfig=function r(){n(this,r),this.data={name:"Gorgon Server",version:"0.0.1 Pre-Alpha",motd:"This is the message of the day for the Gorgon Server"},this.storage={logs:"logs/"},this.load={server:!0,cli:!0,services:!0},this.debug={enable:!0}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.GorgonEnv=void 0;var i=n(3),s=r(i);t.GorgonEnv=function a(){o(this,a),this.service=new s["default"],this.service=[{sid:0,name:"Status",namespace:"StatusService",enable:!0,service:this.service}]}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(4),u=n(5),c=n(1),l=n(6),f=new l.Network,p=function(e){function t(){r(this,t);var e=o(this,Object.getPrototypeOf(t).call(this));return e.config=c.StatusServiceConfig,e.name="Status Service",e.namespace="StatusService",e.description="Provides service status",e.type="Service",e.https=!0,e.inboundTypes=["rest","socket","http","webSocket","api"],e.ports=[2600,null,2680,2688,null],e.router=new a.Routes(e.namepsace),e.permissions=["internal"],e.serviceBind(),e}return i(t,e),s(t,[{key:"routes",value:function(){return{ServiceRequest:{inboundTypes:this.inboundTypes,method:"/StatusServiceRequest",callback:this.serviceRequest()}}}},{key:"serviceRequest",value:function(e){}},{key:"serviceBind",value:function(){return this.router.importRoutes(this.routes()),this._setNetworking(),f.addService(this),!0}},{key:"serviceUnbind",value:function(){f.removeService(this.namespace)}}]),t}(u.GorgonService);t["default"]=p,e.exports=t["default"]},function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Routes=function(){function e(t){r(this,e),this.service=t,this.inboundTypes=["rest","socket","http","https","webSocket","api"],this.routes=[],this.routeCallbacks=[],this.permissionMap=[]}return o(e,[{key:"add",value:function(e,t,n){this.routes.push(t),this.routeCallbacks(n);var r=this.routeCallbacks.length-1;e.forEach(function(e){this.inboundTypes.indexOf(e)>-1?this.permissionMap[e].push(r):console.log("ERROR - Invalid Permission Encountered in Service: ["+this.service+"] Method: ["+t+"]")})}},{key:"remove",value:function(e){var t=this.routes.indexOf(e);return t>-1&&(this.routeCallbacks[t]=null,this.routes[t]=null,this.inboundTypes.forEach(function(e){if(void 0!=this.permissionMap[e]&&this.permissionMap[e]instanceof Array){var n=this.permissionMap[e].indexOf(t);n>-1&&this.permissionMap[e].splice(n,1)}}),!0)}},{key:"importRoutes",value:function(e){if(e instanceof Array)for(var t in e)e.hasOwnProperty(t)&&this.add(e[t].inboundTypes,e[t].method,e[t].callback);return!1}},{key:"route",value:function(e,t,r){var o=this.routes.indexOf(t);if(o>-1&&void 0!=this.permissionMap[e]&&this.permissionMap[e].length>0&&this.permissionMap[e].indexOf(o)>-1){var i;return(i=this.routeCallbacks)[o].apply(i,[t,e].concat(n(r)))}return!1}}]),e}()},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.GorgonContainerService=function(){function e(){n(this,e),this.containers=[],this.containerMap=[],this.name="Gorgon Container Service",this.type="Service"}return r(e,[{key:"add",value:function(e){return null!=e.namespace&&""!=e.namespace&&this.containerMap.indexOf(e.namespace)==-1&&(this.containers.push(e),this.containerMap.push(e.namespace),!0)}},{key:"remove",value:function(e){if(this.containerMap.indexOf(e)>-1){var t=this.containerMap.indexOf(e);return this.containers.splice(t,1),this.containerMap.splice(t,1),!0}return!1}},{key:"get",value:function(e){return this.containerMap.indexOf(e)>-1&&this.containers[this.containerMap.indexOf(e)]}}]),e}(),t.GorgonService=function(){function e(){n(this,e),this.name=null,this.description=null,this.type="Service",this.router=null,this.inboundTypes=[],this.ports=[],this.permissions=[],this.networking=[]}return r(e,[{key:"_setNetworking",value:function(){if(this.inboundTypes instanceof Array&&this.ports instanceof Array&&this.inboundTypes.length==this.ports.length)for(var e=0;e<this.inboundTypes.length;e++)this.networking.push({name:this.inboundTypes[e],port:this.ports[e]});else console.warn("GorgonService:_setNetworking - Missing or invalid networking for service "+this.name)}}]),e}()},function(e,t,n){(function(e){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Network=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(7),a=r(s),u=n(8),c=r(u),l=n(9),f=r(l),p=n(10),h=r(p),v=null,d=(0,h["default"])(),g=a["default"].Server(d);new c["default"](g);d.use((0,f["default"])({})),d.use(h["default"]["static"](e+"/../client"));var y=t.Network=function(){function e(){return o(this,e),v?v:(this.services=[],this.serviceMap=[],this.components=[],this.componentMap=[],this.componentTypeMap={rest:[],socket:[],webSocket:[],http:[],api:[]},this.portReservations=[],this.activeServices=[],this.wsExpress=(0,h["default"])(),this.webSocketServer=a["default"].Server(this.wsExpress),v=this,void 0)}return i(e,[{key:"addService",value:function(e){if(this.activeServices.indexOf(e.namespace)==-1){this.services.push(e),this.serviceMap.push(e.namespace);var t=this.serviceMap.length-1;if(e.networking instanceof Array)for(var n=0;n<e.networking.length;n++)this.add(t,e.namespace,e.networking[n].name,"label",e.networking[n].port)}return!1}},{key:"removeService",value:function(e){}},{key:"add",value:function(e,t,n,r,o){if(this.portReservations.indexOf(o)==-1||null==o||void 0==o){switch(n){default:return global.Logger.log("Network:add",400,"Unable to load component type of: "+n+" for Service Namespace: "+t+" - ServiceId: "+e),!1;case"rest":break;case"http":break;case"socket":break;case"webSocket":break;case"api":}this.componentMap.push(t+"-"+n+"-"+r+"-"+o),console.log("loadType"),console.log(n),global.Logger.log("Network:add",200,"Added network component: "+n+" for Service Namespace: "+t+" - ServiceId: "+e)}return!1}},{key:"remove",value:function(e,t,n){}}]),e}(),m=(function(){function e(t,n,r,i){o(this,e),this.type=t,this.label=n,this.port=r,this.service=i,this.attr={}}return i(e,[{key:"addAttribute",value:function(e,t){this.attr[e]=t}},{key:"removeAttribute",value:function(e){delete this.attr[e]}}]),e}(),new y);t["default"]=m}).call(t,"/")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("socket.io")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("express")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(12),u=o(a),c=n(13),l=r(c),f=n(14),p=o(f),h=n(1),v=n(15),d=r(v),g=(t.Logger=function(){function e(){i(this,e),this.fs=u,this.GorgonConfig=new h.GorgonConfig,this.sanitize=d["default"],this.topicMap=[],this.subscribers=[],this.subscriberMap=[],this.level=["Debug","Info","Warn","Error","Critical","Fatal"],this.levelKey=[100,200,300,400,500,600]}return s(e,[{key:"log",value:function(e,t,n,r,o){var i=new g(e,t,n,r,o),s=null==i.values||void 0==i.values?null:JSON.stringify(i.values),a=i.created.format("YYYYMMDD")+".log";switch(i.type){default:a=this.sanitize(i.type)+"-"+a;break;case void 0:case!0:case"sys":a="sys-"+a;break;case"error":a="error-"+a}var c=i.created.format()+" "+i.level+" "+i.location+" [message="+i.message+"] [values="+s+"]"+p.EOL;return this.fs.existsSync(this.GorgonConfig.storage.logs)||u.mkdirSync(this.GorgonConfig.storage.logs),this.fs.appendFile(this.GorgonConfig.storage.logs+a,c,"utf8",function(e){if(e)return console.error(e),!1}),!0}}]),e}(),function y(e,t,n,r,o){i(this,y),this.location=e,this.level=null==t||void 0==t?100:t,this.message=n,this.type=null==o||void 0==o?"sys":o,this.values=null==r||void 0==r?null:r,this.created=(0,l["default"])()})},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("moment")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("sanitize-filename")}])});
//# sourceMappingURL=gorgon.min.js.map